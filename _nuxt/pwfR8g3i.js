import{B as I,V as N,d as w,h as d,F as q,I as O,z as _,w as m,g,t as h,O as J,M as R,bC as W,H as r,e as i,v as Y,a5 as K,r as Q,C as D,a8 as X,D as Z,P as ee,Y as te,G as se,f as x,n as oe,J as ae,E as ne}from"#entry";import{_ as re}from"./Bj6CTjPb.js";import{_ as ie,a as ce}from"./CVgFCWlT.js";import{_ as le}from"./BSHmI09T.js";import{_ as me}from"./CSS74mLJ.js";import{_ as ue}from"./BFES-Nen.js";import{u as v}from"./B_Cg5Li1.js";import{q as C}from"./DuU9hUNe.js";import{d as _e}from"./D8rO69WY.js";import"./C1OEmZiP.js";const ge={class:"doctrine-tracker"},pe={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},de={class:"space-y-3"},fe={class:"flex items-center justify-between"},he={class:"font-semibold"},ve={class:"text-sm text-gray-600"},ye=I({__name:"DoctrineProgress",props:{doctrines:{}},setup(p){const a=N(()=>p.doctrines.map(t=>({...t,progress:t.totalLessons?t.completedLessons/t.totalLessons*100:0}))),u=t=>t===100?"success":t>=50?"warning":"error";return(t,P)=>{const o=J,l=W,f=re;return i(),w("div",ge,[d("div",pe,[(i(!0),w(q,null,O(r(a),s=>(i(),_(f,{key:s.slug},{default:m(()=>[d("div",de,[d("div",fe,[d("h3",he,h(s.title),1),g(o,{color:u(s.progress)},{default:m(()=>[R(h(s.progress)+"% ",1)]),_:2},1032,["color"])]),g(l,{"model-value":s.progress},null,8,["model-value"]),d("div",ve,h(s.completedLessons)+" / "+h(s.totalLessons)+" leÃ§ons ",1)])]),_:2},1024))),128))])])}}}),Pe=Object.assign(ye,{__name:"DoctrineProgress"}),y=7,Ie=I({__name:"index",props:{themes:{}},async setup(p){let a,u;const t=Y(),{loggedIn:P}=K(),o=Q(parseInt(t.query.page||"1")),{data:l}=([a,u]=D(()=>v("teaching",()=>C("teaching").first())),a=await a,u(),a),{data:f}=([a,u]=D(()=>v("lessons-count",()=>C("lessons").count())),a=await a,u(),a),{data:s}=v(t.path,()=>C("lessons").limit(y).skip((o.value-1)*y).all(),{watch:[o]}),{data:U}=v(t.path+"-progress",()=>$fetch("/api/teaching/progress",{method:"GET"}),{immediate:P.value}),S=N(()=>U.value?.data?U.value.data.map(n=>({title:p.themes.find(c=>c.slug===n.theme)?.title||"",slug:n.theme,completedLessons:n.lessons?JSON.parse(n.lessons).length:0,totalLessons:s.value?.filter(c=>c.theme==n.theme).length||0})):[]),$=Math.ceil((f.value||0)/y);(o.value<1||t.query.page&&o.value===1||o.value>$)&&X("/enseignements");const b=n=>n.id===s.value?.[0]?.id&&o.value===1,k=l.value?.seo?.title||l.value?.title,L=l.value?.seo?.description||l.value?.description;Z({title:k,ogTitle:k,description:L,ogDescription:L});const B=n=>p.themes.find(c=>c.path==="/enseignements/"+n.theme);return _e(),(n,c)=>{const T=te,V=Pe,j=ie,F=le,z=me,E=ue,M=ce,A=ne,G=ee;return i(),_(G,null,{default:m(()=>[g(T,{src:"/images/hero-blog.webp",class:"w-full aspect-video max-h-[32rem] object-center"}),g(A,null,{default:m(()=>[g(j,se(r(l),{class:"py-[50px]"}),{default:m(()=>[r(P)&&p.themes&&r(s)?(i(),_(V,{key:0,doctrines:r(S),class:"mt-4"},null,8,["doctrines"])):x("",!0)]),_:1},16),g(M,null,{default:m(()=>[r(s)?(i(),_(z,{key:0},{default:m(()=>[(i(!0),w(q,null,O(r(s),(e,H)=>(i(),_(F,{key:H,to:e.path,title:e.title,description:e.description,image:e.image,date:new Date(e.date).toLocaleDateString("fr",{year:"numeric",month:"long",day:"numeric"}),badge:{label:B(e)?.title,color:B(e)?.color||"primary"},orientation:b(e)?"horizontal":"vertical",class:oe([b(e)&&"col-span-full"]),variant:"naked",ui:{description:"line-clamp-2"}},null,8,["to","title","description","image","date","badge","orientation","class"]))),128))]),_:1})):x("",!0),r($)>1?(i(),_(E,{key:1,page:r(o),"onUpdate:page":c[0]||(c[0]=e=>ae(o)?o.value=e:null),"items-per-page":y,"show-edges":"",total:r(f),to:e=>({path:"/enseignements",query:e>1?{page:e}:{}}),class:"mt-10 flex justify-center"},null,8,["page","total","to"])):x("",!0)]),_:1})]),_:1})]),_:1})}}});export{Ie as default};
