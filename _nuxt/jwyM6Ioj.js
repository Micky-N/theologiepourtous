import{B as ee,r as b,d as g,e as v,g as t,w as i,f as O,h as o,G as e,aq as se,I as z,n as P,F as T,H as D,z as W,t as p,L as oe,Z as te,M as Q,aU as ge,_ as be,D as _e,v as fe,a as ye,V as K,C as Y,P as ke,Q as he,aw as xe,as as $e}from"#entry";import{_ as Ce}from"./DTIFCxQf.js";import{_ as Ve,a as we}from"./BiYaFSpO.js";import{_ as ae}from"./ath3GSdt.js";import{_ as le}from"./DY4djKfE.js";import{_ as ne}from"./sIOFFvLP.js";import"./j7pdL1SH.js";import"./BbRiUxvT.js";const Ue={class:"bible-comparison"},Be={class:"flex items-center justify-between"},Re={class:"text-xl font-bold text-gray-900 dark:text-white"},Se={key:0},je={class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},ze={class:"flex gap-2"},Ae={key:0,class:"mb-6 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg"},Ne={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Me={class:"flex items-center gap-2 pt-6"},qe={class:"sticky top-0 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700 pb-2 mb-4 z-10"},Le={class:"flex items-center justify-between"},Oe={class:"font-semibold text-gray-900 dark:text-white"},Ee={class:"text-xs text-gray-500 dark:text-gray-400"},Fe={class:"verses-container space-y-3"},Ie={class:"flex items-start gap-2"},Pe={key:0,class:"verse-number flex-shrink-0 text-xs font-medium text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded-md min-w-[2rem] text-center"},Te={class:"verse-actions opacity-0 group-hover:opacity-100 transition-opacity mt-2 flex gap-2"},De={key:0,class:"text-center py-8 text-gray-500 dark:text-gray-400"},Ge={class:"flex items-center justify-between"},He={class:"flex gap-2"},Qe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ze=["onClick"],Je={class:"font-medium"},Ke={class:"text-sm text-gray-500"},We=ee({__name:"BibleComparison",props:{book:{},chapter:{},verseRange:{},comparisons:{},availableVersions:{default:()=>[]}},emits:["close","addVersion","removeVersion","addBookmark","addNote"],setup(X,{emit:q}){const U=q,c=X,E=b(!1),f=b(!1),x=b("side-by-side"),y=b("normal"),$=b(!0),k=[{label:"Côte à côte",value:"side-by-side"},{label:"Vertical",value:"vertical"}],C=[{label:"Petit",value:"small"},{label:"Normal",value:"normal"},{label:"Grand",value:"large"},{label:"Très grand",value:"extra-large"}],V=l=>{c.comparisons.length<6&&(U("addVersion",l),f.value=!1)},S=l=>{U("removeVersion",l)},u=l=>{U("addBookmark",l)},F=l=>{U("addNote",l)},m=async(l,n)=>{const _=`${c.book.name} ${c.chapter}:${l.verse} (${n.code})
"${l.text}"`;try{await navigator.clipboard.writeText(_)}catch(B){console.error("Erreur lors de la copie:",B)}},G=()=>{const l=c.comparisons.map(A=>{const N=A.verses.map(M=>`${M.verse}. ${M.text}`).join(`
`);return`${A.version.name} (${A.version.code})
${N}`}).join(`

---

`),n=`${c.book.name} ${c.chapter}:${c.verseRange.start}${c.verseRange.end>c.verseRange.start?`-${c.verseRange.end}`:""}

${l}`,_=new Blob([n],{type:"text/plain"}),B=URL.createObjectURL(_),w=document.createElement("a");w.href=B,w.download=`${c.book.code}_${c.chapter}_${c.verseRange.start}-${c.verseRange.end}_comparison.txt`,document.body.appendChild(w),w.click(),document.body.removeChild(w),URL.revokeObjectURL(B)};return(l,n)=>{const _=oe,B=ae,w=se,A=le,N=te,M=ne,H=ge;return v(),g("div",Ue,[t(M,null,{header:i(()=>[o("div",Be,[o("div",null,[o("h2",Re,[Q(" Comparaison : "+p(l.book.name)+" "+p(l.chapter)+":"+p(l.verseRange.start),1),l.verseRange.end>l.verseRange.start?(v(),g("span",Se,"-"+p(l.verseRange.end),1)):O("",!0)]),o("p",je,p(l.comparisons.length)+" versions côte à côte ",1)]),o("div",ze,[t(_,{icon:"i-lucide-settings",variant:"ghost",size:"sm",onClick:n[0]||(n[0]=r=>E.value=!e(E))}),t(_,{icon:"i-lucide-x",variant:"ghost",size:"sm",onClick:n[1]||(n[1]=r=>l.$emit("close"))})])])]),footer:i(()=>[o("div",Ge,[o("div",He,[t(_,{disabled:l.comparisons.length>=6,icon:"i-lucide-plus",label:"Ajouter version",variant:"outline",size:"sm",onClick:n[5]||(n[5]=r=>f.value=!0)},null,8,["disabled"]),t(_,{icon:"i-lucide-download",label:"Exporter",variant:"outline",size:"sm",onClick:G})]),n[10]||(n[10]=o("div",{class:"text-xs text-gray-500 dark:text-gray-400"}," Maximum 6 versions simultanées ",-1))])]),default:i(()=>[e(E)?(v(),g("div",Ae,[n[8]||(n[8]=o("h3",{class:"font-medium text-gray-900 dark:text-white mb-3"}," Options d'affichage ",-1)),o("div",Ne,[t(w,{label:"Layout"},{default:i(()=>[t(B,{modelValue:e(x),"onUpdate:modelValue":n[2]||(n[2]=r=>z(x)?x.value=r:null),items:k,"label-key":"label","value-key":"value"},null,8,["modelValue"])]),_:1}),t(w,{label:"Taille du texte"},{default:i(()=>[t(B,{modelValue:e(y),"onUpdate:modelValue":n[3]||(n[3]=r=>z(y)?y.value=r:null),items:C,"label-key":"label","value-key":"value"},null,8,["modelValue"])]),_:1}),o("div",Me,[t(A,{modelValue:e($),"onUpdate:modelValue":n[4]||(n[4]=r=>z($)?$.value=r:null),label:"Numéros de versets"},null,8,["modelValue"])])])])):O("",!0),o("div",{class:P(["grid gap-4",{"grid-cols-1":e(x)==="vertical","grid-cols-1 md:grid-cols-2":e(x)==="side-by-side"&&l.comparisons.length===2,"grid-cols-1 md:grid-cols-2 lg:grid-cols-3":e(x)==="side-by-side"&&l.comparisons.length>=3}])},[(v(!0),g(T,null,D(l.comparisons,(r,L)=>(v(),g("div",{key:r.version.id,class:P(["version-column",{"!border-r-0 !pr-0":L!=0&&(L+1)%3===0,"border-r pr-4":L!=l.comparisons.length-1}])},[o("div",qe,[o("div",Le,[o("div",null,[o("h3",Oe,p(r.version.name),1),o("p",Ee,p(r.version.code)+" • "+p(r.version.language),1)]),l.comparisons.length>2?(v(),W(_,{key:0,icon:"i-lucide-x",variant:"ghost",size:"xs",onClick:R=>S(r.version.id)},null,8,["onClick"])):O("",!0)])]),o("div",Fe,[(v(!0),g(T,null,D(r.verses,R=>(v(),g("div",{key:`${r.version.id}-${R.id}`,class:P(["verse-item",e(y)])},[o("div",Ie,[e($)?(v(),g("span",Pe,p(R.verse),1)):O("",!0),o("p",{class:P(["verse-text leading-relaxed text-gray-800 dark:text-gray-200",{"text-sm":e(y)==="small","text-base":e(y)==="normal","text-lg":e(y)==="large","text-xl":e(y)==="extra-large"}])},p(R.text),3)]),o("div",Te,[t(_,{title:"Ajouter aux favoris",icon:"i-lucide-bookmark",variant:"ghost",size:"xs",onClick:s=>u(R)},null,8,["onClick"]),t(_,{title:"Ajouter une note",icon:"i-lucide-sticky-note",variant:"ghost",size:"xs",onClick:s=>F(R)},null,8,["onClick"]),t(_,{title:"Copier le verset",icon:"i-lucide-copy",variant:"ghost",size:"xs",onClick:s=>m(R,r.version)},null,8,["onClick"])])],2))),128))]),r.verses.length===0?(v(),g("div",De,[t(N,{name:"i-lucide-book-x",class:"w-8 h-8 mx-auto mb-2"}),n[9]||(n[9]=o("p",null," Aucun verset trouvé pour cette version ",-1))])):O("",!0)],2))),128))],2)]),_:1}),t(H,{open:e(f),"onUpdate:open":n[7]||(n[7]=r=>z(f)?f.value=r:null),title:"Ajouter une version",description:"Sélectionnez une version à ajouter à la comparaison"},{body:i(()=>[o("div",Qe,[(v(!0),g(T,null,D(l.availableVersions,r=>(v(),g("div",{key:r.id,class:"p-3 border border-gray-200 dark:border-gray-700 rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800",onClick:L=>V(r)},[o("div",Je,p(r.name),1),o("div",Ke,p(r.code)+" • "+p(r.language),1)],8,Ze))),128))])]),footer:i(()=>[t(_,{label:"Annuler",variant:"ghost",onClick:n[6]||(n[6]=r=>f.value=!1)})]),_:1},8,["open"])])}}}),Xe=Object.assign(be(We,[["__scopeId","data-v-8dfa0a49"]]),{__name:"BibleComparison"}),Ye={key:0,class:"border-t dark:border-gray-800 pt-4"},es={class:"space-y-1"},ss={class:"truncate"},os={class:"font-medium"},ts={class:"text-xs text-gray-500 dark:text-gray-400 ml-1"},as={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ls={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ns={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},rs=["onClick"],is={class:"flex items-center gap-3"},ds={class:"font-medium text-gray-900 dark:text-white"},cs={class:"text-xs text-gray-500 dark:text-gray-400"},us={class:"flex items-center flex-row-reverse justify-between pt-4"},ms={key:1},hs=ee({__name:"compare",async setup(X){let q,U;_e({title:"Comparaison de versions bibliques",ogTitle:"Comparaison de versions bibliques",description:"Comparez différentes versions de la Bible",ogDescription:"Comparez différentes versions de la Bible"});const c=fe(),E=ye(),f=b([]),x=b(!1),y=b(!1),$=b(""),k=b(void 0),C=b(null),V=b(1),S=b(null),u=b([]),F=b([]),m=b(null),G=K(()=>F.value.find(s=>s.code===k.value)),l=K(()=>k.value&&C.value&&V.value&&u.value.length>=2&&u.value.length<=6),n=K(()=>f.value.filter(s=>!m.value?.comparisons.some(a=>a.version.id===s.id))),_=()=>{const s=(c.query.verses||"").split("-");if(k.value=c.query.book||void 0,C.value=c.query.chapter?parseInt(c.query.chapter):null,V.value=s.length>0?parseInt(s[0]):1,S.value=s.length>1?parseInt(s[1]):null,f.value.length>0){const a=(c.query.versions||"LSG,S21").split(","),j=f.value.filter(h=>a.includes(h.code)).map(h=>h.id);j.length>=2&&(u.value=j)}},B=(s,a)=>{a===!0?u.value.includes(s)||u.value.push(s):u.value=u.value.filter(h=>h!==s)},w=async()=>{try{y.value=!0;const s=await $fetch("/api/bible/books");F.value=s.data?.all}catch(s){$.value="Erreur lors du chargement des livres",console.error(s)}finally{y.value=!1}},A=async()=>{try{const s=await $fetch("/api/bible/versions");f.value=s.data||s}catch(s){$.value="Erreur lors du chargement des versions",console.error(s)}},N=async()=>{if(l.value)try{$.value="",x.value=!0;const s=G.value,a=C.value,j=V.value,h=S.value||j;if(!s){$.value="Veuillez sélectionner un livre";return}const Z=await $fetch("/api/bible/compare",{method:"POST",body:{bookId:s.id,chapter:a,verseStart:j,verseEnd:h,versions:u.value}});m.value=Z.data}catch(s){$.value=s?.message||"Erreur lors de la comparaison",console.error(s)}finally{x.value=!1}},M=async()=>{if(Object.keys(c.query).length>0)return await E.push("/bible/compare");m.value=null,k.value=void 0,C.value=null,u.value=f.value.filter(s=>["LSG","S21"].includes(s.code)).map(s=>s.id),V.value=1,S.value=null,$.value=""},H=async s=>{if(!m.value)return;const a={version:s,verses:[{id:0,chapter:m.value.chapter,verse:m.value.verseRange.start,text:"Chargement...",createdAt:new Date,versionId:s.id,bookId:m.value.book.id}]};m.value.comparisons.push(a),u.value.push(s.id),await N()},r=s=>{m.value&&(m.value.comparisons=m.value.comparisons.filter(a=>a.version.id!==s),u.value=u.value.filter(a=>a!==s))},L=s=>{console.log("Ajouter aux favoris:",s)},R=s=>{console.log("Ajouter une note:",s)};return[q,U]=Y(()=>Promise.all([w(),A()])),await q,U(),_(),[q,U]=Y(()=>N()),await q,U(),(s,a)=>{const j=te,h=oe,Z=Ce,re=Ve,ie=ae,I=se,J=$e,de=le,ce=ne,ue=Xe,me=we,ve=ke;return v(),g("div",null,[t(ve,null,{left:i(()=>[t(Z,null,{top:i(()=>[t(h,{to:"/bible",color:"secondary",variant:"ghost",class:"w-full justify-start mb-4"},{leading:i(()=>[t(j,{name:"i-lucide-arrow-left"})]),default:i(()=>[a[5]||(a[5]=Q(" Retour à la Bible ",-1))]),_:1}),e(m)?(v(),g("div",Ye,[a[6]||(a[6]=o("p",{class:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Versions disponibles ",-1)),o("div",es,[(v(!0),g(T,null,D(e(n),d=>(v(),W(h,{key:d.id,size:"sm",color:"secondary",variant:"soft",class:"w-full justify-start",disabled:e(x)||e(u).length===6,onClick:pe=>H(d)},{default:i(()=>[o("div",ss,[o("span",os,p(d.name),1),o("span",ts,"("+p(d.code)+")",1)])]),_:2},1032,["disabled","onClick"]))),128))])])):O("",!0)]),_:1})]),default:i(()=>[t(re,{title:"Comparaison de versions bibliques",description:"Comparez différentes versions de la Bible sur un même passage."},he({_:2},[e(m)?{name:"right",fn:i(()=>[t(h,{color:"secondary",variant:"ghost",icon:"i-lucide-x",onClick:a[0]||(a[0]=d=>M())},{default:i(()=>[...a[7]||(a[7]=[Q(" Fermer ",-1)])]),_:1})]),key:"0"}:void 0]),1024),t(me,null,{default:i(()=>[e(m)?(v(),g("div",ms,[t(ue,{book:e(m).book,chapter:e(m).chapter,"verse-range":e(m).verseRange,comparisons:e(m).comparisons,"available-versions":e(n),onClose:M,onAddVersion:H,onRemoveVersion:r,onAddBookmark:L,onAddNote:R},null,8,["book","chapter","verse-range","comparisons","available-versions"])])):(v(),W(ce,{key:0},{header:i(()=>[...a[8]||(a[8]=[o("h3",{class:"text-lg font-medium"}," Sélectionner le passage à comparer ",-1)])]),default:i(()=>[o("form",{class:"space-y-6",onSubmit:xe(N,["prevent"])},[o("div",as,[t(I,{label:"Livre"},{default:i(()=>[t(ie,{modelValue:e(k),"onUpdate:modelValue":a[1]||(a[1]=d=>z(k)?k.value=d:null),items:e(F),loading:e(y),"label-key":"name","value-key":"code",placeholder:"Sélectionner un livre",searchable:"","search-placeholder":"Rechercher un livre...",class:"max-w-52 w-full"},null,8,["modelValue","items","loading"])]),_:1}),t(I,{label:"Chapitre"},{default:i(()=>[t(J,{modelValue:e(C),"onUpdate:modelValue":a[2]||(a[2]=d=>z(C)?C.value=d:null),modelModifiers:{number:!0},type:"number",min:"1",max:e(G)?.chapterCount||150,placeholder:"Numéro de chapitre",disabled:!e(k),class:"max-w-52 w-full"},null,8,["modelValue","max","disabled"])]),_:1})]),o("div",ls,[t(I,{label:"Verset de début"},{default:i(()=>[t(J,{modelValue:e(V),"onUpdate:modelValue":a[3]||(a[3]=d=>z(V)?V.value=d:null),modelModifiers:{number:!0},type:"number",min:"1",placeholder:"1",disabled:!e(k)||!e(C),class:"max-w-52 w-full"},null,8,["modelValue","disabled"])]),_:1}),t(I,{label:"Verset de fin (optionnel)"},{default:i(()=>[t(J,{modelValue:e(S),"onUpdate:modelValue":a[4]||(a[4]=d=>z(S)?S.value=d:null),modelModifiers:{number:!0},type:"number",min:e(V)||1,placeholder:"Même verset",disabled:!e(k)||!e(C),class:"max-w-52 w-full"},null,8,["modelValue","min","disabled"])]),_:1})]),t(I,{label:"Versions à comparer",required:"",description:`${e(u).length} version(s) sélectionnée(s) (minimum 2, maximum 6)`},{default:i(()=>[o("div",ns,[(v(!0),g(T,null,D(e(f),d=>(v(),g("div",{key:d.id,class:P(["p-3 rounded-lg border transition-colors cursor-pointer",e(u).includes(d.id)?"bg-primary-50 dark:bg-primary-950 border-primary-200 dark:border-primary-800":"bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-800 hover:bg-gray-100 dark:hover:bg-gray-800"]),onClick:pe=>B(d.id,!e(u).includes(d.id))},[o("div",is,[t(de,{"model-value":e(u).includes(d.id),disabled:e(u).length>=6&&!e(u).includes(d.id)},null,8,["model-value","disabled"]),o("div",null,[o("div",ds,p(d.name),1),o("div",cs,p(d.code)+" • "+p(d.language),1)])])],10,rs))),128))])]),_:1},8,["description"]),o("div",us,[t(h,{type:"submit",loading:e(x),disabled:!e(l),color:"primary"},{default:i(()=>[...a[9]||(a[9]=[Q(" Démarrer la comparaison ",-1)])]),_:1},8,["loading","disabled"])])],32)]),_:1}))]),_:1})]),_:1})])}}});export{hs as default};
