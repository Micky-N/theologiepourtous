import{B as y,D as b,a5 as w,a6 as T,W as C,r as E,z as _,w as t,G as l,e as z,M as o,g as a,a7 as S,a8 as m}from"#entry";import{o as h,s as p,_ as k}from"./r4xI9AHx.js";import"./BLT4CIBk.js";import"./FmXn-pHn.js";import"./DnA5474r.js";import"./j7pdL1SH.js";import"./BbRiUxvT.js";const F=y({__name:"login",setup(B){b({title:"Connexion - Théologie pour Tous",description:"Connectez-vous à votre compte pour continuer votre parcours spirituel"});const{loggedIn:d,fetch:u}=w(),r=T();C(d,s=>{s&&m("/")},{immediate:!0});const c=[{name:"email",type:"text",label:"Email",placeholder:"Entrez votre email",required:!0},{name:"password",label:"Mot de passe",type:"password",placeholder:"Entrez votre mot de passe"}],f=[{label:"Google",icon:"i-simple-icons-google",onClick:()=>{r.add({title:"Prochainement",description:"Connexion avec Google bientôt disponible",color:"primary"})}}],g=h({email:p().email("Format email invalide"),password:p().min(1,"Le mot de passe est requis")}),i=E(!1);async function v(s){i.value=!0,await $fetch("/api/auth/login",{method:"POST",body:s.data}).then(async()=>{await u(),await m("/")}).catch(e=>{console.error("Erreur de connexion:",e),r.add({title:"Erreur de connexion",description:"Email ou mot de passe incorrect",color:"error"})}).finally(()=>{i.value=!1})}return(s,e)=>{const n=S,x=k;return z(),_(x,{fields:c,schema:l(g),providers:f,loading:l(i),title:"Bon retour parmi nous",icon:"i-lucide-cross",onSubmit:v},{description:t(()=>[e[1]||(e[1]=o(" Vous n'avez pas de compte ? ",-1)),a(n,{to:"/signup",class:"text-primary font-medium"},{default:t(()=>[...e[0]||(e[0]=[o("S'inscrire",-1)])]),_:1}),e[2]||(e[2]=o(". ",-1))]),"password-hint":t(()=>[a(n,{to:"/",class:"text-primary font-medium",tabindex:"-1"},{default:t(()=>[...e[3]||(e[3]=[o("Mot de passe oublié ?",-1)])]),_:1})]),footer:t(()=>[e[5]||(e[5]=o(" En vous connectant, vous acceptez nos ",-1)),a(n,{to:"/",class:"text-primary font-medium"},{default:t(()=>[...e[4]||(e[4]=[o("Conditions d'utilisation",-1)])]),_:1}),e[6]||(e[6]=o(". ",-1))]),_:1},8,["schema","loading"])}}});export{F as default};
