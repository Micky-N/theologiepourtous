import{B as ee,r as b,d as g,e as v,g as t,w as i,f as L,h as s,G as e,aC as oe,I as j,n as H,F as I,H as P,z as K,t as p,L as se,Z as te,M as Q,aX as ge,_ as be,D as _e,v as fe,a as ye,V as J,C as Y,P as ke,Q as he,au as xe,aE as $e}from"#entry";import{_ as Ce}from"./DTIFCxQf.js";import{_ as Ve,a as we}from"./BiYaFSpO.js";import{_ as ae}from"./9so_DM-r.js";import{_ as le}from"./BIDBwe6G.js";import{_ as ne}from"./sIOFFvLP.js";import"./Bpjx_WNm.js";import"./sdVB0pjO.js";const Ue={class:"bible-comparison"},Be={class:"flex items-center justify-between"},Re={class:"text-xl font-bold text-gray-900 dark:text-white"},ze={key:0},Se={class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},je={class:"flex gap-2"},Ae={key:0,class:"mb-6 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg"},Ne={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Me={class:"flex items-center gap-2 pt-6"},qe={class:"sticky top-0 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700 pb-2 mb-4 z-10"},Le={class:"flex items-center justify-between"},Ee={class:"font-semibold text-gray-900 dark:text-white"},Oe={class:"text-xs text-gray-500 dark:text-gray-400"},Fe={class:"verses-container space-y-3"},Ie={class:"flex items-start gap-2"},Pe={key:0,class:"verse-number flex-shrink-0 text-xs font-medium text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded-md min-w-[2rem] text-center"},Te={class:"verse-actions opacity-0 group-hover:opacity-100 transition-opacity mt-2 flex gap-2"},De={key:0,class:"text-center py-8 text-gray-500 dark:text-gray-400"},Ge={class:"flex items-center justify-between"},He={class:"flex gap-2"},Qe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Xe=["onClick"],Ze={class:"font-medium"},Je={class:"text-sm text-gray-500"},Ke=ee({__name:"BibleComparison",props:{book:{},chapter:{},verseRange:{},comparisons:{},availableVersions:{default:()=>[]}},emits:["close","addVersion","removeVersion","addBookmark","addNote"],setup(W,{emit:q}){const B=q,c=W,E=b(!1),f=b(!1),y=b("side-by-side"),k=b("normal"),$=b(!0),h=[{label:"Côte à côte",value:"side-by-side"},{label:"Vertical",value:"vertical"},{label:"Horizontal",value:"horizontal"}],C=[{label:"Petit",value:"small"},{label:"Normal",value:"normal"},{label:"Grand",value:"large"},{label:"Très grand",value:"extra-large"}],V=l=>{c.comparisons.length<6&&(B("addVersion",l),f.value=!1)},z=l=>{B("removeVersion",l)},u=l=>{B("addBookmark",l)},O=l=>{B("addNote",l)},m=async(l,n)=>{const _=`${c.book.name} ${c.chapter}:${l.verse} (${n.code})
"${l.text}"`;try{await navigator.clipboard.writeText(_)}catch(R){console.error("Erreur lors de la copie:",R)}},T=()=>{const l=c.comparisons.map(A=>{const N=A.verses.map(M=>`${M.verse}. ${M.text}`).join(`
`);return`${A.version.name} (${A.version.code})
${N}`}).join(`

---

`),n=`${c.book.name} ${c.chapter}:${c.verseRange.start}${c.verseRange.end>c.verseRange.start?`-${c.verseRange.end}`:""}

${l}`,_=new Blob([n],{type:"text/plain"}),R=URL.createObjectURL(_),w=document.createElement("a");w.href=R,w.download=`${c.book.code}_${c.chapter}_${c.verseRange.start}-${c.verseRange.end}_comparison.txt`,document.body.appendChild(w),w.click(),document.body.removeChild(w),URL.revokeObjectURL(R)};return(l,n)=>{const _=se,R=ae,w=oe,A=le,N=te,M=ne,D=ge;return v(),g("div",Ue,[t(M,null,{header:i(()=>[s("div",Be,[s("div",null,[s("h2",Re,[Q(" Comparaison : "+p(l.book.name)+" "+p(l.chapter)+":"+p(l.verseRange.start),1),l.verseRange.end>l.verseRange.start?(v(),g("span",ze,"-"+p(l.verseRange.end),1)):L("",!0)]),s("p",Se,p(l.comparisons.length)+" versions côte à côte ",1)]),s("div",je,[t(_,{icon:"i-lucide-settings",variant:"ghost",size:"sm",onClick:n[0]||(n[0]=r=>E.value=!e(E))}),t(_,{icon:"i-lucide-x",variant:"ghost",size:"sm",onClick:n[1]||(n[1]=r=>l.$emit("close"))})])])]),footer:i(()=>[s("div",Ge,[s("div",He,[t(_,{disabled:l.comparisons.length>=6,icon:"i-lucide-plus",label:"Ajouter version",variant:"outline",size:"sm",onClick:n[5]||(n[5]=r=>f.value=!0)},null,8,["disabled"]),t(_,{icon:"i-lucide-download",label:"Exporter",variant:"outline",size:"sm",onClick:T})]),n[10]||(n[10]=s("div",{class:"text-xs text-gray-500 dark:text-gray-400"}," Maximum 6 versions simultanées ",-1))])]),default:i(()=>[e(E)?(v(),g("div",Ae,[n[8]||(n[8]=s("h3",{class:"font-medium text-gray-900 dark:text-white mb-3"}," Options d'affichage ",-1)),s("div",Ne,[t(w,{label:"Layout"},{default:i(()=>[t(R,{modelValue:e(y),"onUpdate:modelValue":n[2]||(n[2]=r=>j(y)?y.value=r:null),items:h,"label-key":"label","value-key":"value"},null,8,["modelValue"])]),_:1}),t(w,{label:"Taille du texte"},{default:i(()=>[t(R,{modelValue:e(k),"onUpdate:modelValue":n[3]||(n[3]=r=>j(k)?k.value=r:null),items:C,"label-key":"label","value-key":"value"},null,8,["modelValue"])]),_:1}),s("div",Me,[t(A,{modelValue:e($),"onUpdate:modelValue":n[4]||(n[4]=r=>j($)?$.value=r:null),label:"Numéros de versets"},null,8,["modelValue"])])])])):L("",!0),s("div",{class:H(["comparison-grid gap-4",{"grid-cols-1":e(y)==="vertical","grid-cols-2":e(y)==="side-by-side"&&l.comparisons.length===2,"grid-cols-3":e(y)==="side-by-side"&&l.comparisons.length===3,"grid-cols-2 lg:grid-cols-4":e(y)==="side-by-side"&&l.comparisons.length===4,"grid-cols-2 lg:grid-cols-3":e(y)==="side-by-side"&&l.comparisons.length>=5,"comparison-horizontal":e(y)==="horizontal"}])},[(v(!0),g(I,null,P(l.comparisons,r=>(v(),g("div",{key:r.version.id,class:"version-column"},[s("div",qe,[s("div",Le,[s("div",null,[s("h3",Ee,p(r.version.name),1),s("p",Oe,p(r.version.code)+" • "+p(r.version.language),1)]),l.comparisons.length>2?(v(),K(_,{key:0,icon:"i-lucide-x",variant:"ghost",size:"xs",onClick:U=>z(r.version.id)},null,8,["onClick"])):L("",!0)])]),s("div",Fe,[(v(!0),g(I,null,P(r.verses,U=>(v(),g("div",{key:`${r.version.id}-${U.id}`,class:H(["verse-item",e(k)])},[s("div",Ie,[e($)?(v(),g("span",Pe,p(U.verse),1)):L("",!0),s("p",{class:H(["verse-text leading-relaxed text-gray-800 dark:text-gray-200",{"text-sm":e(k)==="small","text-base":e(k)==="normal","text-lg":e(k)==="large","text-xl":e(k)==="extra-large"}])},p(U.text),3)]),s("div",Te,[t(_,{title:"Ajouter aux favoris",icon:"i-lucide-bookmark",variant:"ghost",size:"xs",onClick:G=>u(U)},null,8,["onClick"]),t(_,{title:"Ajouter une note",icon:"i-lucide-sticky-note",variant:"ghost",size:"xs",onClick:G=>O(U)},null,8,["onClick"]),t(_,{title:"Copier le verset",icon:"i-lucide-copy",variant:"ghost",size:"xs",onClick:G=>m(U,r.version)},null,8,["onClick"])])],2))),128))]),r.verses.length===0?(v(),g("div",De,[t(N,{name:"i-lucide-book-x",class:"w-8 h-8 mx-auto mb-2"}),n[9]||(n[9]=s("p",null," Aucun verset trouvé pour cette version ",-1))])):L("",!0)]))),128))],2)]),_:1}),t(D,{open:e(f),"onUpdate:open":n[7]||(n[7]=r=>j(f)?f.value=r:null),title:"Ajouter une version",description:"Sélectionnez une version à ajouter à la comparaison"},{body:i(()=>[s("div",Qe,[(v(!0),g(I,null,P(l.availableVersions,r=>(v(),g("div",{key:r.id,class:"p-3 border border-gray-200 dark:border-gray-700 rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800",onClick:U=>V(r)},[s("div",Ze,p(r.name),1),s("div",Je,p(r.code)+" • "+p(r.language),1)],8,Xe))),128))])]),footer:i(()=>[t(_,{label:"Annuler",variant:"ghost",onClick:n[6]||(n[6]=r=>f.value=!1)})]),_:1},8,["open"])])}}}),We=Object.assign(be(Ke,[["__scopeId","data-v-9f50c211"]]),{__name:"BibleComparison"}),Ye={key:0,class:"border-t dark:border-gray-800 pt-4"},eo={class:"space-y-1"},oo={class:"truncate"},so={class:"font-medium"},to={class:"text-xs text-gray-500 dark:text-gray-400 ml-1"},ao={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},lo={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},no={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},ro=["onClick"],io={class:"flex items-center gap-3"},co={class:"font-medium text-gray-900 dark:text-white"},uo={class:"text-xs text-gray-500 dark:text-gray-400"},mo={class:"flex items-center flex-row-reverse justify-between pt-4"},vo={key:1},xo=ee({__name:"compare",async setup(W){let q,B;_e({title:"Comparaison de versions bibliques",ogTitle:"Comparaison de versions bibliques",description:"Comparez différentes versions de la Bible",ogDescription:"Comparez différentes versions de la Bible"});const c=fe(),E=ye(),f=b([]),y=b(!1),k=b(!1),$=b(""),h=b(void 0),C=b(null),V=b(1),z=b(null),u=b([]),O=b([]),m=b(null),T=J(()=>O.value.find(o=>o.code===h.value)),l=J(()=>h.value&&C.value&&V.value&&u.value.length>=2&&u.value.length<=6),n=J(()=>f.value.filter(o=>!m.value?.comparisons.some(a=>a.version.id===o.id))),_=()=>{const o=(c.query.verses||"").split("-");if(h.value=c.query.book||void 0,C.value=c.query.chapter?parseInt(c.query.chapter):null,V.value=o.length>0?parseInt(o[0]):1,z.value=o.length>1?parseInt(o[1]):null,f.value.length>0){const a=(c.query.versions||"LSG,S21").split(","),S=f.value.filter(x=>a.includes(x.code)).map(x=>x.id);S.length>=2&&(u.value=S)}},R=(o,a)=>{a===!0?u.value.includes(o)||u.value.push(o):u.value=u.value.filter(x=>x!==o)},w=async()=>{try{k.value=!0;const o=await $fetch("/api/bible/books");O.value=o.data?.all}catch(o){$.value="Erreur lors du chargement des livres",console.error(o)}finally{k.value=!1}},A=async()=>{try{const o=await $fetch("/api/bible/versions");f.value=o.data||o}catch(o){$.value="Erreur lors du chargement des versions",console.error(o)}},N=async()=>{if(l.value)try{$.value="",y.value=!0;const o=T.value,a=C.value,S=V.value,x=z.value||S;if(!o){$.value="Veuillez sélectionner un livre";return}const X=await $fetch("/api/bible/compare",{method:"POST",body:{bookId:o.id,chapter:a,verseStart:S,verseEnd:x,versions:u.value}});m.value=X.data}catch(o){$.value=o?.message||"Erreur lors de la comparaison",console.error(o)}finally{y.value=!1}},M=async()=>{if(Object.keys(c.query).length>0)return await E.push("/bible/compare");m.value=null,h.value=void 0,C.value=null,u.value=f.value.filter(o=>["LSG","S21"].includes(o.code)).map(o=>o.id),V.value=1,z.value=null,$.value=""},D=async o=>{if(!m.value)return;const a={version:o,verses:[{id:0,chapter:m.value.chapter,verse:m.value.verseRange.start,text:"Chargement...",createdAt:new Date,versionId:o.id,bookId:m.value.book.id}]};m.value.comparisons.push(a),u.value.push(o.id),await N()},r=o=>{m.value&&(m.value.comparisons=m.value.comparisons.filter(a=>a.version.id!==o),u.value=u.value.filter(a=>a!==o))},U=o=>{console.log("Ajouter aux favoris:",o)},G=o=>{console.log("Ajouter une note:",o)};return[q,B]=Y(()=>Promise.all([w(),A()])),await q,B(),_(),[q,B]=Y(()=>N()),await q,B(),(o,a)=>{const S=te,x=se,X=Ce,re=Ve,ie=ae,F=oe,Z=$e,de=le,ce=ne,ue=We,me=we,ve=ke;return v(),g("div",null,[t(ve,null,{left:i(()=>[t(X,null,{top:i(()=>[t(x,{to:"/bible",color:"secondary",variant:"ghost",class:"w-full justify-start mb-4"},{leading:i(()=>[t(S,{name:"i-lucide-arrow-left"})]),default:i(()=>[a[5]||(a[5]=Q(" Retour à la Bible ",-1))]),_:1}),e(m)?(v(),g("div",Ye,[a[6]||(a[6]=s("p",{class:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Versions disponibles ",-1)),s("div",eo,[(v(!0),g(I,null,P(e(n),d=>(v(),K(x,{key:d.id,size:"sm",color:"secondary",variant:"soft",class:"w-full justify-start",onClick:pe=>D(d)},{default:i(()=>[s("div",oo,[s("span",so,p(d.name),1),s("span",to,"("+p(d.code)+")",1)])]),_:2},1032,["onClick"]))),128))])])):L("",!0)]),_:1})]),default:i(()=>[t(re,{title:"Comparaison de versions bibliques",description:"Comparez différentes versions de la Bible sur un même passage."},he({_:2},[e(m)?{name:"right",fn:i(()=>[t(x,{color:"secondary",variant:"ghost",icon:"i-lucide-x",onClick:a[0]||(a[0]=d=>M())},{default:i(()=>[...a[7]||(a[7]=[Q(" Fermer ",-1)])]),_:1})]),key:"0"}:void 0]),1024),t(me,null,{default:i(()=>[e(m)?(v(),g("div",vo,[t(ue,{book:e(m).book,chapter:e(m).chapter,"verse-range":e(m).verseRange,comparisons:e(m).comparisons,"available-versions":e(n),onClose:M,onAddVersion:D,onRemoveVersion:r,onAddBookmark:U,onAddNote:G},null,8,["book","chapter","verse-range","comparisons","available-versions"])])):(v(),K(ce,{key:0},{header:i(()=>[...a[8]||(a[8]=[s("h3",{class:"text-lg font-medium"}," Sélectionner le passage à comparer ",-1)])]),default:i(()=>[s("form",{class:"space-y-6",onSubmit:xe(N,["prevent"])},[s("div",ao,[t(F,{label:"Livre"},{default:i(()=>[t(ie,{modelValue:e(h),"onUpdate:modelValue":a[1]||(a[1]=d=>j(h)?h.value=d:null),items:e(O),loading:e(k),"label-key":"name","value-key":"code",placeholder:"Sélectionner un livre",searchable:"","search-placeholder":"Rechercher un livre...",class:"max-w-52 w-full"},null,8,["modelValue","items","loading"])]),_:1}),t(F,{label:"Chapitre"},{default:i(()=>[t(Z,{modelValue:e(C),"onUpdate:modelValue":a[2]||(a[2]=d=>j(C)?C.value=d:null),modelModifiers:{number:!0},type:"number",min:"1",max:e(T)?.chapterCount||150,placeholder:"Numéro de chapitre",disabled:!e(h),class:"max-w-52 w-full"},null,8,["modelValue","max","disabled"])]),_:1})]),s("div",lo,[t(F,{label:"Verset de début"},{default:i(()=>[t(Z,{modelValue:e(V),"onUpdate:modelValue":a[3]||(a[3]=d=>j(V)?V.value=d:null),modelModifiers:{number:!0},type:"number",min:"1",placeholder:"1",disabled:!e(h)||!e(C),class:"max-w-52 w-full"},null,8,["modelValue","disabled"])]),_:1}),t(F,{label:"Verset de fin (optionnel)"},{default:i(()=>[t(Z,{modelValue:e(z),"onUpdate:modelValue":a[4]||(a[4]=d=>j(z)?z.value=d:null),modelModifiers:{number:!0},type:"number",min:e(V)||1,placeholder:"Même verset",disabled:!e(h)||!e(C),class:"max-w-52 w-full"},null,8,["modelValue","min","disabled"])]),_:1})]),t(F,{label:"Versions à comparer",required:"",description:`${e(u).length} version(s) sélectionnée(s) (minimum 2, maximum 6)`},{default:i(()=>[s("div",no,[(v(!0),g(I,null,P(e(f),d=>(v(),g("div",{key:d.id,class:H(["p-3 rounded-lg border transition-colors cursor-pointer",e(u).includes(d.id)?"bg-primary-50 dark:bg-primary-950 border-primary-200 dark:border-primary-800":"bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-800 hover:bg-gray-100 dark:hover:bg-gray-800"]),onClick:pe=>R(d.id,!e(u).includes(d.id))},[s("div",io,[t(de,{"model-value":e(u).includes(d.id),disabled:e(u).length>=6&&!e(u).includes(d.id)},null,8,["model-value","disabled"]),s("div",null,[s("div",co,p(d.name),1),s("div",uo,p(d.code)+" • "+p(d.language),1)])])],10,ro))),128))])]),_:1},8,["description"]),s("div",mo,[t(x,{type:"submit",loading:e(y),disabled:!e(l),color:"primary"},{default:i(()=>[...a[9]||(a[9]=[Q(" Démarrer la comparaison ",-1)])]),_:1},8,["loading","disabled"])])],32)]),_:1}))]),_:1})]),_:1})])}}});export{xo as default};
