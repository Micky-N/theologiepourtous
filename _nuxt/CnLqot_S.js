import{z as y,J as b,a1 as C,a0 as m,G as h,r as z,I as L,w as r,C as c,N as t,g as d,a2 as T,e as _,a3 as p}from"#entry";import{_ as E}from"./BhOnYmdH.js";import{o as S,s as i}from"./D376FIhw.js";import"./XQVZmSxM.js";import"./BUW2VJzu.js";import"./BGeCMNnO.js";import"./Cvaf6Jed.js";import"./B5BmDUTd.js";import"./Dpy1dZNI.js";const G=y({__name:"signup",setup(P){b({title:"Inscription - Théologie pour Tous",description:"Créez un compte pour commencer votre parcours théologique"});const a=C(),{loggedIn:l}=m(),{fetch:u}=m();h(l,o=>{o&&p("/")},{immediate:!0});const f=[{name:"name",type:"text",label:"Nom",placeholder:"Entrez votre nom complet",required:!0},{name:"email",type:"text",label:"Email",placeholder:"Entrez votre email",required:!0},{name:"password",label:"Mot de passe",type:"password",placeholder:"Entrez votre mot de passe (min. 6 caractères)",required:!0},{name:"confirmPassword",label:"Confirmer le mot de passe",type:"password",placeholder:"Confirmez votre mot de passe",required:!0}],g=[{label:"Google",icon:"i-simple-icons-google",onClick:()=>{a.add({title:"Prochainement",description:"Inscription avec Google bientôt disponible",color:"primary"})}}],v=S({name:i().min(2,"Le nom doit contenir au moins 2 caractères").max(50,"Le nom ne doit pas dépasser 50 caractères"),email:i().email("Format d'email invalide"),password:i().min(7,"Le mot de passe doit contenir au moins 7 caractères").regex(/(?=.*[a-z])/,"Le mot de passe doit contenir au moins une minuscule").regex(/(?=.*[A-Z])/,"Le mot de passe doit contenir au moins une majuscule").regex(/(?=.*\d)/,"Le mot de passe doit contenir au moins un chiffre"),confirmPassword:i().min(7)}).refine(o=>o.password===o.confirmPassword,{message:"Les mots de passe ne correspondent pas",path:["confirmPassword"]}),n=z(!1);async function w(o){n.value=!0;try{const e=await $fetch("/api/auth/register",{method:"POST",body:o.data});e.success&&(await u(),await p("/")),a.add({title:"Inscription réussie",description:`Bienvenue ${e.user.name} ! Votre compte a été créé avec succès.`,color:"success"})}catch(e){console.error("Erreur d'inscription:",e);let s="Une erreur s'est produite lors de l'inscription";e.statusCode===409?s="Un utilisateur avec cet email existe déjà":e.data?.message&&(s=e.data.message),a.add({title:"Erreur d'inscription",description:s,color:"error"})}finally{n.value=!1}}return(o,e)=>{const s=T,x=E;return _(),L(x,{fields:f,schema:c(v),providers:g,loading:c(n),title:"Créer un compte",icon:"i-lucide-user-plus",submit:{label:"Créer le compte"},onSubmit:w},{description:r(()=>[e[1]||(e[1]=t(" Vous avez déjà un compte ? ",-1)),d(s,{to:"/login",class:"text-primary font-medium"},{default:r(()=>[...e[0]||(e[0]=[t("Se connecter",-1)])]),_:1}),e[2]||(e[2]=t(". ",-1))]),footer:r(()=>[e[4]||(e[4]=t(" En vous inscrivant, vous acceptez nos ",-1)),d(s,{to:"/",class:"text-primary font-medium"},{default:r(()=>[...e[3]||(e[3]=[t("Conditions d'utilisation",-1)])]),_:1}),e[5]||(e[5]=t(". ",-1))]),_:1},8,["schema","loading"])}}});export{G as default};
