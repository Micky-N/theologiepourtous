import{r as U,D as I,aB as T,z as Y,E as ee,ar as te,a1 as se,a4 as re,I as A,w as g,a5 as oe,g as o,h as e,d as y,C as s,O as ae,P as ne,M as h,f as le,t as l,F as B,K as D,$,N as ie,aa as ce,S as de,ac as ue,e as c}from"#entry";import{_ as me}from"./C_fCq-or.js";import{u as ge}from"./38kU-qnc.js";const pe=()=>{const k=U([]),v=U(0),C=async r=>{const d={};r?.book&&(d.book=r.book),r?.chapter&&(d.chapter=r.chapter.toString()),r?.limit&&(d.limit=r.limit.toString()),r?.offset&&(d.offset=r.offset.toString());const{data:x}=await $fetch("/api/bible/bookmarks",{query:d});return k.value=x.bookmarks,v.value=x.pagination.total,x},z=async r=>(await $fetch(`/api/bible/bookmarks/${r}`,{method:"DELETE"}),k.value=k.value.filter(d=>d.id!==r),v.value=Math.max(0,v.value-1),{success:!0}),w=I(()=>{const r={};return k.value.forEach(d=>{const x=d.color||"gray";r[x]||(r[x]=[]),r[x].push(d)}),r}),_={red:"Rouge",orange:"Orange",amber:"Ambre",yellow:"Jaune",lime:"Lime",green:"Vert",emerald:"Émeraude",teal:"Sarcelle",cyan:"Cyan",sky:"Ciel",blue:"Bleu",indigo:"Indigo",violet:"Violet",purple:"Violet foncé",fuchsia:"Fuchsia",pink:"Rose",rose:"Rose pâle",stone:"Pierre",neutral:"Neutre",zinc:"Zinc",gray:"Gris",slate:"Ardoise"};return{bookmarks:T(k),total:T(v),groupedByColor:w,colorLabels:_,fetchBookmarks:C,deleteBookmark:z}},fe={key:0,class:"flex justify-center items-center py-12"},ye={key:1,class:"text-center py-12"},ve={key:2,class:"space-y-8"},xe={class:"bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700"},he={class:"flex flex-col gap-6"},_e={class:"flex flex-wrap gap-4"},ke={class:"flex items-center gap-2"},be={class:"font-semibold text-gray-900 dark:text-white"},we={class:"flex items-center gap-2"},Ce={class:"font-semibold text-gray-900 dark:text-white"},Se={class:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between"},Be={class:"flex items-center gap-3"},$e={class:"flex flex-wrap gap-2"},ze={key:0,class:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700"},Ae={class:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400"},De={class:"flex items-center gap-3 mb-4 ml-2.5"},Ue={class:"text-sm font-bold text-gray-900 dark:text-white"},Ie={class:"relative"},Ee={class:"space-y-6"},Le={class:"flex-1 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 shadow-sm hover:shadow-md transition-shadow"},Me={class:"flex justify-between items-start mb-4"},Fe={class:"flex-1"},Te={class:"font-semibold text-gray-900 dark:text-white text-lg"},Ve={class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},je={class:"flex flex-wrap gap-4 text-sm text-gray-500 dark:text-gray-400"},Ne={class:"flex items-center gap-1"},Oe={class:"flex items-center gap-1"},Re={class:"flex gap-3 justify-end"},He=Y({__name:"bookmarks",async setup(k){let v,C;const{bookmarks:z,total:w,groupedByColor:_,colorLabels:r,fetchBookmarks:d,deleteBookmark:x}=pe(),{status:V,error:E,refresh:j}=([v,C]=ee(()=>ge("bookmarks",()=>d(),{server:!1})),v=await v,C(),v),u=te({show:!1,loading:!1,bookmarkId:null}),i=U([]),L=se(),M=I(()=>{if(i.value.length===0)return _.value;const a={};return i.value.forEach(t=>{_.value&&_.value[t]&&(a[t]=_.value[t])}),a}),N=I(()=>i.value.length===0?w.value:Object.values(M.value).flat().length),O=a=>{const t=i.value.indexOf(a);t>-1?i.value.splice(t,1):i.value.push(a)},R=()=>{i.value=[]},q=a=>"neutral",G=a=>[[{label:"Supprimer",icon:"i-heroicons-trash",color:"red",onSelect:()=>P(a)}]],P=a=>{u.bookmarkId=a,u.show=!0},H=async()=>{if(u.bookmarkId)try{u.loading=!0,await x(u.bookmarkId),L.add({title:"Signet supprimé",description:"Le signet a été supprimé avec succès",color:"success"}),await j(),u.show=!1}catch(a){console.log(a),L.add({title:"Erreur",description:"Impossible de supprimer le signet",color:"error"})}finally{u.loading=!1,u.bookmarkId=null}},S=(a,t)=>`var(--color-${["red","orange","amber","yellow","lime","green","emerald","teal","cyan","sky","blue","indigo","violet","purple","fuchsia","pink","rose","stone","neutral","zinc","gray","slate"].includes(a)?a:"gray"}-${t})`,J=a=>{const t=new Date(a);return new Intl.DateTimeFormat("fr-FR",{day:"numeric",month:"long",year:"numeric"}).format(t)};return re({title:"Mes Signets - La Théologie pour Tous",meta:[{name:"description",content:"Gérez et consultez vos versets bibliques favoris avec nos signets personnalisés."}]}),(a,t)=>{const m=ae,F=me,b=ne,K=ie,Z=ce,Q=de,W=ue,X=oe;return c(),A(X,null,{default:g(()=>[o(Q,{class:"py-8"},{default:g(()=>[t[10]||(t[10]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900 dark:text-white"}," Mes Signets "),e("p",{class:"text-gray-600 dark:text-gray-400 mt-2"}," Retrouvez tous vos versets favoris organisés par couleur ")],-1)),["error","success"].includes(s(V))?(c(),y(B,{key:1},[s(E)?(c(),A(F,{key:0,title:"Erreur",description:s(E).message,color:"error",variant:"soft",class:"mb-6"},null,8,["description"])):s(z).length?(c(),y("div",ve,[e("div",xe,[e("div",he,[e("div",_e,[e("div",ke,[o(m,{name:"i-heroicons-bookmark",class:"text-primary-500"}),t[6]||(t[6]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Total:",-1)),e("span",be,l(s(w)),1)]),e("div",we,[o(m,{name:"i-heroicons-swatch",class:"text-purple-500"}),t[7]||(t[7]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Couleurs:",-1)),e("span",Ce,l(Object.keys(s(_)).length),1)])]),e("div",Se,[e("div",Be,[o(m,{name:"i-heroicons-funnel",class:"text-gray-500"}),t[8]||(t[8]=e("h3",{class:"font-semibold text-gray-900 dark:text-white"}," Filtrer par couleur ",-1))]),e("div",$e,[o(b,{variant:s(i).length===0?"solid":"outline",color:s(i).length===0?"primary":"neutral",size:"sm",onClick:R},{default:g(()=>[o(m,{name:"i-heroicons-swatch",class:"mr-1"}),h(" Toutes ("+l(s(w))+") ",1)]),_:1},8,["variant","color"]),(c(!0),y(B,null,D(s(_),(p,n)=>(c(),A(b,{key:String(n),variant:s(i).includes(String(n))?"solid":"outline",color:s(i).includes(String(n))?q(String(n)):"neutral",size:"sm",onClick:f=>O(String(n))},{default:g(()=>[e("div",{class:"w-3 h-3 rounded-full mr-2",style:$({backgroundColor:S(String(n),500)})},null,4),h(" "+l(s(r)[String(n)]||String(n).charAt(0).toUpperCase()+String(n).slice(1))+" ("+l(p.length)+") ",1)]),_:2},1032,["variant","color","onClick"]))),128))])]),s(i).length>0?(c(),y("div",ze,[e("div",Ae,[o(m,{name:"i-heroicons-information-circle"}),e("span",null,[h(" Affichage de "+l(s(N))+" signet(s) "+l(s(i).length===1?"de couleur":"des couleurs")+" ",1),e("strong",null,l(s(i).map(p=>s(r)[p]||p).join(", ")),1)])])])):le("",!0)])]),(c(!0),y(B,null,D(s(M),(p,n)=>(c(),y("div",{key:String(n),class:"space-y-4"},[e("div",De,[e("div",{class:"w-4 h-4 rounded-full border-2",style:$({borderColor:S(String(n),500)})},null,4),e("h6",Ue,l(s(r)[String(n)]||String(n).charAt(0).toUpperCase()+String(n).slice(1)),1),o(K,{color:"neutral",variant:"soft",size:"sm"},{default:g(()=>[h(l(p.length),1)]),_:2},1024)]),e("div",Ie,[e("div",{class:"absolute left-4 top-0 bottom-0 w-0.5",style:$({backgroundColor:S(String(n),200)})},null,4),e("div",Ee,[(c(!0),y(B,null,D(p,f=>(c(),y("div",{key:f.id,class:"relative flex gap-6"},[t[9]||(t[9]=e("div",{class:"relative flex-shrink-0 mr-2"},null,-1)),e("div",Le,[e("div",Me,[e("div",Fe,[e("h3",Te,l(f.title||f.reference),1),e("p",Ve,l(f.reference)+" - "+l(f.verse.version.name),1)]),o(Z,{items:G(f.id)},{default:g(()=>[o(b,{icon:"i-heroicons-ellipsis-horizontal",size:"sm",color:"neutral",variant:"ghost"})]),_:1},8,["items"])]),e("blockquote",{class:"border-l-4 pl-4 py-2 italic text-gray-700 dark:text-gray-300 mb-4",style:$({borderLeftColor:S(String(n),300)})},' "'+l(f.verse.text)+'" ',5),e("div",je,[e("div",Ne,[o(m,{name:"i-heroicons-book-open"}),h(" "+l(f.book.name),1)]),e("div",Oe,[o(m,{name:"i-heroicons-clock"}),h(" "+l(J(f.createdAt)),1)])])])]))),128))])])]))),128))])):(c(),y("div",ye,[o(m,{name:"i-heroicons-bookmark-slash",class:"text-6xl text-gray-400 mb-4"}),t[4]||(t[4]=e("h3",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-2"}," Aucun signet trouvé ",-1)),t[5]||(t[5]=e("p",{class:"text-gray-600 dark:text-gray-400 mb-6"}," Commencez à marquer vos versets préférés lors de vos lectures ",-1)),o(b,{to:"/bible",color:"primary",variant:"solid"},{default:g(()=>[o(m,{name:"i-heroicons-book-open",class:"mr-2"}),t[3]||(t[3]=h(" Lire la Bible ",-1))]),_:1})]))],64)):(c(),y("div",fe,[o(m,{name:"i-heroicons-arrow-path",class:"animate-spin text-primary-500 text-2xl"}),t[2]||(t[2]=e("span",{class:"ml-3 text-gray-600 dark:text-gray-400"},"Chargement des signets...",-1))]))]),_:1}),o(W,{open:s(u).show,"onUpdate:open":t[1]||(t[1]=p=>s(u).show=p),title:"Supprimer le signet"},{body:g(()=>[...t[11]||(t[11]=[e("p",{class:"text-gray-600 dark:text-gray-400"}," Êtes-vous sûr de vouloir supprimer ce signet ? Cette action est irréversible. ",-1)])]),footer:g(()=>[e("div",Re,[o(b,{color:"neutral",variant:"soft",onClick:t[0]||(t[0]=p=>s(u).show=!1)},{default:g(()=>[...t[12]||(t[12]=[h(" Annuler ",-1)])]),_:1}),o(b,{color:"error",loading:s(u).loading,onClick:H},{default:g(()=>[...t[13]||(t[13]=[h(" Supprimer ",-1)])]),_:1},8,["loading"])])]),_:1},8,["open"])]),_:1})}}});export{He as default};
