import{B as z,a5 as E,v as O,C as R,K as V,D as j,ba as F,z as r,f as u,G as t,w as n,J as H,e as o,h as l,g as d,d as m,F as x,H as b,O as M,L as G,M as f,t as w,P as J,Q as K,R as Q}from"#entry";import{_ as W,a as X}from"./BiYaFSpO.js";import{_ as Y,a as Z,b as ee}from"./BjEAYeDG.js";import{u as v}from"./B7UDBhQ8.js";import{q as te,a as se}from"./Czxye75v.js";import"./00vjDVcM.js";import"./iik6CYzq.js";import"./CDYECTYn.js";const oe=["src"],ne={class:"flex flex-col lg:flex-row items-start lg:items-center space-x-1"},ae={class:"text-muted"},re={key:0},le={class:"flex flex-col md:flex-row md:items-center gap-2 mt-4"},ie={key:0,class:"text-sm font-medium text-muted"},ce={class:"flex flex-wrap items-center gap-2"},ye=z({__name:"[slug]",async setup(ue){let p,y;const{loggedIn:$}=E(),i=O(),{data:e}=([p,y]=R(()=>v(i.path,()=>te("lessons").path(i.path).first(),"$jlyxFBwIyO")),p=await p,y(),p);if(!e.value)throw V({statusCode:404,statusMessage:"Lesson not found",fatal:!0});const{data:g,refresh:C}=v(i.path+"-progress",()=>$fetch(`/api/teaching/progress/${e.value?.theme}`,{method:"GET"}),{immediate:$.value}),{data:k}=v(`${i.path}-surround`,()=>se("lessons",i.path,{fields:["description"]}).where("theme","=",i.params.theme)),U=_=>{if(!g.value?.data)return!1;const s=g.value?.data.lessons;if(!s)return!1;const c=JSON.parse(s);return c.length&&c.includes(_)},h=async _=>{try{await $fetch(`/api/teaching/progress/${e.value?.theme}`,{method:"POST",body:{lesson:_}}),await C()}catch(s){console.log(s)}};return j({title:e.value.title,description:e.value.seo.description,keywords:e.value.seo.keywords,author:"Théologie pour Tous",ogTitle:e.value.title,ogDescription:e.value.seo.description,ogImage:e.value.image.src,ogType:"article",ogUrl:e.value.seo.url,twitterCard:e.value.seo.card,twitterTitle:e.value.title,twitterDescription:e.value.seo.description,twitterImage:e.value.image.src}),F({htmlAttrs:{lang:e.value?.seo.lang||"fr"},link:[{rel:"canonical",href:e.value.seo.url}]}),(_,s)=>{const c=G,S=M,B=W,T=Y,D=Q,P=Z,A=X,I=ee,L=J,N=H;return t(e)?(o(),r(N,{key:0},{default:n(()=>[l("img",{src:t(e).image.src,class:"w-full aspect-video rounded-b-xl max-h-[32rem] object-cover object-center"},null,8,oe),d(B,{title:t(e).title,description:t(e).description},{headline:n(()=>[l("div",ne,[U(t(e).slug)?(o(),r(c,{key:0,icon:"i-lucide-circle-check-big",size:"xs",color:"success",variant:"subtle",onClick:s[0]||(s[0]=a=>h(t(e).slug))},{default:n(()=>[...s[3]||(s[3]=[f(" Appris ",-1)])]),_:1})):t(g)?.data?(o(),r(c,{key:1,icon:"i-lucide-circle-dashed",size:"xs",color:"primary",variant:"subtle",onClick:s[1]||(s[1]=a=>h(t(e).slug))},{default:n(()=>[...s[4]||(s[4]=[f(" En cours ",-1)])]),_:1})):(o(),r(c,{key:2,icon:"i-lucide-circle-dashed",size:"xs",color:"warning",variant:"subtle",onClick:s[2]||(s[2]=a=>h(t(e).slug))},{default:n(()=>[...s[5]||(s[5]=[f(" Pas commencer ",-1)])]),_:1})),l("time",ae,w(new Date(t(e).date).toLocaleDateString("fr",{year:"numeric",month:"long",day:"numeric"})),1),s[6]||(s[6]=l("span",{class:"hidden lg:block text-muted"},"·",-1)),l("div",null,[(o(!0),m(x,null,b(t(e).tags,(a,q)=>(o(),m("span",{key:a,class:"text-warning-600 font-light"},[f(w(a),1),q!==t(e).tags.length-1?(o(),m("span",re,", ")):u("",!0)]))),128))])])]),default:n(()=>[l("div",le,[t(e).biblical_references?.length?(o(),m("h3",ie," Références bibliques : ")):u("",!0),l("div",ce,[(o(!0),m(x,null,b(t(e).biblical_references,a=>(o(),r(S,{key:a,label:a,color:"secondary",variant:"subtle"},null,8,["label"]))),128))])])]),_:1},8,["title","description"]),d(L,null,K({default:n(()=>[d(A,null,{default:n(()=>[t(e)?(o(),r(T,{key:0,value:t(e)},null,8,["value"])):u("",!0),t(k)?.length?(o(),r(D,{key:1})):u("",!0),d(P,{surround:t(k)},null,8,["surround"])]),_:1})]),_:2},[t(e)?.body?.toc?.links?.length?{name:"right",fn:n(()=>[d(I,{links:t(e).body.toc.links},null,8,["links"])]),key:"0"}:void 0]),1024)]),_:1})):u("",!0)}}});export{ye as default};
