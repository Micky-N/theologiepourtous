import{B as Z,bb as se,bc as ce,b2 as Be,r as V,a6 as ue,z as $,aq as qe,H as t,w as n,g as l,L as X,M as E,b5 as de,aW as Te,h as y,a4 as me,Z as G,e as i,$ as ge,b3 as ze,y as ve,aK as Oe,aL as fe,aA as pe,bd as Ve,b7 as Ue,V as N,aT as Ne,d as P,X as j,f as _,n as z,N as Pe,G as D,aQ as W,t as A,F,I as J,be as Ae,bf as R,as as _e,Q as Y,b6 as be,a7 as Ee,bg as Ke,bh as Re,ay as ne,aB as re,aJ as je,a0 as ie,bi as Me,bj as De,v as he,a5 as ye,bk as Fe,J as H,W as ke,aZ as Ge,a8 as Je,C as ae,a as Qe,D as We,o as Ze,bl as He,P as Xe,ba as Ye,R as et}from"#entry";import{_ as tt}from"./lF-cOGfW.js";import{_ as at,a as ot}from"./CVgFCWlT.js";import{_ as xe}from"./g6Za9bgq.js";import{_ as le}from"./Bj6CTjPb.js";import{_ as st}from"./DM6w0mxt.js";import{_ as nt}from"./DIUlgoGd.js";import{_ as rt}from"./Dp9YWf1p.js";import{_ as lt}from"./C0CPpTht.js";import{u as oe}from"./B_Cg5Li1.js";import{d as it}from"./D8rO69WY.js";import"./Dcm9wb4e.js";import"./9v54ouTo.js";import"./CRu-j2f3.js";import"./BD63mw3m.js";import"./DW03Qsmw.js";const ct={class:"flex items-center gap-2"},ut={class:"mt-2 flex items-center gap-1"},dt=Z({__name:"BookmarkFormPopover",props:se({verseId:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:se(["closeForm","created"],["update:modelValue"]),setup(e,{emit:g}){const o=e,v=g,p=ce(e,"modelValue"),b=Be({title:"",color:"blue"}),S=[{label:"Rouge",value:"red"},{label:"Rose",value:"pink"},{label:"Fuchsia",value:"fuchsia"},{label:"Violet",value:"purple"},{label:"Violet clair",value:"violet"},{label:"Indigo",value:"indigo"},{label:"Bleu",value:"blue"},{label:"Ciel",value:"sky"},{label:"Cyan",value:"cyan"},{label:"Teal",value:"teal"},{label:"Émeraude",value:"emerald"},{label:"Vert",value:"green"},{label:"Lime",value:"lime"},{label:"Jaune",value:"yellow"},{label:"Ambre",value:"amber"},{label:"Orange",value:"orange"},{label:"Brun",value:"brown"},{label:"Gris",value:"gray"},{label:"Gris neutre",value:"neutral"},{label:"Ardoise",value:"slate"},{label:"Pierre",value:"stone"},{label:"Zinc",value:"zinc"},{label:"Noir",value:"black"}],I=V(!1),d=V(""),c=ue();function k(){p.value=!1,v("closeForm")}async function L(){d.value="",I.value=!0;try{const B=await $fetch("/api/bible/bookmarks",{method:"POST",body:{verseId:o.verseId,title:b.title,color:b.color}});B.success?(c.add({title:"Favori ajouté",description:B.message,color:"primary"}),v("created",B.data),k()):d.value=B.message||"Erreur inconnue"}catch(B){d.value=B?.statusMessage||"Erreur lors de l’ajout du favori"}finally{I.value=!1}}return(B,u)=>{const m=G,f=Te,s=de,h=xe,a=X,C=le,x=st;return i(),$(x,{state:t(b),onSubmit:qe(L,["prevent"])},{default:n(()=>[l(C,{ui:{header:"p-2 sm:px-4",footer:"p-2 sm:px-4"}},{header:n(()=>[y("div",ct,[l(m,{name:"i-lucide-bookmark",class:"text-primary-600"}),u[2]||(u[2]=y("span",{class:"font-semibold text-sm"},"Ajouter aux signets",-1))])]),default:n(()=>[l(s,{label:"Titre (optionnel)",name:"title",class:"mb-4"},{default:n(()=>[l(f,{modelValue:t(b).title,"onUpdate:modelValue":u[0]||(u[0]=w=>t(b).title=w),placeholder:"Titre personnalisé...",class:"w-full"},null,8,["modelValue"])]),_:1}),l(s,{label:"Couleur du favori",name:"color"},{default:n(()=>[l(h,{modelValue:t(b).color,"onUpdate:modelValue":u[1]||(u[1]=w=>t(b).color=w),items:S,"label-key":"label","value-key":"value",class:"flex gap-2 w-full"},null,8,["modelValue"]),y("div",ut,[u[3]||(u[3]=E(" Aperçu : ",-1)),y("span",{style:me([`background-color: var(--color-${t(b).color}-400)`,`border: solid 1px var(--color-${t(b).color}-700)`]),class:"inline-block size-4 rounded-full border"},null,4)])]),_:1})]),footer:n(()=>[l(a,{type:"submit",color:"primary",loading:t(I),class:"w-full flex justify-center"},{default:n(()=>[...u[4]||(u[4]=[E(" Ajouter ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["state"])}}}),mt=Object.assign(dt,{__name:"BookmarkFormPopover"}),Se={__name:"UContextMenuContent",props:{items:{type:null,required:!1},portal:{type:[Boolean,String],required:!1,skipCheck:!0},sub:{type:Boolean,required:!1},labelKey:{type:null,required:!0},checkedIcon:{type:[String,Object],required:!1},loadingIcon:{type:[String,Object],required:!1},externalIcon:{type:[Boolean,String,Object],required:!1},class:{type:null,required:!1},ui:{type:null,required:!0},uiOverride:{type:null,required:!1},loop:{type:Boolean,required:!1},sideFlip:{type:Boolean,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","closeAutoFocus"],setup(e,{emit:g}){const o=e,v=g,p=ge(),{dir:b}=ze(),S=ve(),I=Oe(fe(()=>o.portal)),d=pe(Ve(o,"sub","items","portal","labelKey","checkedIcon","loadingIcon","externalIcon","class","ui","uiOverride"),v),c=()=>be(p,["default"]),[k,L]=Ue(),B=N(()=>b.value==="rtl"?S.ui.icons.chevronLeft:S.ui.icons.chevronRight),u=N(()=>o.items?.length?Ne(o.items)?o.items:[o.items]:[]);return(m,f)=>(i(),P(F,null,[l(t(k),null,{default:n(({item:s,active:h,index:a})=>[j(m.$slots,s.slot||"item",{item:s,index:a},()=>[j(m.$slots,s.slot?`${s.slot}-leading`:"item-leading",{item:s,active:h,index:a},()=>[s.loading?(i(),$(G,{key:0,name:e.loadingIcon||t(S).ui.icons.loading,class:z(e.ui.itemLeadingIcon({class:[e.uiOverride?.itemLeadingIcon,s.ui?.itemLeadingIcon],color:s?.color,loading:!0}))},null,8,["name","class"])):s.icon?(i(),$(G,{key:1,name:s.icon,class:z(e.ui.itemLeadingIcon({class:[e.uiOverride?.itemLeadingIcon,s.ui?.itemLeadingIcon],color:s?.color,active:h}))},null,8,["name","class"])):s.avatar?(i(),$(Pe,D({key:2,size:s.ui?.itemLeadingAvatarSize||e.uiOverride?.itemLeadingAvatarSize||e.ui.itemLeadingAvatarSize()},s.avatar,{class:e.ui.itemLeadingAvatar({class:[e.uiOverride?.itemLeadingAvatar,s.ui?.itemLeadingAvatar],active:h})}),null,16,["size","class"])):_("",!0)]),t(W)(s,o.labelKey)||p[s.slot?`${s.slot}-label`:"item-label"]?(i(),P("span",{key:0,class:z(e.ui.itemLabel({class:[e.uiOverride?.itemLabel,s.ui?.itemLabel],active:h}))},[j(m.$slots,s.slot?`${s.slot}-label`:"item-label",{item:s,active:h,index:a},()=>[E(A(t(W)(s,o.labelKey)),1)]),s.target==="_blank"&&e.externalIcon!==!1?(i(),$(G,{key:0,name:typeof e.externalIcon=="string"?e.externalIcon:t(S).ui.icons.external,class:z(e.ui.itemLabelExternalIcon({class:[e.uiOverride?.itemLabelExternalIcon,s.ui?.itemLabelExternalIcon],color:s?.color,active:h}))},null,8,["name","class"])):_("",!0)],2)):_("",!0),y("span",{class:z(e.ui.itemTrailing({class:[e.uiOverride?.itemTrailing,s.ui?.itemTrailing]}))},[j(m.$slots,s.slot?`${s.slot}-trailing`:"item-trailing",{item:s,active:h,index:a},()=>[s.children?.length?(i(),$(G,{key:0,name:B.value,class:z(e.ui.itemTrailingIcon({class:[e.uiOverride?.itemTrailingIcon,s.ui?.itemTrailingIcon],color:s?.color,active:h}))},null,8,["name","class"])):s.kbds?.length?(i(),P("span",{key:1,class:z(e.ui.itemTrailingKbds({class:[e.uiOverride?.itemTrailingKbds,s.ui?.itemTrailingKbds]}))},[(i(!0),P(F,null,J(s.kbds,(C,x)=>(i(),$(Ae,D({key:x,size:s.ui?.itemTrailingKbdsSize||e.uiOverride?.itemTrailingKbdsSize||e.ui.itemTrailingKbdsSize()},{ref_for:!0},typeof C=="string"?{value:C}:C),null,16,["size"]))),128))],2)):_("",!0)]),l(t(R).ItemIndicator,{"as-child":""},{default:n(()=>[l(G,{name:e.checkedIcon||t(S).ui.icons.check,class:z(e.ui.itemTrailingIcon({class:[e.uiOverride?.itemTrailingIcon,s.ui?.itemTrailingIcon],color:s?.color}))},null,8,["name","class"])]),_:2},1024)],2)])]),_:3}),l(t(R).Portal,ne(re(t(I))),{default:n(()=>[(i(),$(_e(e.sub?t(R).SubContent:t(R).Content),D({class:o.class},t(d)),{default:n(()=>[j(m.$slots,"content-top"),y("div",{role:"presentation",class:z(e.ui.viewport({class:e.uiOverride?.viewport}))},[(i(!0),P(F,null,J(u.value,(s,h)=>(i(),$(t(R).Group,{key:`group-${h}`,class:z(e.ui.group({class:e.uiOverride?.group}))},{default:n(()=>[(i(!0),P(F,null,J(s,(a,C)=>(i(),P(F,{key:`group-${h}-${C}`},[a.type==="label"?(i(),$(t(R).Label,{key:0,class:z(e.ui.label({class:[e.uiOverride?.label,a.ui?.label,a.class]}))},{default:n(()=>[l(t(L),{item:a,index:C},null,8,["item","index"])]),_:2},1032,["class"])):a.type==="separator"?(i(),$(t(R).Separator,{key:1,class:z(e.ui.separator({class:[e.uiOverride?.separator,a.ui?.separator,a.class]}))},null,8,["class"])):a?.children?.length?(i(),$(t(R).Sub,{key:2,open:a.open,"default-open":a.defaultOpen},{default:n(()=>[l(t(R).SubTrigger,{as:"button",type:"button",disabled:a.disabled,"text-value":t(W)(a,o.labelKey),class:z(e.ui.item({class:[e.uiOverride?.item,a.ui?.item,a.class],color:a?.color}))},{default:n(()=>[l(t(L),{item:a,index:C},null,8,["item","index"])]),_:2},1032,["disabled","text-value","class"]),l(Se,D({sub:"",class:o.class,ui:e.ui,"ui-override":e.uiOverride,portal:e.portal,items:a.children,"align-offset":-4,"label-key":e.labelKey,"checked-icon":e.checkedIcon,"loading-icon":e.loadingIcon,"external-icon":e.externalIcon},{ref_for:!0},a.content),Y({_:2},[J(c(),(x,w)=>({name:w,fn:n(K=>[j(m.$slots,w,D({ref_for:!0},K))])}))]),1040,["class","ui","ui-override","portal","items","label-key","checked-icon","loading-icon","external-icon"])]),_:2},1032,["open","default-open"])):a.type==="checkbox"?(i(),$(t(R).CheckboxItem,{key:3,"model-value":a.checked,disabled:a.disabled,"text-value":t(W)(a,o.labelKey),class:z(e.ui.item({class:[e.uiOverride?.item,a.ui?.item,a.class],color:a?.color})),"onUpdate:modelValue":a.onUpdateChecked,onSelect:a.onSelect},{default:n(()=>[l(t(L),{item:a,index:C},null,8,["item","index"])]),_:2},1032,["model-value","disabled","text-value","class","onUpdate:modelValue","onSelect"])):(i(),$(t(R).Item,{key:4,"as-child":"",disabled:a.disabled,"text-value":t(W)(a,o.labelKey),onSelect:a.onSelect},{default:n(()=>[l(Ee,D({ref_for:!0},t(Ke)(a),{custom:""}),{default:n(({active:x,...w})=>[l(Re,D({ref_for:!0},w,{class:e.ui.item({class:[e.uiOverride?.item,a.ui?.item,a.class],active:x,color:a?.color})}),{default:n(()=>[l(t(L),{item:a,active:x,index:C},null,8,["item","active","index"])]),_:2},1040,["class"])]),_:2},1040)]),_:2},1032,["disabled","text-value","onSelect"]))],64))),128))]),_:2},1032,["class"]))),128))],2),j(m.$slots,"default"),j(m.$slots,"content-bottom")]),_:3},16,["class"]))]),_:3},16)],64))}},gt={slots:{content:"min-w-32 bg-default shadow-lg rounded-md ring ring-default overflow-hidden data-[state=open]:animate-[scale-in_100ms_ease-out] data-[state=closed]:animate-[scale-out_100ms_ease-in] origin-(--reka-context-menu-content-transform-origin) flex flex-col",viewport:"relative divide-y divide-default scroll-py-1 overflow-y-auto flex-1",group:"p-1 isolate",label:"w-full flex items-center font-semibold text-highlighted",separator:"-mx-1 my-1 h-px bg-border",item:"group relative w-full flex items-center select-none outline-none before:absolute before:z-[-1] before:inset-px before:rounded-md data-disabled:cursor-not-allowed data-disabled:opacity-75",itemLeadingIcon:"shrink-0",itemLeadingAvatar:"shrink-0",itemLeadingAvatarSize:"",itemTrailing:"ms-auto inline-flex gap-1.5 items-center",itemTrailingIcon:"shrink-0",itemTrailingKbds:"hidden lg:inline-flex items-center shrink-0",itemTrailingKbdsSize:"",itemLabel:"truncate",itemLabelExternalIcon:"inline-block size-3 align-top text-dimmed"},variants:{color:{primary:"",secondary:"",success:"",info:"",warning:"",error:"",neutral:""},active:{true:{item:"text-highlighted before:bg-elevated",itemLeadingIcon:"text-default"},false:{item:["text-default data-highlighted:text-highlighted data-[state=open]:text-highlighted data-highlighted:before:bg-elevated/50 data-[state=open]:before:bg-elevated/50","transition-colors before:transition-colors"],itemLeadingIcon:["text-dimmed group-data-highlighted:text-default group-data-[state=open]:text-default","transition-colors"]}},loading:{true:{itemLeadingIcon:"animate-spin"}},size:{xs:{label:"p-1 text-xs gap-1",item:"p-1 text-xs gap-1",itemLeadingIcon:"size-4",itemLeadingAvatarSize:"3xs",itemTrailingIcon:"size-4",itemTrailingKbds:"gap-0.5",itemTrailingKbdsSize:"sm"},sm:{label:"p-1.5 text-xs gap-1.5",item:"p-1.5 text-xs gap-1.5",itemLeadingIcon:"size-4",itemLeadingAvatarSize:"3xs",itemTrailingIcon:"size-4",itemTrailingKbds:"gap-0.5",itemTrailingKbdsSize:"sm"},md:{label:"p-1.5 text-sm gap-1.5",item:"p-1.5 text-sm gap-1.5",itemLeadingIcon:"size-5",itemLeadingAvatarSize:"2xs",itemTrailingIcon:"size-5",itemTrailingKbds:"gap-0.5",itemTrailingKbdsSize:"md"},lg:{label:"p-2 text-sm gap-2",item:"p-2 text-sm gap-2",itemLeadingIcon:"size-5",itemLeadingAvatarSize:"2xs",itemTrailingIcon:"size-5",itemTrailingKbds:"gap-1",itemTrailingKbdsSize:"md"},xl:{label:"p-2 text-base gap-2",item:"p-2 text-base gap-2",itemLeadingIcon:"size-6",itemLeadingAvatarSize:"xs",itemTrailingIcon:"size-6",itemTrailingKbds:"gap-1",itemTrailingKbdsSize:"lg"}}},compoundVariants:[{color:"primary",active:!1,class:{item:"text-primary data-highlighted:text-primary data-highlighted:before:bg-primary/10 data-[state=open]:before:bg-primary/10",itemLeadingIcon:"text-primary/75 group-data-highlighted:text-primary group-data-[state=open]:text-primary"}},{color:"secondary",active:!1,class:{item:"text-secondary data-highlighted:text-secondary data-highlighted:before:bg-secondary/10 data-[state=open]:before:bg-secondary/10",itemLeadingIcon:"text-secondary/75 group-data-highlighted:text-secondary group-data-[state=open]:text-secondary"}},{color:"success",active:!1,class:{item:"text-success data-highlighted:text-success data-highlighted:before:bg-success/10 data-[state=open]:before:bg-success/10",itemLeadingIcon:"text-success/75 group-data-highlighted:text-success group-data-[state=open]:text-success"}},{color:"info",active:!1,class:{item:"text-info data-highlighted:text-info data-highlighted:before:bg-info/10 data-[state=open]:before:bg-info/10",itemLeadingIcon:"text-info/75 group-data-highlighted:text-info group-data-[state=open]:text-info"}},{color:"warning",active:!1,class:{item:"text-warning data-highlighted:text-warning data-highlighted:before:bg-warning/10 data-[state=open]:before:bg-warning/10",itemLeadingIcon:"text-warning/75 group-data-highlighted:text-warning group-data-[state=open]:text-warning"}},{color:"error",active:!1,class:{item:"text-error data-highlighted:text-error data-highlighted:before:bg-error/10 data-[state=open]:before:bg-error/10",itemLeadingIcon:"text-error/75 group-data-highlighted:text-error group-data-[state=open]:text-error"}},{color:"primary",active:!0,class:{item:"text-primary before:bg-primary/10",itemLeadingIcon:"text-primary"}},{color:"secondary",active:!0,class:{item:"text-secondary before:bg-secondary/10",itemLeadingIcon:"text-secondary"}},{color:"success",active:!0,class:{item:"text-success before:bg-success/10",itemLeadingIcon:"text-success"}},{color:"info",active:!0,class:{item:"text-info before:bg-info/10",itemLeadingIcon:"text-info"}},{color:"warning",active:!0,class:{item:"text-warning before:bg-warning/10",itemLeadingIcon:"text-warning"}},{color:"error",active:!0,class:{item:"text-error before:bg-error/10",itemLeadingIcon:"text-error"}}],defaultVariants:{size:"md"}},vt={__name:"UContextMenu",props:{size:{type:null,required:!1},items:{type:null,required:!1},checkedIcon:{type:[String,Object],required:!1},loadingIcon:{type:[String,Object],required:!1},externalIcon:{type:[Boolean,String,Object],required:!1,default:!0},content:{type:Object,required:!1},portal:{type:[Boolean,String],required:!1,skipCheck:!0,default:!0},labelKey:{type:null,required:!1,default:"label"},disabled:{type:Boolean,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1},pressOpenDelay:{type:Number,required:!1},modal:{type:Boolean,required:!1,default:!0}},emits:["update:open"],setup(e,{emit:g}){const o=e,v=g,p=ge(),b=ve(),S=pe(je(o,"modal"),v),I=fe(()=>o.content),d=()=>be(p,["default"]),c=N(()=>ie({extend:ie(gt),...b.ui?.contextMenu||{}})({size:o.size}));return(k,L)=>(i(),$(t(De),ne(re(t(S))),{default:n(()=>[p.default?(i(),$(t(Me),{key:0,"as-child":"",disabled:e.disabled,class:z(o.class)},{default:n(()=>[j(k.$slots,"default")]),_:3},8,["disabled","class"])):_("",!0),l(Se,D({class:c.value.content({class:[!p.default&&o.class,o.ui?.content]}),ui:c.value,"ui-override":o.ui},I.value,{items:e.items,portal:e.portal,"label-key":e.labelKey,"checked-icon":e.checkedIcon,"loading-icon":e.loadingIcon,"external-icon":e.externalIcon}),Y({_:2},[J(d(),(B,u)=>({name:u,fn:n(m=>[j(k.$slots,u,ne(re(m)))])}))]),1040,["class","ui","ui-override","items","portal","label-key","checked-icon","loading-icon","external-icon"])]),_:3},16))}},ft={class:"inline-block align-top text-xs text-primary-600 dark:text-primary-400"},pt={class:"flex items-center justify-between gap-2"},bt=Z({__name:"BibleVerse",props:{book:{},verse:{},notes:{},bookmark:{}},emits:["showCompare","addNote","refreshBookmark","refreshNote"],setup(e,{emit:g}){const o=e,v=g,p=he(),b=V(!1),S=V(!1),I=ue(),d=V(!1),c=V(!1),k=p.query.verse,{loggedIn:L}=ye(),B=N(()=>{const h=[{label:"Comparer",icon:"i-lucide-eye",onSelect:()=>v("showCompare",o.verse.verse),ui:{item:"cursor-pointer"}}];return L.value&&(h.push({label:"Marquer",icon:"i-lucide-bookmark",onSelect:()=>S.value=!0,ui:{item:"cursor-pointer"}}),h.push({label:"Ajouter Note",icon:"i-lucide-notebook-pen",onSelect:()=>c.value=!0,ui:{item:"cursor-pointer"}})),h}),u=async()=>{if(o.bookmark)try{await $fetch(`/api/bible/bookmarks/${o.bookmark.id}`,{method:"DELETE"}),I.add({title:"Signet supprimé",description:"Le signet a été supprimer avec succès"}),v("refreshBookmark")}catch(h){console.log(h)}},m=V(null),f=h=>{m.value=h,c.value=!0},s=N(()=>{if(!k)return!1;if(k===o.verse.verse.toString())return!0;if(!k.includes("-")&&!k.includes(";"))return!1;const h=k.split(";").map(x=>x.trim());if(h.length>1)return h.some(x=>{const w=x.split("-").map(M=>M.trim()),K=[];for(let M=Number(w[0]);M<=Number(w[w.length-1]);M++)K.push(M.toString());return K.includes(o.verse.verse.toString())});const a=k.split("-").map(x=>x.trim()),C=[];for(let x=Number(a[0]);x<=Number(a[a.length-1]);x++)C.push(x.toString());return C.includes(o.verse.verse.toString())});return(h,a)=>{const C=G,x=X,w=le,K=Fe,M=mt,ee=vt,te=nt,Q=rt;return i(),P(F,null,[l(ee,{items:t(B)},{default:n(()=>[y("span",null,[t(L)&&e.notes.length?(i(),P("button",{key:0,class:"cursor-pointer mr-0.5",onClick:a[0]||(a[0]=T=>d.value=!0)},[l(C,{name:"i-lucide-notebook-pen",class:"size-3 text-warning-500 dark:text-warning-400"})])):_("",!0),y("span",ft,A(e.verse.verse),1),l(K,{open:t(S),"onUpdate:open":a[5]||(a[5]=T=>H(S)?S.value=T:null),content:{sideOffset:0},arrow:""},{anchor:n(()=>[y("span",{class:z({underline:t(S)||e.bookmark,"bg-yellow-500/20":t(s)})},[e.bookmark?(i(),$(K,{key:1,mode:"hover",arrow:"","onUpdate:open":a[2]||(a[2]=T=>!T&&(b.value=!1))},{content:n(()=>[l(w,{ui:{header:"p-2 sm:px-4",footer:"p-2 sm:px-4 flex items-center space-x-4"}},Y({header:n(()=>[y("div",pt,[y("p",null,A(e.bookmark.title||"Signet"),1),y("span",{class:"cursor-pointer rounded-sm bg-gray-50 hover:bg-red-50 flex items-center justify-center p-1 text-red-500 hover:text-red-700",onClick:a[1]||(a[1]=T=>b.value=!0)},[l(C,{name:"i-lucide-trash-2"})])])]),_:2},[t(b)?{name:"footer",fn:n(()=>[l(x,{size:"sm",color:"error",onClick:u},{default:n(()=>[...a[10]||(a[10]=[E(" Supprimer ",-1)])]),_:1}),l(x,{size:"sm",variant:"outline",color:"neutral"},{default:n(()=>[...a[11]||(a[11]=[E(" Annuler ",-1)])]),_:1})]),key:"0"}:void 0]),1024)]),default:n(()=>[y("span",{class:z(["decoration-2",{underline:t(S)||e.bookmark}]),style:me(`text-decoration-color: var(--color-${e.bookmark?.color}-500)`)},A(e.verse.text),7)]),_:1})):(i(),P(F,{key:0},[E(A(e.verse.text),1)],64))],2)]),content:n(()=>[l(M,{"verse-id":e.verse.id,onCloseForm:a[3]||(a[3]=T=>S.value=!1),onCreated:a[4]||(a[4]=T=>v("refreshBookmark"))},null,8,["verse-id"])]),_:1},8,["open"])])]),_:1},8,["items"]),l(te,{open:t(d),"onUpdate:open":a[6]||(a[6]=T=>H(d)?d.value=T:null),notes:e.notes,verse:e.verse,book:e.book,"onEdit:note":f,onRefreshNote:a[7]||(a[7]=T=>v("refreshNote"))},null,8,["open","notes","verse","book"]),l(Q,{open:t(c),"onUpdate:open":a[8]||(a[8]=T=>H(c)?c.value=T:null),verse:e.verse,book:e.book,note:t(m),onRefreshNote:a[9]||(a[9]=T=>v("refreshNote"))},null,8,["open","verse","book","note"])],64)}}}),ht=Object.assign(bt,{__name:"BibleVerse"}),yt={class:"p-6"},kt={class:"space-y-4"},xt={class:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg"},St={class:"font-medium"},It={key:0},wt={class:"grid grid-cols-1 sm:grid-cols-2 gap-4 max-h-60 overflow-y-auto"},$t=["onClick"],Ct={class:"text-sm font-medium text-gray-900 dark:text-white"},Lt={class:"text-xs text-gray-500 dark:text-gray-400"},Bt={class:"mt-2 text-xs text-gray-500"},qt={class:"flex justify-end gap-2 mt-6"},Tt=Z({__name:"BibleCompareModal",props:se({availableVersions:{},book:{},chapter:{},version:{},verseStart:{},verseEnd:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const g=e,o=ce(e,"modelValue"),v=V(!1),p=V([g.version]),b=I=>{const d=p.value.indexOf(I);d>-1?p.value.splice(d,1):p.value.length<6&&p.value.push(I)},S=async()=>{if(!(p.value.length<2))try{v.value=!0;const I=g.availableVersions.filter(c=>p.value.includes(c.id)).map(c=>c.code),d=new URLSearchParams({book:g.book.code,chapter:g.chapter.toString(),verses:g.verseStart.toString(),versions:I.join(",")});g.verseEnd&&g.verseEnd!==g.verseStart&&d.set("verses",g.verseStart.toString()+"-"+g.verseEnd.toString()),await Je(`/bible/compare?${d.toString()}`)}catch(I){console.error("Erreur lors de la comparaison:",I)}finally{v.value=!1,o.value=!1}};return ke(()=>g.version,I=>{p.value=[I]}),(I,d)=>{const c=lt,k=de,L=X,B=Ge;return i(),$(B,{open:o.value,"onUpdate:open":d[1]||(d[1]=u=>o.value=u),title:"Comparer ce passage",description:"Terme théologique",ui:{description:"hidden",content:"max-w-2xl"}},{content:n(()=>[y("div",yt,[y("div",kt,[y("div",null,[d[2]||(d[2]=y("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-2"}," Passage sélectionné : ",-1)),y("div",xt,[y("p",St,[E(A(e.book.name)+" "+A(e.chapter)+":"+A(e.verseStart)+" ",1),e.verseEnd&&e.verseEnd!==e.verseStart?(i(),P("span",It," -"+A(e.verseEnd),1)):_("",!0)])])]),l(k,{label:"Versions à comparer (sélectionnez 2 à 6 versions)"},{default:n(()=>[y("div",wt,[(i(!0),P(F,null,J(e.availableVersions,u=>(i(),P("div",{key:u.id,class:"flex items-center space-x-2"},[l(c,{"model-value":t(p).includes(u.id),disabled:t(p).length>=6&&!t(p).includes(u.id),"onUpdate:modelValue":m=>b(u.id)},null,8,["model-value","disabled","onUpdate:modelValue"]),y("div",{class:"flex-1",onClick:m=>b(u.id)},[y("div",Ct,A(u.name),1),y("div",Lt,A(u.code)+" • "+A(u.language),1)],8,$t)]))),128))]),y("div",Bt,A(t(p).length)+" version(s) sélectionnée(s) (minimum 2, maximum 6) ",1)]),_:1})]),y("div",qt,[l(L,{label:"Annuler",variant:"ghost",onClick:d[0]||(d[0]=u=>o.value=!1)}),l(L,{label:"Comparer",disabled:t(p).length<2,loading:t(v),onClick:S},null,8,["disabled","loading"])])])]),_:1},8,["open"])}}}),zt=Object.assign(Tt,{__name:"BibleCompareModal"}),Ot={class:"space-y-6"},Vt={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-2"},Ut={class:"flex flex-1 items-center gap-2"},Nt={class:"space-x-1"},Pt={class:"flex justify-center gap-2"},At=Z({__name:"BibleReader",props:{book:{},chapter:{},versesData:{},notes:{},bookmarks:{},versions:{},selectedVersion:{}},emits:["update:chapter","refreshBookmark","refreshNotes"],setup(e,{emit:g}){const o=e,v=m=>{p.value={book:{code:o.book.code,name:o.book.name},verseStart:m,chapter:o.chapter,version:o.selectedVersion.id},S.value=!0},p=V(null),b=m=>{p.value={book:{code:o.book.code,name:o.book.name},verseStart:m,chapter:o.chapter,version:o.selectedVersion.id},I.value=!0},S=V(!1),I=V(!1),d=g,c=N(()=>Array.from({length:o.versesData?.navigation.totalChapters||0},(m,f)=>f+1)),k=m=>o.notes.filter(f=>f.verse.verse===m)||[],L=m=>o.bookmarks.find(f=>f.verse.verse===m)||null,B=N(()=>o.versesData?.verses||[]),u=m=>{d("update:chapter",m)};return(m,f)=>{const s=xe,h=X,a=ht,C=le,x=zt;return i(),P("div",Ot,[l(C,{class:"mb-4"},{header:n(()=>[y("div",Vt,[y("div",Ut,[f[5]||(f[5]=y("p",null,"Chapitre",-1)),l(s,{items:c.value,"model-value":e.chapter,placeholder:"Chapitre",class:"w-32","onUpdate:modelValue":u},null,8,["items","model-value"])]),l(h,{color:"secondary",variant:"ghost",to:"/bible/compare","trailing-icon":"i-lucide-chevron-right"},{default:n(()=>[...f[6]||(f[6]=[E(" Comparer ",-1)])]),_:1})])]),footer:n(()=>[y("div",Pt,[e.versesData?.navigation.previousChapter?(i(),$(h,{key:0,icon:"i-lucide-arrow-left",color:"primary",variant:"soft",onClick:f[2]||(f[2]=w=>u(e.versesData.navigation.previousChapter))},{default:n(()=>[...f[7]||(f[7]=[E(" Précédent ",-1)])]),_:1})):_("",!0),e.versesData?.navigation.nextChapter?(i(),$(h,{key:1,"trailing-icon":"i-lucide-arrow-right",color:"primary",variant:"soft",onClick:f[3]||(f[3]=w=>u(e.versesData.navigation.nextChapter))},{default:n(()=>[...f[8]||(f[8]=[E(" Suivant ",-1)])]),_:1})):_("",!0)])]),default:n(()=>[y("div",Nt,[(i(!0),P(F,null,J(B.value,w=>(i(),$(a,{key:w.id,book:e.book,verse:w,notes:k(w.verse),bookmark:L(w.verse),onShowCompare:v,onAddNote:b,onRefreshBookmark:f[0]||(f[0]=K=>d("refreshBookmark")),onRefreshNote:f[1]||(f[1]=K=>d("refreshNotes"))},null,8,["book","verse","notes","bookmark"]))),128))])]),_:1}),t(p)?(i(),$(x,D({key:0,modelValue:t(S),"onUpdate:modelValue":f[4]||(f[4]=w=>H(S)?S.value=w:null)},t(p),{"available-versions":e.versions}),null,16,["modelValue","available-versions"])):_("",!0)])}}}),_t=Object.assign(At,{__name:"BibleReader"}),ta=Z({__name:"index",async setup(e){let g,o;const v=he(),{data:p}=([g,o]=ae(()=>oe("bible-books",()=>$fetch("/api/bible/books"),{transform:r=>r?.data||[]})),g=await g,o(),g),{data:b}=([g,o]=ae(()=>oe("bible-versions",()=>$fetch("/api/bible/versions"),{transform:r=>r?.data||[]})),g=await g,o(),g),{data:S}=([g,o]=ae(()=>oe("bible-verses",()=>$fetch(`/api/bible/verses/${v.query.book||"GEN"}/${v.query.chapter||"1"}`,{query:{version:v.query.version||"LSG"}}),{watch:[()=>v.query],transform:r=>r?.data||[]})),g=await g,o(),g),{loggedIn:I}=ye(),d=Qe(),c=N({get:()=>v.query.book||"GEN",set:r=>{d.push({query:{...v.query,book:r}})}}),k=N({get:()=>parseInt(v.query.chapter||"1"),set:r=>{d.push({query:{...v.query,chapter:r}})}}),L=N({get:()=>v.query.version||"LSG",set:r=>{d.push({query:{...v.query,version:r}})}}),B=N(()=>p.value?.all||[]),u=V(null),m=V([]),f=V([]),s=V([]),h=N(()=>{const r=p.value?.grouped||{old:[],new:[]},O=r.old,U=r.new;return[{label:"Ancien Testament",open:O.some(q=>q.code===c.value),active:O.some(q=>q.code===c.value),ui:{link:"cursor-pointer"},children:O.map(q=>({label:q.name,onSelect:async()=>await w(q.code),active:c.value===q.code,ui:{link:"cursor-pointer"}}))},{label:"Nouveau Testament",open:U.some(q=>q.code===c.value),active:U.some(q=>q.code===c.value),ui:{link:"cursor-pointer"},children:U.map(q=>({label:q.name,onSelect:async()=>await w(q.code),active:c.value===q.code,ui:{link:"cursor-pointer"}}))}]}),a=N(()=>b.value?b.value.map(r=>({label:r.name,to:d.resolve({query:{...v.query,version:r.code}}).href,active:L.value===r.code})):[]),C=N(()=>!B.value||!c.value?null:B.value.find(r=>r.code==c.value)),x=N(()=>!b.value||!L.value?null:b.value.find(r=>r.code==L.value)),w=async r=>{await d.push({query:{...v.query,book:r,chapter:1}})},K=(r,O)=>{if(!m.value)return;const U=m.value.find(q=>q.bookCode===r);U?U.chaptersId.includes(O)||U.chaptersId.push(O):m.value.push({bookCode:r,chaptersId:[O]})},M=async r=>{await d.push({query:{...v.query,chapter:r}}),I&&c.value&&K(c.value,r)};We({title:"Lire la Bible en ligne - Théologie Pour Tous",ogTitle:"Lire la Bible en ligne - Théologie Pour Tous",description:"Lisez la Bible en ligne avec différentes versions disponibles. Parcourez les livres et chapitres de la Bible facilement.",ogDescription:"Lisez la Bible en ligne avec différentes versions disponibles. Parcourez les livres et chapitres de la Bible facilement."});const ee=async()=>{if(!(!I||!x.value||!b.value))try{const r=b.value.find(U=>U.code===L.value)?.id;if(!r)return;const O=await $fetch("/api/reading/sessions",{method:"POST",body:{action:"start",versionId:r,chaptersRead:JSON.stringify([{bookCode:c.value,chaptersId:k.value?[k.value]:[]}])}});if(O.success&&O.sessionId){const U=[{bookCode:c.value,chaptersId:k.value?[k.value]:[]}];u.value={id:O.sessionId,chaptersRead:U},m.value=U}}catch(r){console.error("Erreur lors du démarrage de la session:",r)}},te=async()=>{if(!(!I||!u.value))try{await $fetch("/api/reading/sessions",{method:"POST",body:{action:"end",sessionId:u.value.id,chaptersRead:JSON.stringify(m.value)}})}catch(r){console.error("Erreur lors de la fermeture de la session:",r)}};Ze(async()=>{I&&(await ee(),await Q(),await T())}),He(async()=>{I&&await te()});const Q=async()=>{if(!(!L.value||!c.value||!k.value))try{const r=await $fetch("/api/bible/notes",{method:"GET",query:{book:c.value,chapter:k.value}});f.value=r?.data.notes||[]}catch(r){console.error("Erreur lors du chargement des notes:",r)}},T=async()=>{if(!(!x.value||!c.value||!k.value))try{const r=await $fetch("/api/bible/bookmarks",{method:"GET",query:{book:c.value,chapter:k.value}});s.value=r?.data.bookmarks||[]}catch(r){console.error("Erreur lors du chargement des signets:",r)}};return ke([()=>v.query.chapter,()=>v.query.book],async()=>{await Q(),await T()}),it(),(r,O)=>{const U=Ye,q=tt,Ie=at,we=_t,$e=et,Ce=ot,Le=Xe;return i(),$(Le,null,Y({left:n(()=>[l(q,null,{top:n(()=>[...O[0]||(O[0]=[E(" Les livres ",-1)])]),default:n(()=>[t(B)?.length?(i(),$(U,{key:0,items:t(h),highlight:"",orientation:"vertical"},null,8,["items"])):_("",!0)]),_:1})]),default:n(()=>[t(C)&&t(k)?(i(),$(Ie,{key:0,title:`${t(C).name} ${t(k)}`,description:t(x)?.name||"Aucune version sélectionnée"},null,8,["title","description"])):_("",!0),l(Ce,null,{default:n(()=>[y("div",null,[t(C)&&t(k)&&t(x)&&t(S)?(i(),$(we,{key:0,book:t(C),chapter:t(k),"verses-data":t(S),versions:t(b)||[],"selected-version":t(x),notes:t(f),bookmarks:t(s),"onUpdate:chapter":M,onRefreshBookmark:T,onRefreshNotes:Q},null,8,["book","chapter","verses-data","versions","selected-version","notes","bookmarks"])):_("",!0)]),l($e)]),_:1})]),_:2},[t(b)?.length?{name:"right",fn:n(()=>[l(q,null,{top:n(()=>[...O[1]||(O[1]=[E(" Versions disponibles ",-1)])]),default:n(()=>[l(U,{items:t(a),variant:"link",orientation:"vertical"},null,8,["items"])]),_:1})]),key:"0"}:void 0]),1024)}}});export{ta as default};
