import{B as W,aa as Ee,ad as Re,ab as xe,V as N,a9 as _e,z as S,e as r,w as l,X as j,f as L,G as e,E as R,af as Fe,aw as we,a1 as re,ax as J,ay as se,an as Se,r as U,a6 as ue,g as d,L as Y,M as E,aq as qe,as as Ie,h as z,a4 as $e,Z as F,$ as de,ao as De,y as ce,az as Ke,aA as ze,aj as Ce,aB as Ge,ar as Be,at as He,aC as Je,d as O,n as C,N as Ve,aD as oe,t as M,F as G,H as Q,aE as We,aF as K,aG as Qe,Q as Z,a7 as Ze,aH as Xe,aI as Ye,aJ as ye,aK as ke,ak as Te,a0 as X,aL as et,aM as tt,W as ne,aN as Le,aO as Oe,aP as at,al as Ue,aQ as ot,o as Ne,am as st,ag as nt,aR as it,aS as lt,aT as rt,a5 as Pe,I as le,a8 as ut,aU as dt,v as ct,C as be,a as mt,D as gt,aV as pt,P as ft,aW as vt,R as bt}from"#entry";import{_ as ht}from"./DTIFCxQf.js";import{_ as yt,a as kt}from"./BiYaFSpO.js";import{u as xt,V as wt,_ as Ae}from"./ath3GSdt.js";import{_ as me}from"./sIOFFvLP.js";import{_ as St}from"./DdOBpqfI.js";import{_ as qt}from"./DZGhsTcR.js";import{_ as It}from"./DY4djKfE.js";import{u as he}from"./B7UDBhQ8.js";import{d as $t}from"./D8rO69WY.js";import"./j7pdL1SH.js";import"./BbRiUxvT.js";const[zt,Ct]=_e("SwitchRoot");var Bt=W({__name:"SwitchRoot",props:{defaultValue:{type:Boolean,required:!1},modelValue:{type:[Boolean,null],required:!1,default:void 0},disabled:{type:Boolean,required:!1},id:{type:String,required:!1},value:{type:String,required:!1,default:"on"},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"},name:{type:String,required:!1},required:{type:Boolean,required:!1}},emits:["update:modelValue"],setup(t,{emit:y}){const a=t,o=y,{disabled:c}=Ee(a),s=Re(a,"modelValue",o,{defaultValue:a.defaultValue,passive:a.modelValue===void 0});function w(){c.value||(s.value=!s.value)}const{forwardRef:f,currentElement:v}=xe(),p=xt(v),k=N(()=>a.id&&v.value?document.querySelector(`[for="${a.id}"]`)?.innerText:void 0);return Ct({modelValue:s,toggleCheck:w,disabled:c}),(b,I)=>(r(),S(e(re),R(b.$attrs,{id:b.id,ref:e(f),role:"switch",type:b.as==="button"?"button":void 0,value:b.value,"aria-label":b.$attrs["aria-label"]||k.value,"aria-checked":e(s),"aria-required":b.required,"data-state":e(s)?"checked":"unchecked","data-disabled":e(c)?"":void 0,"as-child":b.asChild,as:b.as,disabled:e(c),onClick:w,onKeydown:Fe(we(w,["prevent"]),["enter"])}),{default:l(()=>[j(b.$slots,"default",{modelValue:e(s)}),e(p)&&b.name?(r(),S(e(wt),{key:0,type:"checkbox",name:b.name,disabled:e(c),required:b.required,value:b.value,checked:!!e(s)},null,8,["name","disabled","required","value","checked"])):L("v-if",!0)]),_:3},16,["id","type","value","aria-label","aria-checked","aria-required","data-state","data-disabled","as-child","as","disabled","onKeydown"]))}}),Vt=Bt,Tt=W({__name:"SwitchThumb",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(t){const y=zt();return xe(),(a,o)=>(r(),S(e(re),{"data-state":e(y).modelValue?.value?"checked":"unchecked","data-disabled":e(y).disabled.value?"":void 0,"as-child":a.asChild,as:a.as},{default:l(()=>[j(a.$slots,"default")]),_:3},8,["data-state","data-disabled","as-child","as"]))}}),Lt=Tt;const Ot={class:"flex items-center gap-2"},Ut={class:"mt-2 flex items-center gap-1"},Nt=W({__name:"BookmarkFormPopover",props:J({verseId:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:J(["closeForm","created"],["update:modelValue"]),setup(t,{emit:y}){const a=t,o=y,c=se(t,"modelValue"),s=Se({title:"",color:"blue"}),w=[{label:"Rouge",value:"red"},{label:"Rose",value:"pink"},{label:"Fuchsia",value:"fuchsia"},{label:"Violet",value:"purple"},{label:"Violet clair",value:"violet"},{label:"Indigo",value:"indigo"},{label:"Bleu",value:"blue"},{label:"Ciel",value:"sky"},{label:"Cyan",value:"cyan"},{label:"Teal",value:"teal"},{label:"Émeraude",value:"emerald"},{label:"Vert",value:"green"},{label:"Lime",value:"lime"},{label:"Jaune",value:"yellow"},{label:"Ambre",value:"amber"},{label:"Orange",value:"orange"},{label:"Brun",value:"brown"},{label:"Gris",value:"gray"},{label:"Gris neutre",value:"neutral"},{label:"Ardoise",value:"slate"},{label:"Pierre",value:"stone"},{label:"Zinc",value:"zinc"},{label:"Noir",value:"black"}],f=U(!1),v=U(""),p=ue();function k(){c.value=!1,o("closeForm")}async function b(){v.value="",f.value=!0;try{const I=await $fetch("/api/bible/bookmarks",{method:"POST",body:{verseId:a.verseId,title:s.title,color:s.color}});I.success?(p.add({title:"Favori ajouté",description:I.message,color:"primary"}),o("created",I.data),k()):v.value=I.message||"Erreur inconnue"}catch(I){v.value=I?.statusMessage||"Erreur lors de l’ajout du favori"}finally{f.value=!1}}return(I,g)=>{const n=F,u=Ie,i=qe,$=Ae,m=Y,q=me,T=St;return r(),S(T,{state:e(s),onSubmit:we(b,["prevent"])},{default:l(()=>[d(q,{ui:{header:"p-2 sm:px-4",footer:"p-2 sm:px-4"}},{header:l(()=>[z("div",Ot,[d(n,{name:"i-lucide-bookmark",class:"text-primary-600"}),g[2]||(g[2]=z("span",{class:"font-semibold text-sm"},"Ajouter aux favoris",-1))])]),default:l(()=>[d(i,{label:"Titre (optionnel)",name:"title",class:"mb-4"},{default:l(()=>[d(u,{modelValue:e(s).title,"onUpdate:modelValue":g[0]||(g[0]=B=>e(s).title=B),placeholder:"Titre personnalisé...",class:"w-full"},null,8,["modelValue"])]),_:1}),d(i,{label:"Couleur du favori",name:"color"},{default:l(()=>[d($,{modelValue:e(s).color,"onUpdate:modelValue":g[1]||(g[1]=B=>e(s).color=B),items:w,"label-key":"label","value-key":"value",class:"flex gap-2 w-full"},null,8,["modelValue"]),z("div",Ut,[g[3]||(g[3]=E(" Aperçu : ",-1)),z("span",{style:$e([`background-color: var(--color-${e(s).color}-400)`,`border: solid 1px var(--color-${e(s).color}-700)`]),class:"inline-block size-4 rounded-full border"},null,4)])]),_:1})]),footer:l(()=>[d(m,{type:"submit",color:"primary",loading:e(f),class:"w-full flex justify-center"},{default:l(()=>[...g[4]||(g[4]=[E(" Ajouter ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["state"])}}}),Pt=Object.assign(Nt,{__name:"BookmarkFormPopover"}),je={__name:"UContextMenuContent",props:{items:{type:null,required:!1},portal:{type:[Boolean,String],required:!1,skipCheck:!0},sub:{type:Boolean,required:!1},labelKey:{type:null,required:!0},checkedIcon:{type:[String,Object],required:!1},loadingIcon:{type:[String,Object],required:!1},externalIcon:{type:[Boolean,String,Object],required:!1},class:{type:null,required:!1},ui:{type:null,required:!0},uiOverride:{type:null,required:!1},loop:{type:Boolean,required:!1},sideFlip:{type:Boolean,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","closeAutoFocus"],setup(t,{emit:y}){const a=t,o=y,c=de(),{dir:s}=De(),w=ce(),f=Ke(ze(()=>a.portal)),v=Ce(Ge(a,"sub","items","portal","labelKey","checkedIcon","loadingIcon","externalIcon","class","ui","uiOverride"),o),p=Be(c,["default"]),[k,b]=He(),I=N(()=>s.value==="rtl"?w.ui.icons.chevronLeft:w.ui.icons.chevronRight),g=N(()=>a.items?.length?Je(a.items)?a.items:[a.items]:[]);return(n,u)=>(r(),O(G,null,[d(e(k),null,{default:l(({item:i,active:$,index:m})=>[j(n.$slots,i.slot||"item",{item:i,index:m},()=>[j(n.$slots,i.slot?`${i.slot}-leading`:"item-leading",{item:i,active:$,index:m},()=>[i.loading?(r(),S(F,{key:0,name:t.loadingIcon||e(w).ui.icons.loading,class:C(t.ui.itemLeadingIcon({class:[t.uiOverride?.itemLeadingIcon,i.ui?.itemLeadingIcon],color:i?.color,loading:!0}))},null,8,["name","class"])):i.icon?(r(),S(F,{key:1,name:i.icon,class:C(t.ui.itemLeadingIcon({class:[t.uiOverride?.itemLeadingIcon,i.ui?.itemLeadingIcon],color:i?.color,active:$}))},null,8,["name","class"])):i.avatar?(r(),S(Ve,R({key:2,size:i.ui?.itemLeadingAvatarSize||t.uiOverride?.itemLeadingAvatarSize||t.ui.itemLeadingAvatarSize()},i.avatar,{class:t.ui.itemLeadingAvatar({class:[t.uiOverride?.itemLeadingAvatar,i.ui?.itemLeadingAvatar],active:$})}),null,16,["size","class"])):L("",!0)]),e(oe)(i,a.labelKey)||c[i.slot?`${i.slot}-label`:"item-label"]?(r(),O("span",{key:0,class:C(t.ui.itemLabel({class:[t.uiOverride?.itemLabel,i.ui?.itemLabel],active:$}))},[j(n.$slots,i.slot?`${i.slot}-label`:"item-label",{item:i,active:$,index:m},()=>[E(M(e(oe)(i,a.labelKey)),1)]),i.target==="_blank"&&t.externalIcon!==!1?(r(),S(F,{key:0,name:typeof t.externalIcon=="string"?t.externalIcon:e(w).ui.icons.external,class:C(t.ui.itemLabelExternalIcon({class:[t.uiOverride?.itemLabelExternalIcon,i.ui?.itemLabelExternalIcon],color:i?.color,active:$}))},null,8,["name","class"])):L("",!0)],2)):L("",!0),z("span",{class:C(t.ui.itemTrailing({class:[t.uiOverride?.itemTrailing,i.ui?.itemTrailing]}))},[j(n.$slots,i.slot?`${i.slot}-trailing`:"item-trailing",{item:i,active:$,index:m},()=>[i.children?.length?(r(),S(F,{key:0,name:I.value,class:C(t.ui.itemTrailingIcon({class:[t.uiOverride?.itemTrailingIcon,i.ui?.itemTrailingIcon],color:i?.color,active:$}))},null,8,["name","class"])):i.kbds?.length?(r(),O("span",{key:1,class:C(t.ui.itemTrailingKbds({class:[t.uiOverride?.itemTrailingKbds,i.ui?.itemTrailingKbds]}))},[(r(!0),O(G,null,Q(i.kbds,(q,T)=>(r(),S(We,R({key:T,size:i.ui?.itemTrailingKbdsSize||t.uiOverride?.itemTrailingKbdsSize||t.ui.itemTrailingKbdsSize()},{ref_for:!0},typeof q=="string"?{value:q}:q),null,16,["size"]))),128))],2)):L("",!0)]),d(e(K).ItemIndicator,{"as-child":""},{default:l(()=>[d(F,{name:t.checkedIcon||e(w).ui.icons.check,class:C(t.ui.itemTrailingIcon({class:[t.uiOverride?.itemTrailingIcon,i.ui?.itemTrailingIcon],color:i?.color}))},null,8,["name","class"])]),_:2},1024)],2)])]),_:3}),d(e(K).Portal,ye(ke(e(f))),{default:l(()=>[(r(),S(Qe(t.sub?e(K).SubContent:e(K).Content),R({class:a.class},e(v)),{default:l(()=>[j(n.$slots,"content-top"),z("div",{role:"presentation",class:C(t.ui.viewport({class:t.uiOverride?.viewport}))},[(r(!0),O(G,null,Q(g.value,(i,$)=>(r(),S(e(K).Group,{key:`group-${$}`,class:C(t.ui.group({class:t.uiOverride?.group}))},{default:l(()=>[(r(!0),O(G,null,Q(i,(m,q)=>(r(),O(G,{key:`group-${$}-${q}`},[m.type==="label"?(r(),S(e(K).Label,{key:0,class:C(t.ui.label({class:[t.uiOverride?.label,m.ui?.label,m.class]}))},{default:l(()=>[d(e(b),{item:m,index:q},null,8,["item","index"])]),_:2},1032,["class"])):m.type==="separator"?(r(),S(e(K).Separator,{key:1,class:C(t.ui.separator({class:[t.uiOverride?.separator,m.ui?.separator,m.class]}))},null,8,["class"])):m?.children?.length?(r(),S(e(K).Sub,{key:2,open:m.open,"default-open":m.defaultOpen},{default:l(()=>[d(e(K).SubTrigger,{as:"button",type:"button",disabled:m.disabled,"text-value":e(oe)(m,a.labelKey),class:C(t.ui.item({class:[t.uiOverride?.item,m.ui?.item,m.class],color:m?.color}))},{default:l(()=>[d(e(b),{item:m,index:q},null,8,["item","index"])]),_:2},1032,["disabled","text-value","class"]),d(je,R({sub:"",class:a.class,ui:t.ui,"ui-override":t.uiOverride,portal:t.portal,items:m.children,"align-offset":-4,"label-key":t.labelKey,"checked-icon":t.checkedIcon,"loading-icon":t.loadingIcon,"external-icon":t.externalIcon},{ref_for:!0},m.content),Z({_:2},[Q(e(p),(T,B)=>({name:B,fn:l(H=>[j(n.$slots,B,R({ref_for:!0},H))])}))]),1040,["class","ui","ui-override","portal","items","label-key","checked-icon","loading-icon","external-icon"])]),_:2},1032,["open","default-open"])):m.type==="checkbox"?(r(),S(e(K).CheckboxItem,{key:3,"model-value":m.checked,disabled:m.disabled,"text-value":e(oe)(m,a.labelKey),class:C(t.ui.item({class:[t.uiOverride?.item,m.ui?.item,m.class],color:m?.color})),"onUpdate:modelValue":m.onUpdateChecked,onSelect:m.onSelect},{default:l(()=>[d(e(b),{item:m,index:q},null,8,["item","index"])]),_:2},1032,["model-value","disabled","text-value","class","onUpdate:modelValue","onSelect"])):(r(),S(e(K).Item,{key:4,"as-child":"",disabled:m.disabled,"text-value":e(oe)(m,a.labelKey),onSelect:m.onSelect},{default:l(()=>[d(Ze,R({ref_for:!0},e(Xe)(m),{custom:""}),{default:l(({active:T,...B})=>[d(Ye,R({ref_for:!0},B,{class:t.ui.item({class:[t.uiOverride?.item,m.ui?.item,m.class],active:T,color:m?.color})}),{default:l(()=>[d(e(b),{item:m,active:T,index:q},null,8,["item","active","index"])]),_:2},1040,["class"])]),_:2},1040)]),_:2},1032,["disabled","text-value","onSelect"]))],64))),128))]),_:2},1032,["class"]))),128))],2),j(n.$slots,"default"),j(n.$slots,"content-bottom")]),_:3},16,["class"]))]),_:3},16)],64))}},At={slots:{content:"min-w-32 bg-default shadow-lg rounded-md ring ring-default overflow-hidden data-[state=open]:animate-[scale-in_100ms_ease-out] data-[state=closed]:animate-[scale-out_100ms_ease-in] origin-(--reka-context-menu-content-transform-origin) flex flex-col",viewport:"relative divide-y divide-default scroll-py-1 overflow-y-auto flex-1",group:"p-1 isolate",label:"w-full flex items-center font-semibold text-highlighted",separator:"-mx-1 my-1 h-px bg-border",item:"group relative w-full flex items-center select-none outline-none before:absolute before:z-[-1] before:inset-px before:rounded-md data-disabled:cursor-not-allowed data-disabled:opacity-75",itemLeadingIcon:"shrink-0",itemLeadingAvatar:"shrink-0",itemLeadingAvatarSize:"",itemTrailing:"ms-auto inline-flex gap-1.5 items-center",itemTrailingIcon:"shrink-0",itemTrailingKbds:"hidden lg:inline-flex items-center shrink-0",itemTrailingKbdsSize:"",itemLabel:"truncate",itemLabelExternalIcon:"inline-block size-3 align-top text-dimmed"},variants:{color:{primary:"",secondary:"",success:"",info:"",warning:"",error:"",neutral:""},active:{true:{item:"text-highlighted before:bg-elevated",itemLeadingIcon:"text-default"},false:{item:["text-default data-highlighted:text-highlighted data-[state=open]:text-highlighted data-highlighted:before:bg-elevated/50 data-[state=open]:before:bg-elevated/50","transition-colors before:transition-colors"],itemLeadingIcon:["text-dimmed group-data-highlighted:text-default group-data-[state=open]:text-default","transition-colors"]}},loading:{true:{itemLeadingIcon:"animate-spin"}},size:{xs:{label:"p-1 text-xs gap-1",item:"p-1 text-xs gap-1",itemLeadingIcon:"size-4",itemLeadingAvatarSize:"3xs",itemTrailingIcon:"size-4",itemTrailingKbds:"gap-0.5",itemTrailingKbdsSize:"sm"},sm:{label:"p-1.5 text-xs gap-1.5",item:"p-1.5 text-xs gap-1.5",itemLeadingIcon:"size-4",itemLeadingAvatarSize:"3xs",itemTrailingIcon:"size-4",itemTrailingKbds:"gap-0.5",itemTrailingKbdsSize:"sm"},md:{label:"p-1.5 text-sm gap-1.5",item:"p-1.5 text-sm gap-1.5",itemLeadingIcon:"size-5",itemLeadingAvatarSize:"2xs",itemTrailingIcon:"size-5",itemTrailingKbds:"gap-0.5",itemTrailingKbdsSize:"md"},lg:{label:"p-2 text-sm gap-2",item:"p-2 text-sm gap-2",itemLeadingIcon:"size-5",itemLeadingAvatarSize:"2xs",itemTrailingIcon:"size-5",itemTrailingKbds:"gap-1",itemTrailingKbdsSize:"md"},xl:{label:"p-2 text-base gap-2",item:"p-2 text-base gap-2",itemLeadingIcon:"size-6",itemLeadingAvatarSize:"xs",itemTrailingIcon:"size-6",itemTrailingKbds:"gap-1",itemTrailingKbdsSize:"lg"}}},compoundVariants:[{color:"primary",active:!1,class:{item:"text-primary data-highlighted:text-primary data-highlighted:before:bg-primary/10 data-[state=open]:before:bg-primary/10",itemLeadingIcon:"text-primary/75 group-data-highlighted:text-primary group-data-[state=open]:text-primary"}},{color:"secondary",active:!1,class:{item:"text-secondary data-highlighted:text-secondary data-highlighted:before:bg-secondary/10 data-[state=open]:before:bg-secondary/10",itemLeadingIcon:"text-secondary/75 group-data-highlighted:text-secondary group-data-[state=open]:text-secondary"}},{color:"success",active:!1,class:{item:"text-success data-highlighted:text-success data-highlighted:before:bg-success/10 data-[state=open]:before:bg-success/10",itemLeadingIcon:"text-success/75 group-data-highlighted:text-success group-data-[state=open]:text-success"}},{color:"info",active:!1,class:{item:"text-info data-highlighted:text-info data-highlighted:before:bg-info/10 data-[state=open]:before:bg-info/10",itemLeadingIcon:"text-info/75 group-data-highlighted:text-info group-data-[state=open]:text-info"}},{color:"warning",active:!1,class:{item:"text-warning data-highlighted:text-warning data-highlighted:before:bg-warning/10 data-[state=open]:before:bg-warning/10",itemLeadingIcon:"text-warning/75 group-data-highlighted:text-warning group-data-[state=open]:text-warning"}},{color:"error",active:!1,class:{item:"text-error data-highlighted:text-error data-highlighted:before:bg-error/10 data-[state=open]:before:bg-error/10",itemLeadingIcon:"text-error/75 group-data-highlighted:text-error group-data-[state=open]:text-error"}},{color:"primary",active:!0,class:{item:"text-primary before:bg-primary/10",itemLeadingIcon:"text-primary"}},{color:"secondary",active:!0,class:{item:"text-secondary before:bg-secondary/10",itemLeadingIcon:"text-secondary"}},{color:"success",active:!0,class:{item:"text-success before:bg-success/10",itemLeadingIcon:"text-success"}},{color:"info",active:!0,class:{item:"text-info before:bg-info/10",itemLeadingIcon:"text-info"}},{color:"warning",active:!0,class:{item:"text-warning before:bg-warning/10",itemLeadingIcon:"text-warning"}},{color:"error",active:!0,class:{item:"text-error before:bg-error/10",itemLeadingIcon:"text-error"}}],defaultVariants:{size:"md"}},jt={__name:"UContextMenu",props:{size:{type:null,required:!1},items:{type:null,required:!1},checkedIcon:{type:[String,Object],required:!1},loadingIcon:{type:[String,Object],required:!1},externalIcon:{type:[Boolean,String,Object],required:!1,default:!0},content:{type:Object,required:!1},portal:{type:[Boolean,String],required:!1,skipCheck:!0,default:!0},labelKey:{type:null,required:!1,default:"label"},disabled:{type:Boolean,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1},pressOpenDelay:{type:Number,required:!1},modal:{type:Boolean,required:!1,default:!0}},emits:["update:open"],setup(t,{emit:y}){const a=t,o=y,c=de(),s=ce(),w=Ce(Te(a,"modal"),o),f=ze(()=>a.content),v=Be(c,["default"]),p=N(()=>X({extend:X(At),...s.ui?.contextMenu||{}})({size:a.size}));return(k,b)=>(r(),S(e(tt),ye(ke(e(w))),{default:l(()=>[c.default?(r(),S(e(et),{key:0,"as-child":"",disabled:t.disabled,class:C(a.class)},{default:l(()=>[j(k.$slots,"default")]),_:3},8,["disabled","class"])):L("",!0),d(je,R({class:p.value.content({class:[!c.default&&a.class,a.ui?.content]}),ui:p.value,"ui-override":a.ui},f.value,{items:t.items,portal:t.portal,"label-key":t.labelKey,"checked-icon":t.checkedIcon,"loading-icon":t.loadingIcon,"external-icon":t.externalIcon}),Z({_:2},[Q(e(v),(I,g)=>({name:g,fn:l(n=>[j(k.$slots,g,ye(ke(n)))])}))]),1040,["class","ui","ui-override","items","portal","label-key","checked-icon","loading-icon","external-icon"])]),_:3},16))}},Mt=["innerHTML"],Et={key:1,class:"space-y-4"},Rt={class:"flex justify-between gap-4 items-center"},_t={class:"flex gap-2 items-center"},Ft={class:"line-clamp-1"},Dt={class:"flex flex-1 justify-end gap-2 items-center"},Kt=W({__name:"NoteShowDrawer",props:J({notes:{},verse:{},book:{}},{open:{type:Boolean,default:!1},openModifiers:{}}),emits:J(["edit:note","refreshNote"],["update:open"]),setup(t,{emit:y}){const a=y,o=ue(),c=se(t,"open"),s=U(null),w=N(()=>t.notes.find(p=>p.id===s.value)||null);ne(c,p=>{p?t.notes.length==1&&t.notes[0]?.id&&(s.value=t.notes[0]?.id):s.value=null});const f=N(()=>`${t.book.name} ${t.verse.chapter}:${t.verse.verse}`),v=async p=>{try{await $fetch(`/api/bible/notes/${p.id}`,{method:"DELETE"}),o.add({title:"Suppression succès",description:"La note a bien été supprimée"}),a("refreshNote"),t.notes.length==1&&(c.value=!1)}catch(k){console.error(k),o.add({color:"error",title:"Erreur",description:"Erreur lors de la suppression"})}};return(p,k)=>{const b=Y,I=qt,g=Le,n=me,u=Oe;return r(),S(u,{open:c.value,"onUpdate:open":k[3]||(k[3]=i=>c.value=i),title:e(w)?.title||"Liste des notes",description:e(f),ui:{footer:"justify-end"}},Z({body:l(()=>[e(w)?(r(),O("p",{key:0,class:"whitespace-pre-wrap",innerHTML:e(w).content},null,8,Mt)):(r(),O("div",Et,[(r(!0),O(G,null,Q(p.notes,i=>(r(),S(n,{key:i.id,variant:"outline",ui:{body:"p-2 sm:py-2 sm:px-4"}},{default:l(()=>[z("div",Rt,[z("div",_t,[d(b,{icon:"i-lucide-arrow-left",size:"md",color:"primary",variant:"link",onClick:$=>s.value=i.id},null,8,["onClick"]),z("h4",Ft,M(i.title),1)]),d(g,{arrow:""},{content:l(()=>[d(I,{title:"Suppression de la note",description:"Êtes-vous sûr de vouloir supprimer cette note ? Cette action est irréversible.",icon:"i-lucide-trash-2",ui:{root:"max-w-sm",leadingIcon:"text-red-500"}},{default:l(()=>[d(b,{label:"Supprimer",color:"error",variant:"subtle",ui:{base:"justify-center"},onClick:$=>v(i)},null,8,["onClick"])]),_:2},1024)]),default:l(()=>[d(b,{icon:"i-lucide-trash-2",size:"md",color:"error",variant:"ghost"})]),_:2},1024)])]),_:2},1024))),128))]))]),_:2},[e(w)?{name:"footer",fn:l(()=>[p.notes.length>1?(r(),S(b,{key:0,icon:"i-lucide-arrow-left",size:"md",color:"primary",variant:"link",onClick:k[0]||(k[0]=i=>s.value=null)})):L("",!0),z("div",Dt,[d(b,{label:"Modifier",color:"secondary",onClick:k[1]||(k[1]=i=>a("edit:note",e(w)))}),d(g,{arrow:""},{content:l(()=>[d(I,{title:"Suppression de la note",description:"Êtes-vous sûr de vouloir supprimer cette note ? Cette action est irréversible.",icon:"i-lucide-trash-2",ui:{root:"max-w-sm",leadingIcon:"text-red-500"}},{default:l(()=>[d(b,{label:"Supprimer",color:"error",variant:"subtle",ui:{base:"justify-center"},onClick:k[2]||(k[2]=i=>v(e(w)))})]),_:1})]),default:l(()=>[d(b,{label:"Supprimer",color:"error",variant:"outline"})]),_:1})])]),key:"0"}:void 0]),1032,["open","title","description"])}}}),Gt=Object.assign(Kt,{__name:"NoteShowDrawer"}),Ht={slots:{root:"relative inline-flex items-center",base:["w-full rounded-md border-0 appearance-none placeholder:text-dimmed focus:outline-none disabled:cursor-not-allowed disabled:opacity-75","transition-colors"],leading:"absolute start-0 flex items-start",leadingIcon:"shrink-0 text-dimmed",leadingAvatar:"shrink-0",leadingAvatarSize:"",trailing:"absolute end-0 flex items-start",trailingIcon:"shrink-0 text-dimmed"},variants:{fieldGroup:{horizontal:{root:"group has-focus-visible:z-[1]",base:"group-not-only:group-first:rounded-e-none group-not-only:group-last:rounded-s-none group-not-last:group-not-first:rounded-none"},vertical:{root:"group has-focus-visible:z-[1]",base:"group-not-only:group-first:rounded-b-none group-not-only:group-last:rounded-t-none group-not-last:group-not-first:rounded-none"}},size:{xs:{base:"px-2 py-1 text-xs gap-1",leading:"ps-2 inset-y-1",trailing:"pe-2 inset-y-1",leadingIcon:"size-4",leadingAvatarSize:"3xs",trailingIcon:"size-4"},sm:{base:"px-2.5 py-1.5 text-xs gap-1.5",leading:"ps-2.5 inset-y-1.5",trailing:"pe-2.5 inset-y-1.5",leadingIcon:"size-4",leadingAvatarSize:"3xs",trailingIcon:"size-4"},md:{base:"px-2.5 py-1.5 text-sm gap-1.5",leading:"ps-2.5 inset-y-1.5",trailing:"pe-2.5 inset-y-1.5",leadingIcon:"size-5",leadingAvatarSize:"2xs",trailingIcon:"size-5"},lg:{base:"px-3 py-2 text-sm gap-2",leading:"ps-3 inset-y-2",trailing:"pe-3 inset-y-2",leadingIcon:"size-5",leadingAvatarSize:"2xs",trailingIcon:"size-5"},xl:{base:"px-3 py-2 text-base gap-2",leading:"ps-3 inset-y-2",trailing:"pe-3 inset-y-2",leadingIcon:"size-6",leadingAvatarSize:"xs",trailingIcon:"size-6"}},variant:{outline:"text-highlighted bg-default ring ring-inset ring-accented",soft:"text-highlighted bg-elevated/50 hover:bg-elevated focus:bg-elevated disabled:bg-elevated/50",subtle:"text-highlighted bg-elevated ring ring-inset ring-accented",ghost:"text-highlighted bg-transparent hover:bg-elevated focus:bg-elevated disabled:bg-transparent dark:disabled:bg-transparent",none:"text-highlighted bg-transparent"},color:{primary:"",secondary:"",success:"",info:"",warning:"",error:"",neutral:""},leading:{true:""},trailing:{true:""},loading:{true:""},highlight:{true:""},type:{file:"file:me-1.5 file:font-medium file:text-muted file:outline-none"},autoresize:{true:{base:"resize-none"}}},compoundVariants:[{color:"primary",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-primary"},{color:"secondary",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-secondary"},{color:"success",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-success"},{color:"info",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-info"},{color:"warning",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-warning"},{color:"error",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-error"},{color:"primary",highlight:!0,class:"ring ring-inset ring-primary"},{color:"secondary",highlight:!0,class:"ring ring-inset ring-secondary"},{color:"success",highlight:!0,class:"ring ring-inset ring-success"},{color:"info",highlight:!0,class:"ring ring-inset ring-info"},{color:"warning",highlight:!0,class:"ring ring-inset ring-warning"},{color:"error",highlight:!0,class:"ring ring-inset ring-error"},{color:"neutral",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-inverted"},{color:"neutral",highlight:!0,class:"ring ring-inset ring-inverted"},{leading:!0,size:"xs",class:"ps-7"},{leading:!0,size:"sm",class:"ps-8"},{leading:!0,size:"md",class:"ps-9"},{leading:!0,size:"lg",class:"ps-10"},{leading:!0,size:"xl",class:"ps-11"},{trailing:!0,size:"xs",class:"pe-7"},{trailing:!0,size:"sm",class:"pe-8"},{trailing:!0,size:"md",class:"pe-9"},{trailing:!0,size:"lg",class:"pe-10"},{trailing:!0,size:"xl",class:"pe-11"},{loading:!0,leading:!0,class:{leadingIcon:"animate-spin"}},{loading:!0,leading:!1,trailing:!0,class:{trailingIcon:"animate-spin"}}],defaultVariants:{size:"md",color:"primary",variant:"outline"}},Jt=["id","value","name","rows","placeholder","disabled","required"],Wt=Object.assign({inheritAttrs:!1},{__name:"UTextarea",props:{as:{type:null,required:!1},id:{type:String,required:!1},name:{type:String,required:!1},placeholder:{type:String,required:!1},color:{type:null,required:!1},variant:{type:null,required:!1},size:{type:null,required:!1},required:{type:Boolean,required:!1},autofocus:{type:Boolean,required:!1},autofocusDelay:{type:Number,required:!1,default:0},autoresize:{type:Boolean,required:!1},autoresizeDelay:{type:Number,required:!1,default:0},disabled:{type:Boolean,required:!1},rows:{type:Number,required:!1,default:3},maxrows:{type:Number,required:!1,default:0},highlight:{type:Boolean,required:!1},modelValue:{type:null,required:!1},defaultValue:{type:null,required:!1},modelModifiers:{type:Object,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1},icon:{type:[String,Object],required:!1},avatar:{type:Object,required:!1},leading:{type:Boolean,required:!1},leadingIcon:{type:[String,Object],required:!1},trailing:{type:Boolean,required:!1},trailingIcon:{type:[String,Object],required:!1},loading:{type:Boolean,required:!1},loadingIcon:{type:[String,Object],required:!1}},emits:["update:modelValue","blur","change"],setup(t,{expose:y,emit:a}){const o=t,c=a,s=de(),w=at(o,"modelValue",c,{defaultValue:o.defaultValue}),f=ce(),{emitFormFocus:v,emitFormBlur:p,emitFormInput:k,emitFormChange:b,size:I,color:g,id:n,name:u,highlight:i,disabled:$,ariaAttrs:m}=Ue(o,{deferInputValidation:!0}),{isLeading:q,isTrailing:T,leadingIconName:B,trailingIconName:H}=ot(o),_=N(()=>X({extend:X(Ht),...f.ui?.textarea||{}})({color:g.value,variant:o.variant,size:I?.value,loading:o.loading,highlight:i.value,autoresize:o.autoresize,leading:q.value||!!o.avatar||!!s.leading,trailing:T.value||!!s.trailing})),V=U(null);function ie(x){o.modelModifiers?.trim&&(x=x?.trim()??null),o.modelModifiers?.number&&(x=st(x)),o.modelModifiers?.nullable&&(x||=null),o.modelModifiers?.optional&&(x||=void 0),w.value=x,k()}function ee(x){P(),o.modelModifiers?.lazy||ie(x.target.value)}function te(x){const D=x.target.value;o.modelModifiers?.lazy&&ie(D),o.modelModifiers?.trim&&(x.target.value=D.trim()),b(),c("change",x)}function h(x){p(),c("blur",x)}function A(){o.autofocus&&V.value?.focus()}function P(){if(o.autoresize&&V.value){V.value.rows=o.rows;const x=V.value.style.overflow;V.value.style.overflow="hidden";const D=window.getComputedStyle(V.value),ae=Number.parseInt(D.paddingTop),ge=Number.parseInt(D.paddingBottom),pe=ae+ge,fe=Number.parseInt(D.lineHeight),{scrollHeight:Me}=V.value,ve=(Me-pe)/fe;ve>o.rows&&(V.value.rows=o.maxrows?Math.min(ve,o.maxrows):ve),V.value.style.overflow=x}}return ne(w,()=>{nt(P)}),Ne(()=>{setTimeout(()=>{A()},o.autofocusDelay),setTimeout(()=>{P()},o.autoresizeDelay)}),y({textareaRef:V}),(x,D)=>(r(),S(e(re),{as:t.as,class:C(_.value.root({class:[o.ui?.root,o.class]}))},{default:l(()=>[z("textarea",R({id:e(n),ref_key:"textareaRef",ref:V,value:e(w),name:e(u),rows:t.rows,placeholder:t.placeholder,class:_.value.base({class:o.ui?.base}),disabled:e($),required:t.required},{...x.$attrs,...e(m)},{onInput:ee,onBlur:h,onChange:te,onFocus:D[0]||(D[0]=(...ae)=>e(v)&&e(v)(...ae))}),null,16,Jt),j(x.$slots,"default"),e(q)||t.avatar||s.leading?(r(),O("span",{key:0,class:C(_.value.leading({class:o.ui?.leading}))},[j(x.$slots,"leading",{},()=>[e(q)&&e(B)?(r(),S(F,{key:0,name:e(B),class:C(_.value.leadingIcon({class:o.ui?.leadingIcon}))},null,8,["name","class"])):t.avatar?(r(),S(Ve,R({key:1,size:o.ui?.leadingAvatarSize||_.value.leadingAvatarSize()},t.avatar,{class:_.value.leadingAvatar({class:o.ui?.leadingAvatar})}),null,16,["size","class"])):L("",!0)])],2)):L("",!0),e(T)||s.trailing?(r(),O("span",{key:1,class:C(_.value.trailing({class:o.ui?.trailing}))},[j(x.$slots,"trailing",{},()=>[e(H)?(r(),S(F,{key:0,name:e(H),class:C(_.value.trailingIcon({class:o.ui?.trailingIcon}))},null,8,["name","class"])):L("",!0)])],2)):L("",!0)]),_:3},8,["as","class"]))}}),Qt={slots:{root:"relative flex items-start",base:["inline-flex items-center shrink-0 rounded-full border-2 border-transparent focus-visible:outline-2 focus-visible:outline-offset-2 data-[state=unchecked]:bg-accented","transition-[background] duration-200"],container:"flex items-center",thumb:"group pointer-events-none rounded-full bg-default shadow-lg ring-0 transition-transform duration-200 data-[state=unchecked]:translate-x-0 data-[state=unchecked]:rtl:-translate-x-0 flex items-center justify-center",icon:["absolute shrink-0 group-data-[state=unchecked]:text-dimmed opacity-0 size-10/12","transition-[color,opacity] duration-200"],wrapper:"ms-2",label:"block font-medium text-default",description:"text-muted"},variants:{color:{primary:{base:"data-[state=checked]:bg-primary focus-visible:outline-primary",icon:"group-data-[state=checked]:text-primary"},secondary:{base:"data-[state=checked]:bg-secondary focus-visible:outline-secondary",icon:"group-data-[state=checked]:text-secondary"},success:{base:"data-[state=checked]:bg-success focus-visible:outline-success",icon:"group-data-[state=checked]:text-success"},info:{base:"data-[state=checked]:bg-info focus-visible:outline-info",icon:"group-data-[state=checked]:text-info"},warning:{base:"data-[state=checked]:bg-warning focus-visible:outline-warning",icon:"group-data-[state=checked]:text-warning"},error:{base:"data-[state=checked]:bg-error focus-visible:outline-error",icon:"group-data-[state=checked]:text-error"},neutral:{base:"data-[state=checked]:bg-inverted focus-visible:outline-inverted",icon:"group-data-[state=checked]:text-highlighted"}},size:{xs:{base:"w-7",container:"h-4",thumb:"size-3 data-[state=checked]:translate-x-3 data-[state=checked]:rtl:-translate-x-3",wrapper:"text-xs"},sm:{base:"w-8",container:"h-4",thumb:"size-3.5 data-[state=checked]:translate-x-3.5 data-[state=checked]:rtl:-translate-x-3.5",wrapper:"text-xs"},md:{base:"w-9",container:"h-5",thumb:"size-4 data-[state=checked]:translate-x-4 data-[state=checked]:rtl:-translate-x-4",wrapper:"text-sm"},lg:{base:"w-10",container:"h-5",thumb:"size-4.5 data-[state=checked]:translate-x-4.5 data-[state=checked]:rtl:-translate-x-4.5",wrapper:"text-sm"},xl:{base:"w-11",container:"h-6",thumb:"size-5 data-[state=checked]:translate-x-5 data-[state=checked]:rtl:-translate-x-5",wrapper:"text-base"}},checked:{true:{icon:"group-data-[state=checked]:opacity-100"}},unchecked:{true:{icon:"group-data-[state=unchecked]:opacity-100"}},loading:{true:{icon:"animate-spin"}},required:{true:{label:"after:content-['*'] after:ms-0.5 after:text-error"}},disabled:{true:{base:"cursor-not-allowed opacity-75",label:"cursor-not-allowed opacity-75",description:"cursor-not-allowed opacity-75"}}},defaultVariants:{color:"primary",size:"md"}},Zt=Object.assign({inheritAttrs:!1},{__name:"USwitch",props:J({as:{type:null,required:!1},color:{type:null,required:!1},size:{type:null,required:!1},loading:{type:Boolean,required:!1},loadingIcon:{type:[String,Object],required:!1},checkedIcon:{type:[String,Object],required:!1},uncheckedIcon:{type:[String,Object],required:!1},label:{type:String,required:!1},description:{type:String,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1},disabled:{type:Boolean,required:!1},id:{type:String,required:!1},name:{type:String,required:!1},required:{type:Boolean,required:!1},value:{type:String,required:!1},defaultValue:{type:Boolean,required:!1}},{modelValue:{type:Boolean,default:void 0},modelModifiers:{}}),emits:J(["change"],["update:modelValue"]),setup(t,{emit:y}){const a=t,o=de(),c=y,s=se(t,"modelValue",{type:Boolean,default:void 0}),w=ce(),f=it(Te(a,"required","value","defaultValue")),{id:v,emitFormChange:p,emitFormInput:k,size:b,color:I,name:g,disabled:n,ariaAttrs:u}=Ue(a),i=v.value??lt(),$=N(()=>X({extend:X(Qt),...w.ui?.switch||{}})({size:b.value,color:I.value,required:a.required,loading:a.loading,disabled:n.value||a.loading}));function m(q){const T=new Event("change",{target:{value:q}});c("change",T),p(),k()}return(q,T)=>(r(),S(e(re),{as:t.as,class:C($.value.root({class:[a.ui?.root,a.class]}))},{default:l(()=>[z("div",{class:C($.value.container({class:a.ui?.container}))},[d(e(Vt),R({id:e(i)},{...e(f),...q.$attrs,...e(u)},{modelValue:s.value,"onUpdate:modelValue":[T[0]||(T[0]=B=>s.value=B),m],name:e(g),disabled:e(n)||t.loading,class:$.value.base({class:a.ui?.base})}),{default:l(()=>[d(e(Lt),{class:C($.value.thumb({class:a.ui?.thumb}))},{default:l(()=>[t.loading?(r(),S(F,{key:0,name:t.loadingIcon||e(w).ui.icons.loading,class:C($.value.icon({class:a.ui?.icon,checked:!0,unchecked:!0}))},null,8,["name","class"])):(r(),O(G,{key:1},[t.checkedIcon?(r(),S(F,{key:0,name:t.checkedIcon,class:C($.value.icon({class:a.ui?.icon,checked:!0}))},null,8,["name","class"])):L("",!0),t.uncheckedIcon?(r(),S(F,{key:1,name:t.uncheckedIcon,class:C($.value.icon({class:a.ui?.icon,unchecked:!0}))},null,8,["name","class"])):L("",!0)],64))]),_:1},8,["class"])]),_:1},16,["id","modelValue","name","disabled","class"])],2),t.label||o.label||t.description||o.description?(r(),O("div",{key:0,class:C($.value.wrapper({class:a.ui?.wrapper}))},[t.label||o.label?(r(),S(e(rt),{key:0,for:e(i),class:C($.value.label({class:a.ui?.label}))},{default:l(()=>[j(q.$slots,"label",{label:t.label},()=>[E(M(t.label),1)])]),_:3},8,["for","class"])):L("",!0),t.description||o.description?(r(),O("p",{key:1,class:C($.value.description({class:a.ui?.description}))},[j(q.$slots,"description",{description:t.description},()=>[E(M(t.description),1)])],2)):L("",!0)],2)):L("",!0)]),_:3},8,["as","class"]))}}),Xt=W({__name:"NoteCreateDrawer",props:J({note:{default:null},verse:{},book:{}},{open:{type:Boolean,default:!1},openModifiers:{}}),emits:J(["close","refreshNote"],["update:open"]),setup(t,{emit:y}){const a=y,o=se(t,"open"),c=U(!1),s=Se({title:t.note?.title??"",content:t.note?.content??"",isPrivate:t.note?.isPrivate??!0}),w=U(!1),f=U(""),v=ue();function p(){o.value=!1,a("close"),s.content="",s.title=""}async function k(){f.value="",w.value=!0;try{let I=null;c.value&&t.note?I=await $fetch(`/api/bible/notes/${t.note.id}`,{method:"PUT",body:{title:s.title,content:s.content,isPrivate:s.isPrivate}}):I=await $fetch("/api/bible/notes",{method:"POST",body:{verseId:t.verse.id,title:s.title,content:s.content,isPrivate:s.isPrivate}}),I.success?(v.add({title:c.value?"Note modifiée":"Note ajoutée",description:I.message,color:"primary"}),a("refreshNote"),p()):f.value=I.message||"Erreur inconnue"}catch(I){f.value=I?.statusMessage||"Erreur lors de l’enregistrement de la note"}finally{w.value=!1}}const b=N(()=>`${t.book.name} ${t.verse.chapter}:${t.verse.verse}`);return ne(o,I=>{I?(s.title=t.note?.title??"",s.content=t.note?.content??"",s.isPrivate=t.note?.isPrivate??!0,c.value=!!t.note):(s.title="",s.content="",s.isPrivate=!0,c.value=!1)}),(I,g)=>{const n=Ie,u=Wt,i=Zt,$=Y,m=Oe;return r(),S(m,{open:o.value,"onUpdate:open":g[3]||(g[3]=q=>o.value=q),dismissible:!1,title:"Ajouter une note",description:e(b),ui:{footer:"justify-end",body:"flex flex-col justify-between gap-4"}},{body:l(()=>[d(n,{modelValue:e(s).title,"onUpdate:modelValue":g[0]||(g[0]=q=>e(s).title=q),placeholder:"Titre..."},null,8,["modelValue"]),d(u,{modelValue:e(s).content,"onUpdate:modelValue":g[1]||(g[1]=q=>e(s).content=q),placeholder:"Contenu...",class:"flex-1 h-full",ui:{base:"h-full"},autoresize:""},null,8,["modelValue"]),d(i,{modelValue:e(s).isPrivate,"onUpdate:modelValue":g[2]||(g[2]=q=>e(s).isPrivate=q),label:"Visible uniquement par moi"},null,8,["modelValue"])]),footer:l(({close:q})=>[d($,{label:"Annuler",color:"neutral",variant:"outline",onClick:q},null,8,["onClick"]),d($,{label:"Enregistrer",color:"neutral",onClick:k})]),_:1},8,["open","description"])}}}),Yt=Object.assign(Xt,{__name:"NoteCreateDrawer"}),ea={class:"inline-block align-top text-xs text-primary-600 dark:text-primary-400"},ta={class:"flex items-center justify-between gap-2"},aa=W({__name:"BibleVerse",props:{book:{},verse:{},notes:{},bookmark:{}},emits:["showCompare","addNote","refreshBookmark","refreshNote"],setup(t,{emit:y}){const a=t,o=y,c=U(!1),s=U(!1),w=ue(),f=U(!1),v=U(!1),{loggedIn:p}=Pe(),k=N(()=>{const n=[{label:"Comparer",icon:"i-lucide-eye",onSelect:()=>o("showCompare",a.verse.verse),ui:{item:"cursor-pointer"}}];return p.value&&(n.push({label:"Marquer",icon:"i-lucide-bookmark",onSelect:()=>s.value=!0,ui:{item:"cursor-pointer"}}),n.push({label:"Ajouter Note",icon:"i-lucide-notebook-pen",onSelect:()=>v.value=!0,ui:{item:"cursor-pointer"}})),n}),b=async()=>{if(a.bookmark)try{await $fetch(`/api/bible/bookmarks/${a.bookmark.id}`,{method:"DELETE"}),w.add({title:"Signet supprimé",description:"Le signet a été supprimer avec succès"}),o("refreshBookmark")}catch(n){console.log(n)}},I=U(null),g=n=>{I.value=n,v.value=!0};return(n,u)=>{const i=F,$=Y,m=me,q=Le,T=Pt,B=jt,H=Gt,_=Yt;return r(),O(G,null,[d(B,{items:e(k)},{default:l(()=>[z("span",null,[e(p)&&n.notes.length?(r(),O("button",{key:0,class:"cursor-pointer mr-0.5",onClick:u[0]||(u[0]=V=>f.value=!0)},[d(i,{name:"i-lucide-notebook-pen",class:"size-3 text-warning-500 dark:text-warning-400"})])):L("",!0),z("span",ea,M(n.verse.verse),1),d(q,{open:e(s),"onUpdate:open":u[5]||(u[5]=V=>le(s)?s.value=V:null),content:{sideOffset:0},arrow:""},{anchor:l(()=>[z("span",{class:C({underline:e(s)||n.bookmark})},[n.bookmark?(r(),S(q,{key:1,mode:"hover",arrow:"","onUpdate:open":u[2]||(u[2]=V=>!V&&(c.value=!1))},Z({default:l(()=>[z("span",{class:C(["decoration-2",{underline:e(s)||n.bookmark}]),style:$e(`text-decoration-color: var(--color-${n.bookmark?.color}-500)`)},M(n.verse.text),7)]),_:2},[n.bookmark.title?{name:"content",fn:l(()=>[d(m,{ui:{header:"p-2 sm:px-4",footer:"p-2 sm:px-4 flex items-center space-x-4"}},Z({header:l(()=>[z("div",ta,[z("p",null,M(n.bookmark.title),1),z("span",{class:"cursor-pointer rounded-sm bg-gray-50 hover:bg-red-50 flex items-center justify-center p-1 text-red-500 hover:text-red-700",onClick:u[1]||(u[1]=V=>c.value=!0)},[d(i,{name:"i-lucide-trash-2"})])])]),_:2},[e(c)?{name:"footer",fn:l(()=>[d($,{size:"sm",color:"error",onClick:b},{default:l(()=>[...u[10]||(u[10]=[E(" Supprimer ",-1)])]),_:1}),d($,{size:"sm",variant:"outline",color:"neutral"},{default:l(()=>[...u[11]||(u[11]=[E(" Annuler ",-1)])]),_:1})]),key:"0"}:void 0]),1024)]),key:"0"}:void 0]),1024)):(r(),O(G,{key:0},[E(M(n.verse.text),1)],64))],2)]),content:l(()=>[d(T,{"verse-id":n.verse.id,onCloseForm:u[3]||(u[3]=V=>s.value=!1),onCreated:u[4]||(u[4]=V=>o("refreshBookmark"))},null,8,["verse-id"])]),_:1},8,["open"])])]),_:1},8,["items"]),d(H,{open:e(f),"onUpdate:open":u[6]||(u[6]=V=>le(f)?f.value=V:null),notes:n.notes,verse:n.verse,book:n.book,"onEdit:note":g,onRefreshNote:u[7]||(u[7]=V=>o("refreshNote"))},null,8,["open","notes","verse","book"]),d(_,{open:e(v),"onUpdate:open":u[8]||(u[8]=V=>le(v)?v.value=V:null),verse:n.verse,book:n.book,note:e(I),onRefreshNote:u[9]||(u[9]=V=>o("refreshNote"))},null,8,["open","verse","book","note"])],64)}}}),oa=Object.assign(aa,{__name:"BibleVerse"}),sa={class:"p-6"},na={class:"space-y-4"},ia={class:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg"},la={class:"font-medium"},ra={key:0},ua={class:"grid grid-cols-1 sm:grid-cols-2 gap-4 max-h-60 overflow-y-auto"},da=["onClick"],ca={class:"text-sm font-medium text-gray-900 dark:text-white"},ma={class:"text-xs text-gray-500 dark:text-gray-400"},ga={class:"mt-2 text-xs text-gray-500"},pa={class:"flex justify-end gap-2 mt-6"},fa=W({__name:"BibleCompareModal",props:J({availableVersions:{},book:{},chapter:{},version:{},verseStart:{},verseEnd:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const y=t,a=se(t,"modelValue"),o=U(!1),c=U([y.version]),s=f=>{const v=c.value.indexOf(f);v>-1?c.value.splice(v,1):c.value.length<6&&c.value.push(f)},w=async()=>{if(!(c.value.length<2))try{o.value=!0;const f=y.availableVersions.filter(p=>c.value.includes(p.id)).map(p=>p.code),v=new URLSearchParams({book:y.book.code,chapter:y.chapter.toString(),verses:y.verseStart.toString(),versions:f.join(",")});y.verseEnd&&y.verseEnd!==y.verseStart&&v.set("verses",y.verseStart.toString()+"-"+y.verseEnd.toString()),await ut(`/bible/compare?${v.toString()}`)}catch(f){console.error("Erreur lors de la comparaison:",f)}finally{o.value=!1,a.value=!1}};return ne(()=>y.version,f=>{c.value=[f]}),(f,v)=>{const p=It,k=qe,b=Y,I=dt;return r(),S(I,{open:a.value,"onUpdate:open":v[1]||(v[1]=g=>a.value=g),title:"Comparer ce passage",description:"Terme théologique",ui:{description:"hidden",content:"max-w-2xl"}},{content:l(()=>[z("div",sa,[z("div",na,[z("div",null,[v[2]||(v[2]=z("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-2"}," Passage sélectionné : ",-1)),z("div",ia,[z("p",la,[E(M(f.book.name)+" "+M(f.chapter)+":"+M(f.verseStart)+" ",1),f.verseEnd&&f.verseEnd!==f.verseStart?(r(),O("span",ra," -"+M(f.verseEnd),1)):L("",!0)])])]),d(k,{label:"Versions à comparer (sélectionnez 2 à 6 versions)"},{default:l(()=>[z("div",ua,[(r(!0),O(G,null,Q(f.availableVersions,g=>(r(),O("div",{key:g.id,class:"flex items-center space-x-2"},[d(p,{"model-value":e(c).includes(g.id),disabled:e(c).length>=6&&!e(c).includes(g.id),"onUpdate:modelValue":n=>s(g.id)},null,8,["model-value","disabled","onUpdate:modelValue"]),z("div",{class:"flex-1",onClick:n=>s(g.id)},[z("div",ca,M(g.name),1),z("div",ma,M(g.code)+" • "+M(g.language),1)],8,da)]))),128))]),z("div",ga,M(e(c).length)+" version(s) sélectionnée(s) (minimum 2, maximum 6) ",1)]),_:1})]),z("div",pa,[d(b,{label:"Annuler",variant:"ghost",onClick:v[0]||(v[0]=g=>a.value=!1)}),d(b,{label:"Comparer",disabled:e(c).length<2,loading:e(o),onClick:w},null,8,["disabled","loading"])])])]),_:1},8,["open"])}}}),va=Object.assign(fa,{__name:"BibleCompareModal"}),ba={class:"space-y-6"},ha={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-2"},ya={class:"flex flex-1 items-center gap-2"},ka={class:"space-x-1"},xa={class:"flex justify-center gap-2"},wa=W({__name:"BibleReader",props:{book:{},chapter:{},versesData:{},notes:{},bookmarks:{},versions:{},selectedVersion:{}},emits:["update:chapter","refreshBookmark","refreshNotes"],setup(t,{emit:y}){const a=t,o=n=>{c.value={book:{code:a.book.code,name:a.book.name},verseStart:n,chapter:a.chapter,version:a.selectedVersion.id},w.value=!0},c=U(null),s=n=>{c.value={book:{code:a.book.code,name:a.book.name},verseStart:n,chapter:a.chapter,version:a.selectedVersion.id},f.value=!0},w=U(!1),f=U(!1),v=y,p=N(()=>Array.from({length:a.versesData?.navigation.totalChapters||0},(n,u)=>u+1)),k=n=>a.notes.filter(u=>u.verse.verse===n)||[],b=n=>a.bookmarks.find(u=>u.verse.verse===n)||null,I=N(()=>a.versesData?.verses||[]),g=n=>{v("update:chapter",n)};return(n,u)=>{const i=Ae,$=Y,m=oa,q=me,T=va;return r(),O("div",ba,[d(q,{class:"mb-4"},{header:l(()=>[z("div",ha,[z("div",ya,[u[5]||(u[5]=z("p",null,"Chapitre",-1)),d(i,{items:p.value,"model-value":n.chapter,placeholder:"Chapitre",class:"w-32","onUpdate:modelValue":g},null,8,["items","model-value"])]),d($,{color:"secondary",variant:"ghost",to:"/bible/compare","trailing-icon":"i-lucide-chevron-right"},{default:l(()=>[...u[6]||(u[6]=[E(" Comparer ",-1)])]),_:1})])]),footer:l(()=>[z("div",xa,[n.versesData?.navigation.previousChapter?(r(),S($,{key:0,icon:"i-lucide-arrow-left",color:"primary",variant:"soft",onClick:u[2]||(u[2]=B=>g(n.versesData.navigation.previousChapter))},{default:l(()=>[...u[7]||(u[7]=[E(" Précédent ",-1)])]),_:1})):L("",!0),n.versesData?.navigation.nextChapter?(r(),S($,{key:1,"trailing-icon":"i-lucide-arrow-right",color:"primary",variant:"soft",onClick:u[3]||(u[3]=B=>g(n.versesData.navigation.nextChapter))},{default:l(()=>[...u[8]||(u[8]=[E(" Suivant ",-1)])]),_:1})):L("",!0)])]),default:l(()=>[z("div",ka,[(r(!0),O(G,null,Q(I.value,B=>(r(),S(m,{key:B.id,book:n.book,verse:B,notes:k(B.verse),bookmark:b(B.verse),onShowCompare:o,onAddNote:s,onRefreshBookmark:u[0]||(u[0]=H=>v("refreshBookmark")),onRefreshNote:u[1]||(u[1]=H=>v("refreshNotes"))},null,8,["book","verse","notes","bookmark"]))),128))])]),_:1}),e(c)?(r(),S(T,R({key:0,modelValue:e(w),"onUpdate:modelValue":u[4]||(u[4]=B=>le(w)?w.value=B:null)},e(c),{"available-versions":n.versions}),null,16,["modelValue","available-versions"])):L("",!0)])}}}),Sa=Object.assign(wa,{__name:"BibleReader"}),Pa=W({__name:"index",async setup(t){let y,a;const o=ct(),{data:c}=([y,a]=be(()=>he("bible-books",()=>$fetch("/api/bible/books"),{transform:h=>h?.data||[]})),y=await y,a(),y),{data:s}=([y,a]=be(()=>he("bible-versions",()=>$fetch("/api/bible/versions"),{transform:h=>h?.data||[]})),y=await y,a(),y),{data:w}=([y,a]=be(()=>he("bible-verses",()=>$fetch(`/api/bible/verses/${o.query.book||"GEN"}/${o.query.chapter||"1"}`,{query:{version:o.query.version||"LSG"}}),{watch:[()=>o.query],transform:h=>h?.data||[]})),y=await y,a(),y),{loggedIn:f}=Pe(),v=mt(),p=N({get:()=>o.query.book||"GEN",set:h=>{v.push({query:{...o.query,book:h}})}}),k=N({get:()=>parseInt(o.query.chapter||"1"),set:h=>{v.push({query:{...o.query,chapter:h}})}}),b=N({get:()=>o.query.version||"LSG",set:h=>{v.push({query:{...o.query,version:h}})}}),I=N(()=>c.value?.all||[]),g=U(null),n=U([]),u=U([]),i=U([]),$=N(()=>{const h=c.value?.grouped||{old:[],new:[]},A=h.old,P=h.new;return[{label:"Ancien Testament",open:A.some(x=>x.code===p.value),active:A.some(x=>x.code===p.value),ui:{link:"cursor-pointer"},children:A.map(x=>({label:x.name,onSelect:async()=>await B(x.code),active:p.value===x.code,ui:{link:"cursor-pointer"}}))},{label:"Nouveau Testament",open:P.some(x=>x.code===p.value),active:P.some(x=>x.code===p.value),ui:{link:"cursor-pointer"},children:P.map(x=>({label:x.name,onSelect:async()=>await B(x.code),active:p.value===x.code,ui:{link:"cursor-pointer"}}))}]}),m=N(()=>s.value?s.value.map(h=>({label:h.name,to:v.resolve({query:{...o.query,version:h.code}}).href,active:b.value===h.code})):[]),q=N(()=>!I.value||!p.value?null:I.value.find(h=>h.code==p.value)),T=N(()=>!s.value||!b.value?null:s.value.find(h=>h.code==b.value)),B=async h=>{await v.push({query:{...o.query,book:h,chapter:1}})},H=(h,A)=>{if(!n.value)return;const P=n.value.find(x=>x.bookCode===h);P?P.chaptersId.includes(A)||P.chaptersId.push(A):n.value.push({bookCode:h,chaptersId:[A]})},_=async h=>{await v.push({query:{...o.query,chapter:h}}),f&&p.value&&H(p.value,h)};gt({title:"Lire la Bible en ligne - Théologie Pour Tous",ogTitle:"Lire la Bible en ligne - Théologie Pour Tous",description:"Lisez la Bible en ligne avec différentes versions disponibles. Parcourez les livres et chapitres de la Bible facilement.",ogDescription:"Lisez la Bible en ligne avec différentes versions disponibles. Parcourez les livres et chapitres de la Bible facilement."});const V=async()=>{if(!(!f||!T.value||!s.value))try{const h=s.value.find(P=>P.code===b.value)?.id;if(!h)return;const A=await $fetch("/api/reading/sessions",{method:"POST",body:{action:"start",versionId:h,chaptersRead:JSON.stringify([{bookCode:p.value,chaptersId:k.value?[k.value]:[]}])}});if(A.success&&A.sessionId){const P=[{bookCode:p.value,chaptersId:k.value?[k.value]:[]}];g.value={id:A.sessionId,chaptersRead:P},n.value=P}}catch(h){console.error("Erreur lors du démarrage de la session:",h)}},ie=async()=>{if(!(!f||!g.value))try{await $fetch("/api/reading/sessions",{method:"POST",body:{action:"end",sessionId:g.value.id,chaptersRead:JSON.stringify(n.value)}})}catch(h){console.error("Erreur lors de la fermeture de la session:",h)}};Ne(async()=>{f&&(await V(),await ee(),await te())}),pt(async()=>{f&&await ie()});const ee=async()=>{if(!(!b.value||!p.value||!k.value))try{const h=await $fetch("/api/bible/notes",{method:"GET",query:{book:p.value,chapter:k.value}});u.value=h?.data.notes||[]}catch(h){console.error("Erreur lors du chargement des notes:",h)}},te=async()=>{if(!(!T.value||!p.value||!k.value))try{const h=await $fetch("/api/bible/bookmarks",{method:"GET",query:{book:p.value,chapter:k.value}});i.value=h?.data.bookmarks||[]}catch(h){console.error("Erreur lors du chargement des signets:",h)}};return ne([()=>o.query.chapter,()=>o.query.book],async()=>{await ee(),await te()}),$t(),(h,A)=>{const P=vt,x=ht,D=yt,ae=Sa,ge=bt,pe=kt,fe=ft;return r(),S(fe,null,Z({left:l(()=>[d(x,null,{top:l(()=>[...A[0]||(A[0]=[E(" Les livres ",-1)])]),default:l(()=>[e(I)?.length?(r(),S(P,{key:0,items:e($),highlight:"",orientation:"vertical"},null,8,["items"])):L("",!0)]),_:1})]),default:l(()=>[e(q)&&e(k)?(r(),S(D,{key:0,title:`${e(q).name} ${e(k)}`,description:e(T)?.name||"Aucune version sélectionnée"},null,8,["title","description"])):L("",!0),d(pe,null,{default:l(()=>[z("div",null,[e(q)&&e(k)&&e(T)&&e(w)?(r(),S(ae,{key:0,book:e(q),chapter:e(k),"verses-data":e(w),versions:e(s)||[],"selected-version":e(T),notes:e(u),bookmarks:e(i),"onUpdate:chapter":_,onRefreshBookmark:te,onRefreshNotes:ee},null,8,["book","chapter","verses-data","versions","selected-version","notes","bookmarks"])):L("",!0)]),d(ge)]),_:1})]),_:2},[e(s)?.length?{name:"right",fn:l(()=>[d(x,null,{top:l(()=>[...A[1]||(A[1]=[E(" Versions disponibles ",-1)])]),default:l(()=>[d(P,{items:e(m),variant:"link",orientation:"vertical"},null,8,["items"])]),_:1})]),key:"0"}:void 0]),1024)}}});export{Pa as default};
