import{B as x,D as y,a6 as b,a5 as w,W as z,r as C,z as T,w as r,G as m,e as _,M as t,g as c,a7 as E,a8 as l}from"#entry";import{o as L,s as n,_ as h}from"./D4b9tf7C.js";import"./DdOBpqfI.js";import"./DY4djKfE.js";import"./ath3GSdt.js";import"./j7pdL1SH.js";import"./BbRiUxvT.js";const V=x({__name:"signup",setup(S){y({title:"Inscription - Théologie pour Tous",description:"Créez un compte pour commencer votre parcours théologique"});const i=b(),{loggedIn:u}=w();z(u,s=>{s&&l("/")},{immediate:!0});const d=[{name:"name",type:"text",label:"Nom",placeholder:"Entrez votre nom complet",required:!0},{name:"email",type:"text",label:"Email",placeholder:"Entrez votre email",required:!0},{name:"password",label:"Mot de passe",type:"password",placeholder:"Entrez votre mot de passe (min. 6 caractères)",required:!0}],p=[{label:"Google",icon:"i-simple-icons-google",onClick:()=>{i.add({title:"Prochainement",description:"Inscription avec Google bientôt disponible",color:"primary"})}}],f=L({name:n().min(2,"Le nom doit contenir au moins 2 caractères"),email:n().email("Format email invalide"),password:n().min(6,"Le mot de passe doit contenir au moins 6 caractères").regex(/(?=.*[a-z])/,"Le mot de passe doit contenir au moins une minuscule").regex(/(?=.*[A-Z])/,"Le mot de passe doit contenir au moins une majuscule").regex(/(?=.*\d)/,"Le mot de passe doit contenir au moins un chiffre")}),a=C(!1);async function g(s){a.value=!0;try{const e=await $fetch("/api/auth/register",{method:"POST",body:s.data});e.success&&await l("/"),i.add({title:"Inscription réussie",description:`Bienvenue ${e.user.name} ! Votre compte a été créé avec succès.`,color:"success"})}catch(e){console.error("Erreur d'inscription:",e);let o="Une erreur s'est produite lors de l'inscription";e.statusCode===409?o="Un utilisateur avec cet email existe déjà":e.data?.message&&(o=e.data.message),i.add({title:"Erreur d'inscription",description:o,color:"error"})}finally{a.value=!1}}return(s,e)=>{const o=E,v=h;return _(),T(v,{fields:d,schema:m(f),providers:p,loading:m(a),title:"Créer un compte",icon:"i-lucide-user-plus",submit:{label:"Créer le compte"},onSubmit:g},{description:r(()=>[e[1]||(e[1]=t(" Vous avez déjà un compte ? ",-1)),c(o,{to:"/login",class:"text-primary font-medium"},{default:r(()=>[...e[0]||(e[0]=[t("Se connecter",-1)])]),_:1}),e[2]||(e[2]=t(". ",-1))]),footer:r(()=>[e[4]||(e[4]=t(" En vous inscrivant, vous acceptez nos ",-1)),c(o,{to:"/",class:"text-primary font-medium"},{default:r(()=>[...e[3]||(e[3]=[t("Conditions d'utilisation",-1)])]),_:1}),e[5]||(e[5]=t(". ",-1))]),_:1},8,["schema","loading"])}}});export{V as default};
