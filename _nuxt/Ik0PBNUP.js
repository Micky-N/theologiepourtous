import{B as W,aa as Re,ad as Ke,ab as Ie,V as N,a9 as De,z as k,e as r,w as i,X as M,f as T,G as e,E as R,af as Ge,aw as Se,a1 as re,ax as J,ay as ee,an as xe,r as U,a6 as ue,g as d,L as Z,M as F,aq as we,as as qe,h as $,a4 as $e,Z as K,$ as de,ao as He,y as ce,az as Je,aA as ze,aj as Ce,aB as We,ar as Ve,at as Qe,aC as Ze,d as _,n as C,N as Be,aD as se,t as A,F as H,H as Q,aE as Xe,aF as G,aG as Ye,Q as X,a7 as et,aH as tt,aI as at,aJ as ye,aK as ke,ak as Te,a0 as Y,aL as ot,aM as nt,W as te,aN as _e,aO as st,al as Ue,aP as lt,o as Le,am as it,ag as rt,aQ as ut,aR as dt,aS as ct,a5 as Oe,aT as mt,I as le,a8 as gt,aU as Pe,v as pt,C as be,a as ft,D as vt,aV as bt,P as ht,aW as yt,R as kt}from"#entry";import{_ as xt}from"./DTIFCxQf.js";import{_ as wt,a as qt}from"./BiYaFSpO.js";import{u as It,V as St,_ as Ne}from"./DnA5474r.js";import{_ as me}from"./sIOFFvLP.js";import{_ as Ae}from"./BLT4CIBk.js";import{_ as $t}from"./FmXn-pHn.js";import{u as he}from"./B7UDBhQ8.js";import{d as zt}from"./D8rO69WY.js";import"./j7pdL1SH.js";import"./BbRiUxvT.js";const[Ct,Vt]=De("SwitchRoot");var Bt=W({__name:"SwitchRoot",props:{defaultValue:{type:Boolean,required:!1},modelValue:{type:[Boolean,null],required:!1,default:void 0},disabled:{type:Boolean,required:!1},id:{type:String,required:!1},value:{type:String,required:!1,default:"on"},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"},name:{type:String,required:!1},required:{type:Boolean,required:!1}},emits:["update:modelValue"],setup(t,{emit:b}){const a=t,o=b,{disabled:g}=Re(a),n=Ke(a,"modelValue",o,{defaultValue:a.defaultValue,passive:a.modelValue===void 0});function m(){g.value||(n.value=!n.value)}const{forwardRef:c,currentElement:v}=Ie(),y=It(v),x=N(()=>a.id&&v.value?document.querySelector(`[for="${a.id}"]`)?.innerText:void 0);return Vt({modelValue:n,toggleCheck:m,disabled:g}),(w,f)=>(r(),k(e(re),R(w.$attrs,{id:w.id,ref:e(c),role:"switch",type:w.as==="button"?"button":void 0,value:w.value,"aria-label":w.$attrs["aria-label"]||x.value,"aria-checked":e(n),"aria-required":w.required,"data-state":e(n)?"checked":"unchecked","data-disabled":e(g)?"":void 0,"as-child":w.asChild,as:w.as,disabled:e(g),onClick:m,onKeydown:Ge(Se(m,["prevent"]),["enter"])}),{default:i(()=>[M(w.$slots,"default",{modelValue:e(n)}),e(y)&&w.name?(r(),k(e(St),{key:0,type:"checkbox",name:w.name,disabled:e(g),required:w.required,value:w.value,checked:!!e(n)},null,8,["name","disabled","required","value","checked"])):T("v-if",!0)]),_:3},16,["id","type","value","aria-label","aria-checked","aria-required","data-state","data-disabled","as-child","as","disabled","onKeydown"]))}}),Tt=Bt,_t=W({__name:"SwitchThumb",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(t){const b=Ct();return Ie(),(a,o)=>(r(),k(e(re),{"data-state":e(b).modelValue?.value?"checked":"unchecked","data-disabled":e(b).disabled.value?"":void 0,"as-child":a.asChild,as:a.as},{default:i(()=>[M(a.$slots,"default")]),_:3},8,["data-state","data-disabled","as-child","as"]))}}),Ut=_t;const Lt={class:"flex items-center gap-2"},Ot={class:"mt-2 flex items-center gap-1"},Pt=W({__name:"BookmarkFormPopover",props:J({verseId:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:J(["closeForm","created"],["update:modelValue"]),setup(t,{emit:b}){const a=t,o=b,g=ee(t,"modelValue"),n=xe({title:"",color:"blue"}),m=[{label:"Rouge",value:"red"},{label:"Rose",value:"pink"},{label:"Fuchsia",value:"fuchsia"},{label:"Violet",value:"purple"},{label:"Violet clair",value:"violet"},{label:"Indigo",value:"indigo"},{label:"Bleu",value:"blue"},{label:"Ciel",value:"sky"},{label:"Cyan",value:"cyan"},{label:"Teal",value:"teal"},{label:"Émeraude",value:"emerald"},{label:"Vert",value:"green"},{label:"Lime",value:"lime"},{label:"Jaune",value:"yellow"},{label:"Ambre",value:"amber"},{label:"Orange",value:"orange"},{label:"Brun",value:"brown"},{label:"Gris",value:"gray"},{label:"Gris neutre",value:"neutral"},{label:"Ardoise",value:"slate"},{label:"Pierre",value:"stone"},{label:"Zinc",value:"zinc"},{label:"Noir",value:"black"}],c=U(!1),v=U(""),y=ue();function x(){g.value=!1,o("closeForm")}async function w(){v.value="",c.value=!0;try{const f=await $fetch("/api/bible/bookmarks",{method:"POST",body:{verseId:a.verseId,title:n.title,color:n.color}});f.success?(y.add({title:"Favori ajouté",description:f.message,color:"primary"}),o("created",f.data),x()):v.value=f.message||"Erreur inconnue"}catch(f){v.value=f?.statusMessage||"Erreur lors de l’ajout du favori"}finally{c.value=!1}}return(f,s)=>{const l=K,q=qe,u=we,z=Ne,p=Z,I=me,V=Ae;return r(),k(V,{state:e(n),onSubmit:Se(w,["prevent"])},{default:i(()=>[d(I,{ui:{header:"p-2 sm:px-4",footer:"p-2 sm:px-4"}},{header:i(()=>[$("div",Lt,[d(l,{name:"i-lucide-bookmark",class:"text-primary-600"}),s[2]||(s[2]=$("span",{class:"font-semibold text-sm"},"Ajouter aux favoris",-1))])]),default:i(()=>[d(u,{label:"Titre (optionnel)",name:"title",class:"mb-4"},{default:i(()=>[d(q,{modelValue:e(n).title,"onUpdate:modelValue":s[0]||(s[0]=O=>e(n).title=O),placeholder:"Titre personnalisé...",class:"w-full"},null,8,["modelValue"])]),_:1}),d(u,{label:"Couleur du favori",name:"color"},{default:i(()=>[d(z,{modelValue:e(n).color,"onUpdate:modelValue":s[1]||(s[1]=O=>e(n).color=O),items:m,"label-key":"label","value-key":"value",class:"flex gap-2 w-full"},null,8,["modelValue"]),$("div",Ot,[s[3]||(s[3]=F(" Aperçu : ",-1)),$("span",{style:$e([`background-color: var(--color-${e(n).color}-400)`,`border: solid 1px var(--color-${e(n).color}-700)`]),class:"inline-block size-4 rounded-full border"},null,4)])]),_:1})]),footer:i(()=>[d(p,{type:"submit",color:"primary",loading:e(c),class:"w-full flex justify-center"},{default:i(()=>[...s[4]||(s[4]=[F(" Ajouter ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["state"])}}}),Nt=Object.assign(Pt,{__name:"BookmarkFormPopover"}),je={__name:"UContextMenuContent",props:{items:{type:null,required:!1},portal:{type:[Boolean,String],required:!1,skipCheck:!0},sub:{type:Boolean,required:!1},labelKey:{type:null,required:!0},checkedIcon:{type:[String,Object],required:!1},loadingIcon:{type:[String,Object],required:!1},externalIcon:{type:[Boolean,String,Object],required:!1},class:{type:null,required:!1},ui:{type:null,required:!0},uiOverride:{type:null,required:!1},loop:{type:Boolean,required:!1},sideFlip:{type:Boolean,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","closeAutoFocus"],setup(t,{emit:b}){const a=t,o=b,g=de(),{dir:n}=He(),m=ce(),c=Je(ze(()=>a.portal)),v=Ce(We(a,"sub","items","portal","labelKey","checkedIcon","loadingIcon","externalIcon","class","ui","uiOverride"),o),y=Ve(g,["default"]),[x,w]=Qe(),f=N(()=>n.value==="rtl"?m.ui.icons.chevronLeft:m.ui.icons.chevronRight),s=N(()=>a.items?.length?Ze(a.items)?a.items:[a.items]:[]);return(l,q)=>(r(),_(H,null,[d(e(x),null,{default:i(({item:u,active:z,index:p})=>[M(l.$slots,u.slot||"item",{item:u,index:p},()=>[M(l.$slots,u.slot?`${u.slot}-leading`:"item-leading",{item:u,active:z,index:p},()=>[u.loading?(r(),k(K,{key:0,name:t.loadingIcon||e(m).ui.icons.loading,class:C(t.ui.itemLeadingIcon({class:[t.uiOverride?.itemLeadingIcon,u.ui?.itemLeadingIcon],color:u?.color,loading:!0}))},null,8,["name","class"])):u.icon?(r(),k(K,{key:1,name:u.icon,class:C(t.ui.itemLeadingIcon({class:[t.uiOverride?.itemLeadingIcon,u.ui?.itemLeadingIcon],color:u?.color,active:z}))},null,8,["name","class"])):u.avatar?(r(),k(Be,R({key:2,size:u.ui?.itemLeadingAvatarSize||t.uiOverride?.itemLeadingAvatarSize||t.ui.itemLeadingAvatarSize()},u.avatar,{class:t.ui.itemLeadingAvatar({class:[t.uiOverride?.itemLeadingAvatar,u.ui?.itemLeadingAvatar],active:z})}),null,16,["size","class"])):T("",!0)]),e(se)(u,a.labelKey)||g[u.slot?`${u.slot}-label`:"item-label"]?(r(),_("span",{key:0,class:C(t.ui.itemLabel({class:[t.uiOverride?.itemLabel,u.ui?.itemLabel],active:z}))},[M(l.$slots,u.slot?`${u.slot}-label`:"item-label",{item:u,active:z,index:p},()=>[F(A(e(se)(u,a.labelKey)),1)]),u.target==="_blank"&&t.externalIcon!==!1?(r(),k(K,{key:0,name:typeof t.externalIcon=="string"?t.externalIcon:e(m).ui.icons.external,class:C(t.ui.itemLabelExternalIcon({class:[t.uiOverride?.itemLabelExternalIcon,u.ui?.itemLabelExternalIcon],color:u?.color,active:z}))},null,8,["name","class"])):T("",!0)],2)):T("",!0),$("span",{class:C(t.ui.itemTrailing({class:[t.uiOverride?.itemTrailing,u.ui?.itemTrailing]}))},[M(l.$slots,u.slot?`${u.slot}-trailing`:"item-trailing",{item:u,active:z,index:p},()=>[u.children?.length?(r(),k(K,{key:0,name:f.value,class:C(t.ui.itemTrailingIcon({class:[t.uiOverride?.itemTrailingIcon,u.ui?.itemTrailingIcon],color:u?.color,active:z}))},null,8,["name","class"])):u.kbds?.length?(r(),_("span",{key:1,class:C(t.ui.itemTrailingKbds({class:[t.uiOverride?.itemTrailingKbds,u.ui?.itemTrailingKbds]}))},[(r(!0),_(H,null,Q(u.kbds,(I,V)=>(r(),k(Xe,R({key:V,size:u.ui?.itemTrailingKbdsSize||t.uiOverride?.itemTrailingKbdsSize||t.ui.itemTrailingKbdsSize()},{ref_for:!0},typeof I=="string"?{value:I}:I),null,16,["size"]))),128))],2)):T("",!0)]),d(e(G).ItemIndicator,{"as-child":""},{default:i(()=>[d(K,{name:t.checkedIcon||e(m).ui.icons.check,class:C(t.ui.itemTrailingIcon({class:[t.uiOverride?.itemTrailingIcon,u.ui?.itemTrailingIcon],color:u?.color}))},null,8,["name","class"])]),_:2},1024)],2)])]),_:3}),d(e(G).Portal,ye(ke(e(c))),{default:i(()=>[(r(),k(Ye(t.sub?e(G).SubContent:e(G).Content),R({class:a.class},e(v)),{default:i(()=>[M(l.$slots,"content-top"),$("div",{role:"presentation",class:C(t.ui.viewport({class:t.uiOverride?.viewport}))},[(r(!0),_(H,null,Q(s.value,(u,z)=>(r(),k(e(G).Group,{key:`group-${z}`,class:C(t.ui.group({class:t.uiOverride?.group}))},{default:i(()=>[(r(!0),_(H,null,Q(u,(p,I)=>(r(),_(H,{key:`group-${z}-${I}`},[p.type==="label"?(r(),k(e(G).Label,{key:0,class:C(t.ui.label({class:[t.uiOverride?.label,p.ui?.label,p.class]}))},{default:i(()=>[d(e(w),{item:p,index:I},null,8,["item","index"])]),_:2},1032,["class"])):p.type==="separator"?(r(),k(e(G).Separator,{key:1,class:C(t.ui.separator({class:[t.uiOverride?.separator,p.ui?.separator,p.class]}))},null,8,["class"])):p?.children?.length?(r(),k(e(G).Sub,{key:2,open:p.open,"default-open":p.defaultOpen},{default:i(()=>[d(e(G).SubTrigger,{as:"button",type:"button",disabled:p.disabled,"text-value":e(se)(p,a.labelKey),class:C(t.ui.item({class:[t.uiOverride?.item,p.ui?.item,p.class],color:p?.color}))},{default:i(()=>[d(e(w),{item:p,index:I},null,8,["item","index"])]),_:2},1032,["disabled","text-value","class"]),d(je,R({sub:"",class:a.class,ui:t.ui,"ui-override":t.uiOverride,portal:t.portal,items:p.children,"align-offset":-4,"label-key":t.labelKey,"checked-icon":t.checkedIcon,"loading-icon":t.loadingIcon,"external-icon":t.externalIcon},{ref_for:!0},p.content),X({_:2},[Q(e(y),(V,O)=>({name:O,fn:i(B=>[M(l.$slots,O,R({ref_for:!0},B))])}))]),1040,["class","ui","ui-override","portal","items","label-key","checked-icon","loading-icon","external-icon"])]),_:2},1032,["open","default-open"])):p.type==="checkbox"?(r(),k(e(G).CheckboxItem,{key:3,"model-value":p.checked,disabled:p.disabled,"text-value":e(se)(p,a.labelKey),class:C(t.ui.item({class:[t.uiOverride?.item,p.ui?.item,p.class],color:p?.color})),"onUpdate:modelValue":p.onUpdateChecked,onSelect:p.onSelect},{default:i(()=>[d(e(w),{item:p,index:I},null,8,["item","index"])]),_:2},1032,["model-value","disabled","text-value","class","onUpdate:modelValue","onSelect"])):(r(),k(e(G).Item,{key:4,"as-child":"",disabled:p.disabled,"text-value":e(se)(p,a.labelKey),onSelect:p.onSelect},{default:i(()=>[d(et,R({ref_for:!0},e(tt)(p),{custom:""}),{default:i(({active:V,...O})=>[d(at,R({ref_for:!0},O,{class:t.ui.item({class:[t.uiOverride?.item,p.ui?.item,p.class],active:V,color:p?.color})}),{default:i(()=>[d(e(w),{item:p,active:V,index:I},null,8,["item","active","index"])]),_:2},1040,["class"])]),_:2},1040)]),_:2},1032,["disabled","text-value","onSelect"]))],64))),128))]),_:2},1032,["class"]))),128))],2),M(l.$slots,"default"),M(l.$slots,"content-bottom")]),_:3},16,["class"]))]),_:3},16)],64))}},At={slots:{content:"min-w-32 bg-default shadow-lg rounded-md ring ring-default overflow-hidden data-[state=open]:animate-[scale-in_100ms_ease-out] data-[state=closed]:animate-[scale-out_100ms_ease-in] origin-(--reka-context-menu-content-transform-origin) flex flex-col",viewport:"relative divide-y divide-default scroll-py-1 overflow-y-auto flex-1",group:"p-1 isolate",label:"w-full flex items-center font-semibold text-highlighted",separator:"-mx-1 my-1 h-px bg-border",item:"group relative w-full flex items-center select-none outline-none before:absolute before:z-[-1] before:inset-px before:rounded-md data-disabled:cursor-not-allowed data-disabled:opacity-75",itemLeadingIcon:"shrink-0",itemLeadingAvatar:"shrink-0",itemLeadingAvatarSize:"",itemTrailing:"ms-auto inline-flex gap-1.5 items-center",itemTrailingIcon:"shrink-0",itemTrailingKbds:"hidden lg:inline-flex items-center shrink-0",itemTrailingKbdsSize:"",itemLabel:"truncate",itemLabelExternalIcon:"inline-block size-3 align-top text-dimmed"},variants:{color:{primary:"",secondary:"",success:"",info:"",warning:"",error:"",neutral:""},active:{true:{item:"text-highlighted before:bg-elevated",itemLeadingIcon:"text-default"},false:{item:["text-default data-highlighted:text-highlighted data-[state=open]:text-highlighted data-highlighted:before:bg-elevated/50 data-[state=open]:before:bg-elevated/50","transition-colors before:transition-colors"],itemLeadingIcon:["text-dimmed group-data-highlighted:text-default group-data-[state=open]:text-default","transition-colors"]}},loading:{true:{itemLeadingIcon:"animate-spin"}},size:{xs:{label:"p-1 text-xs gap-1",item:"p-1 text-xs gap-1",itemLeadingIcon:"size-4",itemLeadingAvatarSize:"3xs",itemTrailingIcon:"size-4",itemTrailingKbds:"gap-0.5",itemTrailingKbdsSize:"sm"},sm:{label:"p-1.5 text-xs gap-1.5",item:"p-1.5 text-xs gap-1.5",itemLeadingIcon:"size-4",itemLeadingAvatarSize:"3xs",itemTrailingIcon:"size-4",itemTrailingKbds:"gap-0.5",itemTrailingKbdsSize:"sm"},md:{label:"p-1.5 text-sm gap-1.5",item:"p-1.5 text-sm gap-1.5",itemLeadingIcon:"size-5",itemLeadingAvatarSize:"2xs",itemTrailingIcon:"size-5",itemTrailingKbds:"gap-0.5",itemTrailingKbdsSize:"md"},lg:{label:"p-2 text-sm gap-2",item:"p-2 text-sm gap-2",itemLeadingIcon:"size-5",itemLeadingAvatarSize:"2xs",itemTrailingIcon:"size-5",itemTrailingKbds:"gap-1",itemTrailingKbdsSize:"md"},xl:{label:"p-2 text-base gap-2",item:"p-2 text-base gap-2",itemLeadingIcon:"size-6",itemLeadingAvatarSize:"xs",itemTrailingIcon:"size-6",itemTrailingKbds:"gap-1",itemTrailingKbdsSize:"lg"}}},compoundVariants:[{color:"primary",active:!1,class:{item:"text-primary data-highlighted:text-primary data-highlighted:before:bg-primary/10 data-[state=open]:before:bg-primary/10",itemLeadingIcon:"text-primary/75 group-data-highlighted:text-primary group-data-[state=open]:text-primary"}},{color:"secondary",active:!1,class:{item:"text-secondary data-highlighted:text-secondary data-highlighted:before:bg-secondary/10 data-[state=open]:before:bg-secondary/10",itemLeadingIcon:"text-secondary/75 group-data-highlighted:text-secondary group-data-[state=open]:text-secondary"}},{color:"success",active:!1,class:{item:"text-success data-highlighted:text-success data-highlighted:before:bg-success/10 data-[state=open]:before:bg-success/10",itemLeadingIcon:"text-success/75 group-data-highlighted:text-success group-data-[state=open]:text-success"}},{color:"info",active:!1,class:{item:"text-info data-highlighted:text-info data-highlighted:before:bg-info/10 data-[state=open]:before:bg-info/10",itemLeadingIcon:"text-info/75 group-data-highlighted:text-info group-data-[state=open]:text-info"}},{color:"warning",active:!1,class:{item:"text-warning data-highlighted:text-warning data-highlighted:before:bg-warning/10 data-[state=open]:before:bg-warning/10",itemLeadingIcon:"text-warning/75 group-data-highlighted:text-warning group-data-[state=open]:text-warning"}},{color:"error",active:!1,class:{item:"text-error data-highlighted:text-error data-highlighted:before:bg-error/10 data-[state=open]:before:bg-error/10",itemLeadingIcon:"text-error/75 group-data-highlighted:text-error group-data-[state=open]:text-error"}},{color:"primary",active:!0,class:{item:"text-primary before:bg-primary/10",itemLeadingIcon:"text-primary"}},{color:"secondary",active:!0,class:{item:"text-secondary before:bg-secondary/10",itemLeadingIcon:"text-secondary"}},{color:"success",active:!0,class:{item:"text-success before:bg-success/10",itemLeadingIcon:"text-success"}},{color:"info",active:!0,class:{item:"text-info before:bg-info/10",itemLeadingIcon:"text-info"}},{color:"warning",active:!0,class:{item:"text-warning before:bg-warning/10",itemLeadingIcon:"text-warning"}},{color:"error",active:!0,class:{item:"text-error before:bg-error/10",itemLeadingIcon:"text-error"}}],defaultVariants:{size:"md"}},jt={__name:"UContextMenu",props:{size:{type:null,required:!1},items:{type:null,required:!1},checkedIcon:{type:[String,Object],required:!1},loadingIcon:{type:[String,Object],required:!1},externalIcon:{type:[Boolean,String,Object],required:!1,default:!0},content:{type:Object,required:!1},portal:{type:[Boolean,String],required:!1,skipCheck:!0,default:!0},labelKey:{type:null,required:!1,default:"label"},disabled:{type:Boolean,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1},pressOpenDelay:{type:Number,required:!1},modal:{type:Boolean,required:!1,default:!0}},emits:["update:open"],setup(t,{emit:b}){const a=t,o=b,g=de(),n=ce(),m=Ce(Te(a,"modal"),o),c=ze(()=>a.content),v=Ve(g,["default"]),y=N(()=>Y({extend:Y(At),...n.ui?.contextMenu||{}})({size:a.size}));return(x,w)=>(r(),k(e(nt),ye(ke(e(m))),{default:i(()=>[g.default?(r(),k(e(ot),{key:0,"as-child":"",disabled:t.disabled,class:C(a.class)},{default:i(()=>[M(x.$slots,"default")]),_:3},8,["disabled","class"])):T("",!0),d(je,R({class:y.value.content({class:[!g.default&&a.class,a.ui?.content]}),ui:y.value,"ui-override":a.ui},c.value,{items:t.items,portal:t.portal,"label-key":t.labelKey,"checked-icon":t.checkedIcon,"loading-icon":t.loadingIcon,"external-icon":t.externalIcon}),X({_:2},[Q(e(v),(f,s)=>({name:s,fn:i(l=>[M(x.$slots,s,ye(ke(l)))])}))]),1040,["class","ui","ui-override","items","portal","label-key","checked-icon","loading-icon","external-icon"])]),_:3},16))}},Mt=["innerHTML"],Ft={key:1,class:"space-y-4"},Et={class:"flex justify-between gap-4 items-center"},Rt={class:"flex gap-2 items-center"},Kt={class:"line-clamp-1"},Dt={class:"flex flex-1 justify-end gap-2 items-center"},Gt=W({__name:"NoteShowDrawer",props:J({notes:{}},{open:{type:Boolean,default:!1},openModifiers:{}}),emits:["update:open"],setup(t){const b=ee(t,"open"),a=U(null),o=N(()=>t.notes.find(n=>n.id===a.value)||null);te(b,n=>{n?t.notes.length==1&&t.notes[0]?.id&&(a.value=t.notes[0]?.id):a.value=null});const g=n=>n.replace(`
`,`<br />
`);return(n,m)=>{const c=Z,v=me,y=_e;return r(),k(y,{open:b.value,"onUpdate:open":m[1]||(m[1]=x=>b.value=x),title:e(o)?.title||"Liste des notes",description:e(o)?.reference||"Choisie une note",ui:{footer:"justify-end"}},X({body:i(()=>[e(o)?(r(),_("p",{key:0,innerHTML:g(e(o).content)},null,8,Mt)):(r(),_("div",Ft,[(r(!0),_(H,null,Q(n.notes,x=>(r(),k(v,{key:x.id,variant:"outline",ui:{body:"p-2 sm:py-2 sm:px-4"}},{default:i(()=>[$("div",Et,[$("div",Rt,[d(c,{icon:"i-lucide-arrow-left",size:"md",color:"primary",variant:"link",onClick:w=>a.value=x.id},null,8,["onClick"]),$("h4",Kt,A(x.title),1)]),d(c,{icon:"i-lucide-trash-2",size:"md",color:"error",variant:"ghost"})])]),_:2},1024))),128))]))]),_:2},[e(o)?{name:"footer",fn:i(()=>[n.notes.length>1?(r(),k(c,{key:0,icon:"i-lucide-arrow-left",size:"md",color:"primary",variant:"link",onClick:m[0]||(m[0]=x=>a.value=null)})):T("",!0),$("div",Dt,[d(c,{label:"Modifier",color:"secondary"}),d(c,{label:"Supprimer",color:"error",variant:"outline"})])]),key:"0"}:void 0]),1032,["open","title","description"])}}}),Ht=Object.assign(Gt,{__name:"NoteShowDrawer"}),Jt={slots:{root:"relative inline-flex items-center",base:["w-full rounded-md border-0 appearance-none placeholder:text-dimmed focus:outline-none disabled:cursor-not-allowed disabled:opacity-75","transition-colors"],leading:"absolute start-0 flex items-start",leadingIcon:"shrink-0 text-dimmed",leadingAvatar:"shrink-0",leadingAvatarSize:"",trailing:"absolute end-0 flex items-start",trailingIcon:"shrink-0 text-dimmed"},variants:{fieldGroup:{horizontal:{root:"group has-focus-visible:z-[1]",base:"group-not-only:group-first:rounded-e-none group-not-only:group-last:rounded-s-none group-not-last:group-not-first:rounded-none"},vertical:{root:"group has-focus-visible:z-[1]",base:"group-not-only:group-first:rounded-b-none group-not-only:group-last:rounded-t-none group-not-last:group-not-first:rounded-none"}},size:{xs:{base:"px-2 py-1 text-xs gap-1",leading:"ps-2 inset-y-1",trailing:"pe-2 inset-y-1",leadingIcon:"size-4",leadingAvatarSize:"3xs",trailingIcon:"size-4"},sm:{base:"px-2.5 py-1.5 text-xs gap-1.5",leading:"ps-2.5 inset-y-1.5",trailing:"pe-2.5 inset-y-1.5",leadingIcon:"size-4",leadingAvatarSize:"3xs",trailingIcon:"size-4"},md:{base:"px-2.5 py-1.5 text-sm gap-1.5",leading:"ps-2.5 inset-y-1.5",trailing:"pe-2.5 inset-y-1.5",leadingIcon:"size-5",leadingAvatarSize:"2xs",trailingIcon:"size-5"},lg:{base:"px-3 py-2 text-sm gap-2",leading:"ps-3 inset-y-2",trailing:"pe-3 inset-y-2",leadingIcon:"size-5",leadingAvatarSize:"2xs",trailingIcon:"size-5"},xl:{base:"px-3 py-2 text-base gap-2",leading:"ps-3 inset-y-2",trailing:"pe-3 inset-y-2",leadingIcon:"size-6",leadingAvatarSize:"xs",trailingIcon:"size-6"}},variant:{outline:"text-highlighted bg-default ring ring-inset ring-accented",soft:"text-highlighted bg-elevated/50 hover:bg-elevated focus:bg-elevated disabled:bg-elevated/50",subtle:"text-highlighted bg-elevated ring ring-inset ring-accented",ghost:"text-highlighted bg-transparent hover:bg-elevated focus:bg-elevated disabled:bg-transparent dark:disabled:bg-transparent",none:"text-highlighted bg-transparent"},color:{primary:"",secondary:"",success:"",info:"",warning:"",error:"",neutral:""},leading:{true:""},trailing:{true:""},loading:{true:""},highlight:{true:""},type:{file:"file:me-1.5 file:font-medium file:text-muted file:outline-none"},autoresize:{true:{base:"resize-none"}}},compoundVariants:[{color:"primary",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-primary"},{color:"secondary",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-secondary"},{color:"success",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-success"},{color:"info",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-info"},{color:"warning",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-warning"},{color:"error",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-error"},{color:"primary",highlight:!0,class:"ring ring-inset ring-primary"},{color:"secondary",highlight:!0,class:"ring ring-inset ring-secondary"},{color:"success",highlight:!0,class:"ring ring-inset ring-success"},{color:"info",highlight:!0,class:"ring ring-inset ring-info"},{color:"warning",highlight:!0,class:"ring ring-inset ring-warning"},{color:"error",highlight:!0,class:"ring ring-inset ring-error"},{color:"neutral",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-inverted"},{color:"neutral",highlight:!0,class:"ring ring-inset ring-inverted"},{leading:!0,size:"xs",class:"ps-7"},{leading:!0,size:"sm",class:"ps-8"},{leading:!0,size:"md",class:"ps-9"},{leading:!0,size:"lg",class:"ps-10"},{leading:!0,size:"xl",class:"ps-11"},{trailing:!0,size:"xs",class:"pe-7"},{trailing:!0,size:"sm",class:"pe-8"},{trailing:!0,size:"md",class:"pe-9"},{trailing:!0,size:"lg",class:"pe-10"},{trailing:!0,size:"xl",class:"pe-11"},{loading:!0,leading:!0,class:{leadingIcon:"animate-spin"}},{loading:!0,leading:!1,trailing:!0,class:{trailingIcon:"animate-spin"}}],defaultVariants:{size:"md",color:"primary",variant:"outline"}},Wt=["id","value","name","rows","placeholder","disabled","required"],Me=Object.assign({inheritAttrs:!1},{__name:"UTextarea",props:{as:{type:null,required:!1},id:{type:String,required:!1},name:{type:String,required:!1},placeholder:{type:String,required:!1},color:{type:null,required:!1},variant:{type:null,required:!1},size:{type:null,required:!1},required:{type:Boolean,required:!1},autofocus:{type:Boolean,required:!1},autofocusDelay:{type:Number,required:!1,default:0},autoresize:{type:Boolean,required:!1},autoresizeDelay:{type:Number,required:!1,default:0},disabled:{type:Boolean,required:!1},rows:{type:Number,required:!1,default:3},maxrows:{type:Number,required:!1,default:0},highlight:{type:Boolean,required:!1},modelValue:{type:null,required:!1},defaultValue:{type:null,required:!1},modelModifiers:{type:Object,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1},icon:{type:[String,Object],required:!1},avatar:{type:Object,required:!1},leading:{type:Boolean,required:!1},leadingIcon:{type:[String,Object],required:!1},trailing:{type:Boolean,required:!1},trailingIcon:{type:[String,Object],required:!1},loading:{type:Boolean,required:!1},loadingIcon:{type:[String,Object],required:!1}},emits:["update:modelValue","blur","change"],setup(t,{expose:b,emit:a}){const o=t,g=a,n=de(),m=st(o,"modelValue",g,{defaultValue:o.defaultValue}),c=ce(),{emitFormFocus:v,emitFormBlur:y,emitFormInput:x,emitFormChange:w,size:f,color:s,id:l,name:q,highlight:u,disabled:z,ariaAttrs:p}=Ue(o,{deferInputValidation:!0}),{isLeading:I,isTrailing:V,leadingIconName:O,trailingIconName:B}=lt(o),L=N(()=>Y({extend:Y(Jt),...c.ui?.textarea||{}})({color:s.value,variant:o.variant,size:f?.value,loading:o.loading,highlight:u.value,autoresize:o.autoresize,leading:I.value||!!o.avatar||!!n.leading,trailing:V.value||!!n.trailing})),E=U(null);function ie(S){o.modelModifiers?.trim&&(S=S?.trim()??null),o.modelModifiers?.number&&(S=it(S)),o.modelModifiers?.nullable&&(S||=null),o.modelModifiers?.optional&&(S||=void 0),m.value=S,x()}function ae(S){P(),o.modelModifiers?.lazy||ie(S.target.value)}function oe(S){const D=S.target.value;o.modelModifiers?.lazy&&ie(D),o.modelModifiers?.trim&&(S.target.value=D.trim()),w(),g("change",S)}function h(S){y(),g("blur",S)}function j(){o.autofocus&&E.value?.focus()}function P(){if(o.autoresize&&E.value){E.value.rows=o.rows;const S=E.value.style.overflow;E.value.style.overflow="hidden";const D=window.getComputedStyle(E.value),ne=Number.parseInt(D.paddingTop),ge=Number.parseInt(D.paddingBottom),pe=ne+ge,fe=Number.parseInt(D.lineHeight),{scrollHeight:Ee}=E.value,ve=(Ee-pe)/fe;ve>o.rows&&(E.value.rows=o.maxrows?Math.min(ve,o.maxrows):ve),E.value.style.overflow=S}}return te(m,()=>{rt(P)}),Le(()=>{setTimeout(()=>{j()},o.autofocusDelay),setTimeout(()=>{P()},o.autoresizeDelay)}),b({textareaRef:E}),(S,D)=>(r(),k(e(re),{as:t.as,class:C(L.value.root({class:[o.ui?.root,o.class]}))},{default:i(()=>[$("textarea",R({id:e(l),ref_key:"textareaRef",ref:E,value:e(m),name:e(q),rows:t.rows,placeholder:t.placeholder,class:L.value.base({class:o.ui?.base}),disabled:e(z),required:t.required},{...S.$attrs,...e(p)},{onInput:ae,onBlur:h,onChange:oe,onFocus:D[0]||(D[0]=(...ne)=>e(v)&&e(v)(...ne))}),null,16,Wt),M(S.$slots,"default"),e(I)||t.avatar||n.leading?(r(),_("span",{key:0,class:C(L.value.leading({class:o.ui?.leading}))},[M(S.$slots,"leading",{},()=>[e(I)&&e(O)?(r(),k(K,{key:0,name:e(O),class:C(L.value.leadingIcon({class:o.ui?.leadingIcon}))},null,8,["name","class"])):t.avatar?(r(),k(Be,R({key:1,size:o.ui?.leadingAvatarSize||L.value.leadingAvatarSize()},t.avatar,{class:L.value.leadingAvatar({class:o.ui?.leadingAvatar})}),null,16,["size","class"])):T("",!0)])],2)):T("",!0),e(V)||n.trailing?(r(),_("span",{key:1,class:C(L.value.trailing({class:o.ui?.trailing}))},[M(S.$slots,"trailing",{},()=>[e(B)?(r(),k(K,{key:0,name:e(B),class:C(L.value.trailingIcon({class:o.ui?.trailingIcon}))},null,8,["name","class"])):T("",!0)])],2)):T("",!0)]),_:3},8,["as","class"]))}}),Qt={slots:{root:"relative flex items-start",base:["inline-flex items-center shrink-0 rounded-full border-2 border-transparent focus-visible:outline-2 focus-visible:outline-offset-2 data-[state=unchecked]:bg-accented","transition-[background] duration-200"],container:"flex items-center",thumb:"group pointer-events-none rounded-full bg-default shadow-lg ring-0 transition-transform duration-200 data-[state=unchecked]:translate-x-0 data-[state=unchecked]:rtl:-translate-x-0 flex items-center justify-center",icon:["absolute shrink-0 group-data-[state=unchecked]:text-dimmed opacity-0 size-10/12","transition-[color,opacity] duration-200"],wrapper:"ms-2",label:"block font-medium text-default",description:"text-muted"},variants:{color:{primary:{base:"data-[state=checked]:bg-primary focus-visible:outline-primary",icon:"group-data-[state=checked]:text-primary"},secondary:{base:"data-[state=checked]:bg-secondary focus-visible:outline-secondary",icon:"group-data-[state=checked]:text-secondary"},success:{base:"data-[state=checked]:bg-success focus-visible:outline-success",icon:"group-data-[state=checked]:text-success"},info:{base:"data-[state=checked]:bg-info focus-visible:outline-info",icon:"group-data-[state=checked]:text-info"},warning:{base:"data-[state=checked]:bg-warning focus-visible:outline-warning",icon:"group-data-[state=checked]:text-warning"},error:{base:"data-[state=checked]:bg-error focus-visible:outline-error",icon:"group-data-[state=checked]:text-error"},neutral:{base:"data-[state=checked]:bg-inverted focus-visible:outline-inverted",icon:"group-data-[state=checked]:text-highlighted"}},size:{xs:{base:"w-7",container:"h-4",thumb:"size-3 data-[state=checked]:translate-x-3 data-[state=checked]:rtl:-translate-x-3",wrapper:"text-xs"},sm:{base:"w-8",container:"h-4",thumb:"size-3.5 data-[state=checked]:translate-x-3.5 data-[state=checked]:rtl:-translate-x-3.5",wrapper:"text-xs"},md:{base:"w-9",container:"h-5",thumb:"size-4 data-[state=checked]:translate-x-4 data-[state=checked]:rtl:-translate-x-4",wrapper:"text-sm"},lg:{base:"w-10",container:"h-5",thumb:"size-4.5 data-[state=checked]:translate-x-4.5 data-[state=checked]:rtl:-translate-x-4.5",wrapper:"text-sm"},xl:{base:"w-11",container:"h-6",thumb:"size-5 data-[state=checked]:translate-x-5 data-[state=checked]:rtl:-translate-x-5",wrapper:"text-base"}},checked:{true:{icon:"group-data-[state=checked]:opacity-100"}},unchecked:{true:{icon:"group-data-[state=unchecked]:opacity-100"}},loading:{true:{icon:"animate-spin"}},required:{true:{label:"after:content-['*'] after:ms-0.5 after:text-error"}},disabled:{true:{base:"cursor-not-allowed opacity-75",label:"cursor-not-allowed opacity-75",description:"cursor-not-allowed opacity-75"}}},defaultVariants:{color:"primary",size:"md"}},Fe=Object.assign({inheritAttrs:!1},{__name:"USwitch",props:J({as:{type:null,required:!1},color:{type:null,required:!1},size:{type:null,required:!1},loading:{type:Boolean,required:!1},loadingIcon:{type:[String,Object],required:!1},checkedIcon:{type:[String,Object],required:!1},uncheckedIcon:{type:[String,Object],required:!1},label:{type:String,required:!1},description:{type:String,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1},disabled:{type:Boolean,required:!1},id:{type:String,required:!1},name:{type:String,required:!1},required:{type:Boolean,required:!1},value:{type:String,required:!1},defaultValue:{type:Boolean,required:!1}},{modelValue:{type:Boolean,default:void 0},modelModifiers:{}}),emits:J(["change"],["update:modelValue"]),setup(t,{emit:b}){const a=t,o=de(),g=b,n=ee(t,"modelValue",{type:Boolean,default:void 0}),m=ce(),c=ut(Te(a,"required","value","defaultValue")),{id:v,emitFormChange:y,emitFormInput:x,size:w,color:f,name:s,disabled:l,ariaAttrs:q}=Ue(a),u=v.value??dt(),z=N(()=>Y({extend:Y(Qt),...m.ui?.switch||{}})({size:w.value,color:f.value,required:a.required,loading:a.loading,disabled:l.value||a.loading}));function p(I){const V=new Event("change",{target:{value:I}});g("change",V),y(),x()}return(I,V)=>(r(),k(e(re),{as:t.as,class:C(z.value.root({class:[a.ui?.root,a.class]}))},{default:i(()=>[$("div",{class:C(z.value.container({class:a.ui?.container}))},[d(e(Tt),R({id:e(u)},{...e(c),...I.$attrs,...e(q)},{modelValue:n.value,"onUpdate:modelValue":[V[0]||(V[0]=O=>n.value=O),p],name:e(s),disabled:e(l)||t.loading,class:z.value.base({class:a.ui?.base})}),{default:i(()=>[d(e(Ut),{class:C(z.value.thumb({class:a.ui?.thumb}))},{default:i(()=>[t.loading?(r(),k(K,{key:0,name:t.loadingIcon||e(m).ui.icons.loading,class:C(z.value.icon({class:a.ui?.icon,checked:!0,unchecked:!0}))},null,8,["name","class"])):(r(),_(H,{key:1},[t.checkedIcon?(r(),k(K,{key:0,name:t.checkedIcon,class:C(z.value.icon({class:a.ui?.icon,checked:!0}))},null,8,["name","class"])):T("",!0),t.uncheckedIcon?(r(),k(K,{key:1,name:t.uncheckedIcon,class:C(z.value.icon({class:a.ui?.icon,unchecked:!0}))},null,8,["name","class"])):T("",!0)],64))]),_:1},8,["class"])]),_:1},16,["id","modelValue","name","disabled","class"])],2),t.label||o.label||t.description||o.description?(r(),_("div",{key:0,class:C(z.value.wrapper({class:a.ui?.wrapper}))},[t.label||o.label?(r(),k(e(ct),{key:0,for:e(u),class:C(z.value.label({class:a.ui?.label}))},{default:i(()=>[M(I.$slots,"label",{label:t.label},()=>[F(A(t.label),1)])]),_:3},8,["for","class"])):T("",!0),t.description||o.description?(r(),_("p",{key:1,class:C(z.value.description({class:a.ui?.description}))},[M(I.$slots,"description",{description:t.description},()=>[F(A(t.description),1)])],2)):T("",!0)],2)):T("",!0)]),_:3},8,["as","class"]))}}),Zt=W({__name:"NoteCreateDrawer",props:J({note:{default:null},verse:{},book:{}},{open:{type:Boolean,default:!1},openModifiers:{}}),emits:J(["close","created","updated"],["update:open"]),setup(t,{emit:b}){const a=b,o=ee(t,"open"),g=U(!1),n=xe({title:t.note?.title??"",content:t.note?.content??"",isPrivate:t.note?.isPrivate??!0}),m=U(!1),c=U(""),v=ue();function y(){o.value=!1,a("close")}async function x(){c.value="",m.value=!0;try{let f=null;g.value&&t.note?f=await $fetch(`/api/bible/notes/${t.note.id}`,{method:"PUT",body:{title:n.title,content:n.content,isPrivate:n.isPrivate}}):f=await $fetch("/api/bible/notes",{method:"POST",body:{verseId:t.verse.id,title:n.title,content:n.content,isPrivate:n.isPrivate}}),f.success?(v.add({title:g.value?"Note modifiée":"Note ajoutée",description:f.message,color:"primary"}),g.value?a("updated",f.note):a("created",f.note),y()):c.value=f.message||"Erreur inconnue"}catch(f){c.value=f?.statusMessage||"Erreur lors de l’enregistrement de la note"}finally{m.value=!1}}const w=N(()=>`${t.book.name} ${t.verse.chapter}:${t.verse.verse}`);return te(()=>t.note,f=>{f?(n.title=f.title??"",n.content=f.content??"",n.isPrivate=f.isPrivate??!0,g.value=!0):(n.title="",n.content="",n.isPrivate=!0,g.value=!1)}),(f,s)=>{const l=qe,q=Me,u=Fe,z=Z,p=_e;return r(),k(p,{open:o.value,"onUpdate:open":s[3]||(s[3]=I=>o.value=I),dismissible:!1,title:"Ajouter une note",description:e(w),ui:{footer:"justify-end",body:"flex flex-col justify-between gap-4"}},{body:i(()=>[d(l,{modelValue:e(n).title,"onUpdate:modelValue":s[0]||(s[0]=I=>e(n).title=I),placeholder:"Titre..."},null,8,["modelValue"]),d(q,{modelValue:e(n).content,"onUpdate:modelValue":s[1]||(s[1]=I=>e(n).content=I),placeholder:"Contenu...",class:"flex-1 h-full",ui:{base:"h-full"},autoresize:""},null,8,["modelValue"]),d(u,{modelValue:e(n).isPrivate,"onUpdate:modelValue":s[2]||(s[2]=I=>e(n).isPrivate=I),label:"Visible uniquement par moi"},null,8,["modelValue"])]),footer:i(({close:I})=>[d(z,{label:"Annuler",color:"neutral",variant:"outline",onClick:I},null,8,["onClick"]),d(z,{label:"Enregistrer",color:"neutral",onClick:x})]),_:1},8,["open","description"])}}}),Xt=Object.assign(Zt,{__name:"NoteCreateDrawer"}),Yt={class:"inline-block align-top text-xs text-primary-600 dark:text-primary-400"},ea={class:"flex items-center justify-between gap-2"},ta=W({__name:"BibleVerse",props:{book:{},verse:{},notes:{},bookmark:{}},emits:["showCompare","addNote","refreshBookmark"],setup(t,{emit:b}){const a=t,o=b,g=U(!1),n=U(!1),m=ue(),c=U(!1),v=U(!1),{loggedIn:y}=Oe(),x=N(()=>{const s=[{label:"Comparer",icon:"i-lucide-eye",onSelect:()=>o("showCompare",a.verse.verse),ui:{item:"cursor-pointer"}}];return y.value&&(s.push({label:"Marquer",icon:"i-lucide-bookmark",onSelect:()=>n.value=!0,ui:{item:"cursor-pointer"}}),s.push({label:"Ajouter Note",icon:"i-lucide-notebook-pen",onSelect:()=>v.value=!0,ui:{item:"cursor-pointer"}})),s}),w=async()=>{if(a.bookmark)try{await $fetch(`/api/bible/bookmarks/${a.bookmark.id}`,{method:"DELETE"}),m.add({title:"Signet supprimé",description:"Le signet a été supprimer avec succès"}),o("refreshBookmark")}catch(s){console.log(s)}},f=U(null);return(s,l)=>{const q=K,u=Z,z=me,p=mt,I=Nt,V=jt,O=Ht,B=Xt;return r(),_(H,null,[d(V,{items:e(x)},{default:i(()=>[$("span",null,[e(y)&&s.notes.length?(r(),_("button",{key:0,class:"cursor-pointer mr-0.5",onClick:l[0]||(l[0]=L=>c.value=!0)},[d(q,{name:"i-lucide-notebook-pen",class:"size-3 text-warning-500 dark:text-warning-400"})])):T("",!0),$("span",Yt,A(s.verse.verse),1),d(p,{open:e(n),"onUpdate:open":l[5]||(l[5]=L=>le(n)?n.value=L:null),content:{sideOffset:0},arrow:""},{anchor:i(()=>[$("span",{class:C({underline:e(n)||s.bookmark})},[s.bookmark?(r(),k(p,{key:1,mode:"hover",arrow:"","onUpdate:open":l[2]||(l[2]=L=>!L&&(g.value=!1))},X({default:i(()=>[$("span",{class:C(["decoration-2",{underline:e(n)||s.bookmark}]),style:$e(`text-decoration-color: var(--color-${s.bookmark?.color}-500)`)},A(s.verse.text),7)]),_:2},[s.bookmark.title?{name:"content",fn:i(()=>[d(z,{ui:{header:"p-2 sm:px-4",footer:"p-2 sm:px-4 flex items-center space-x-4"}},X({header:i(()=>[$("div",ea,[$("p",null,A(s.bookmark.title),1),$("span",{class:"cursor-pointer rounded-sm bg-gray-50 hover:bg-red-50 flex items-center justify-center p-1 text-red-500 hover:text-red-700",onClick:l[1]||(l[1]=L=>g.value=!0)},[d(q,{name:"i-lucide-trash-2"})])])]),_:2},[e(g)?{name:"footer",fn:i(()=>[d(u,{size:"sm",color:"error",onClick:w},{default:i(()=>[...l[8]||(l[8]=[F(" Supprimer ",-1)])]),_:1}),d(u,{size:"sm",variant:"outline",color:"neutral"},{default:i(()=>[...l[9]||(l[9]=[F(" Annuler ",-1)])]),_:1})]),key:"0"}:void 0]),1024)]),key:"0"}:void 0]),1024)):(r(),_(H,{key:0},[F(A(s.verse.text),1)],64))],2)]),content:i(()=>[d(I,{"verse-id":s.verse.id,onCloseForm:l[3]||(l[3]=L=>n.value=!1),onCreated:l[4]||(l[4]=L=>o("refreshBookmark"))},null,8,["verse-id"])]),_:1},8,["open"])])]),_:1},8,["items"]),d(O,{open:e(c),"onUpdate:open":l[6]||(l[6]=L=>le(c)?c.value=L:null),notes:s.notes},null,8,["open","notes"]),d(B,{open:e(v),"onUpdate:open":l[7]||(l[7]=L=>le(v)?v.value=L:null),verse:s.verse,book:s.book,note:e(f)},null,8,["open","verse","book","note"])],64)}}}),aa=Object.assign(ta,{__name:"BibleVerse"}),oa={class:"p-6"},na={class:"space-y-4"},sa={class:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg"},la={class:"font-medium"},ia={key:0},ra={class:"grid grid-cols-1 sm:grid-cols-2 gap-4 max-h-60 overflow-y-auto"},ua=["onClick"],da={class:"text-sm font-medium text-gray-900 dark:text-white"},ca={class:"text-xs text-gray-500 dark:text-gray-400"},ma={class:"mt-2 text-xs text-gray-500"},ga={class:"flex justify-end gap-2 mt-6"},pa=W({__name:"BibleCompareModal",props:J({availableVersions:{},book:{},chapter:{},version:{},verseStart:{},verseEnd:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const b=t,a=ee(t,"modelValue"),o=U(!1),g=U([b.version]),n=c=>{const v=g.value.indexOf(c);v>-1?g.value.splice(v,1):g.value.length<6&&g.value.push(c)},m=async()=>{if(!(g.value.length<2))try{o.value=!0;const c=b.availableVersions.filter(y=>g.value.includes(y.id)).map(y=>y.code),v=new URLSearchParams({book:b.book.code,chapter:b.chapter.toString(),verses:b.verseStart.toString(),versions:c.join(",")});b.verseEnd&&b.verseEnd!==b.verseStart&&v.set("verses",b.verseStart.toString()+"-"+b.verseEnd.toString()),await gt(`/bible/compare?${v.toString()}`)}catch(c){console.error("Erreur lors de la comparaison:",c)}finally{o.value=!1,a.value=!1}};return te(()=>b.version,c=>{g.value=[c]}),(c,v)=>{const y=$t,x=we,w=Z,f=Pe;return r(),k(f,{open:a.value,"onUpdate:open":v[1]||(v[1]=s=>a.value=s),title:"Comparer ce passage",description:"Terme théologique",ui:{description:"hidden",content:"max-w-2xl"}},{content:i(()=>[$("div",oa,[$("div",na,[$("div",null,[v[2]||(v[2]=$("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-2"}," Passage sélectionné : ",-1)),$("div",sa,[$("p",la,[F(A(c.book.name)+" "+A(c.chapter)+":"+A(c.verseStart)+" ",1),c.verseEnd&&c.verseEnd!==c.verseStart?(r(),_("span",ia," -"+A(c.verseEnd),1)):T("",!0)])])]),d(x,{label:"Versions à comparer (sélectionnez 2 à 6 versions)"},{default:i(()=>[$("div",ra,[(r(!0),_(H,null,Q(c.availableVersions,s=>(r(),_("div",{key:s.id,class:"flex items-center space-x-2"},[d(y,{"model-value":e(g).includes(s.id),disabled:e(g).length>=6&&!e(g).includes(s.id),"onUpdate:modelValue":l=>n(s.id)},null,8,["model-value","disabled","onUpdate:modelValue"]),$("div",{class:"flex-1",onClick:l=>n(s.id)},[$("div",da,A(s.name),1),$("div",ca,A(s.code)+" • "+A(s.language),1)],8,ua)]))),128))]),$("div",ma,A(e(g).length)+" version(s) sélectionnée(s) (minimum 2, maximum 6) ",1)]),_:1})]),$("div",ga,[d(w,{label:"Annuler",variant:"ghost",onClick:v[0]||(v[0]=s=>a.value=!1)}),d(w,{label:"Comparer",disabled:e(g).length<2,loading:e(o),onClick:m},null,8,["disabled","loading"])])])]),_:1},8,["open"])}}}),fa=Object.assign(pa,{__name:"BibleCompareModal"}),va={class:"flex items-center gap-2"},ba={class:"font-semibold text-lg"},ha={key:0,class:"text-red-500 text-sm mt-2"},ya={class:"w-full flex justify-end gap-2"},ka=W({__name:"BibleNoteFormModal",props:J({verseId:{},note:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:J(["close","created","updated"],["update:modelValue"]),setup(t,{emit:b}){const a=t,o=b,g=ee(t,"modelValue"),n=U(!!a.note),m=xe({title:a.note?.title??"",content:a.note?.content??"",isPrivate:a.note?.isPrivate??!0});te(()=>a.note,f=>{f?(m.title=f.title??"",m.content=f.content??"",m.isPrivate=f.isPrivate??!0,n.value=!0):(m.title="",m.content="",m.isPrivate=!0,n.value=!1)});const c=U(!1),v=U(""),y=ue();function x(){g.value=!1,o("close")}async function w(){v.value="",c.value=!0;try{let f=null;n.value&&a.note?f=await $fetch(`/api/bible/notes/${a.note.id}`,{method:"PUT",body:{title:m.title,content:m.content,isPrivate:m.isPrivate}}):f=await $fetch("/api/bible/notes",{method:"POST",body:{verseId:a.verseId,title:m.title,content:m.content,isPrivate:m.isPrivate}}),f.success?(y.add({title:n.value?"Note modifiée":"Note ajoutée",description:f.message,color:"primary"}),n.value?o("updated",f.note):o("created",f.note),x()):v.value=f.message||"Erreur inconnue"}catch(f){v.value=f?.statusMessage||"Erreur lors de l’enregistrement de la note"}finally{c.value=!1}}return(f,s)=>{const l=K,q=qe,u=we,z=Me,p=Fe,I=Z,V=Pe,O=Ae;return r(),k(O,{state:m},{default:i(()=>[d(V,{open:g.value,"onUpdate:open":s[3]||(s[3]=B=>g.value=B),overlay:!0,ui:{content:"max-w-lg"}},{header:i(()=>[$("div",va,[d(l,{name:"i-lucide-pencil",class:"text-primary-600"}),$("span",ba,A(n.value?"Modifier la note":"Ajouter une note"),1)])]),body:i(()=>[d(u,{label:"Titre (optionnel)",name:"title"},{default:i(()=>[d(q,{modelValue:m.title,"onUpdate:modelValue":s[0]||(s[0]=B=>m.title=B),placeholder:"Titre de la note...",class:"w-full"},null,8,["modelValue"])]),_:1}),d(u,{label:"Contenu",name:"content",class:"mt-4",required:""},{default:i(()=>[d(z,{modelValue:m.content,"onUpdate:modelValue":s[1]||(s[1]=B=>m.content=B),placeholder:"Votre note...",class:"w-full",rows:5},null,8,["modelValue"])]),_:1}),d(u,{label:"Note privée",name:"isPrivate",class:"mt-4"},{default:i(()=>[d(p,{modelValue:m.isPrivate,"onUpdate:modelValue":s[2]||(s[2]=B=>m.isPrivate=B),label:"Visible uniquement par moi"},null,8,["modelValue"])]),_:1}),v.value?(r(),_("div",ha,A(v.value),1)):T("",!0)]),footer:i(()=>[$("div",ya,[d(I,{color:"secondary",variant:"ghost",onClick:x},{default:i(()=>[...s[4]||(s[4]=[F(" Annuler ",-1)])]),_:1}),d(I,{type:"submit",color:"primary",loading:c.value,onClick:w},{default:i(()=>[F(A(n.value?"Enregistrer":"Ajouter"),1)]),_:1},8,["loading"])])]),_:1},8,["open"])]),_:1},8,["state"])}}}),xa=Object.assign(ka,{__name:"BibleNoteFormModal"}),wa={class:"space-y-6"},qa={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-2"},Ia={class:"flex flex-1 items-center gap-2"},Sa={class:"space-x-1"},$a={class:"flex justify-center gap-2"},za=W({__name:"BibleReader",props:{book:{},chapter:{},versesData:{},notes:{},bookmarks:{},versions:{},selectedVersion:{}},emits:["update:chapter","refreshBookmark","refreshNotes"],setup(t,{emit:b}){const a=t,o=l=>{g.value={book:{code:a.book.code,name:a.book.name},verseStart:l,chapter:a.chapter,version:a.selectedVersion.id},m.value=!0},g=U(null),n=l=>{g.value={book:{code:a.book.code,name:a.book.name},verseStart:l,chapter:a.chapter,version:a.selectedVersion.id},c.value=!0},m=U(!1),c=U(!1),v=b,y=N(()=>Array.from({length:a.versesData?.navigation.totalChapters||0},(l,q)=>q+1)),x=l=>a.notes.filter(q=>q.verse.verse===l)||[],w=l=>a.bookmarks.find(q=>q.verse.verse===l)||null,f=N(()=>a.versesData?.verses||[]),s=l=>{v("update:chapter",l)};return(l,q)=>{const u=Ne,z=Z,p=aa,I=me,V=fa,O=xa;return r(),_("div",wa,[d(I,{class:"mb-4"},{header:i(()=>[$("div",qa,[$("div",Ia,[q[6]||(q[6]=$("p",null,"Chapitre",-1)),d(u,{items:y.value,"model-value":l.chapter,placeholder:"Chapitre",class:"w-32","onUpdate:modelValue":s},null,8,["items","model-value"])]),d(z,{color:"secondary",variant:"ghost",to:"/bible/compare","trailing-icon":"i-lucide-chevron-right"},{default:i(()=>[...q[7]||(q[7]=[F(" Comparer ",-1)])]),_:1})])]),footer:i(()=>[$("div",$a,[l.versesData?.navigation.previousChapter?(r(),k(z,{key:0,icon:"i-lucide-arrow-left",color:"primary",variant:"soft",onClick:q[1]||(q[1]=B=>s(l.versesData.navigation.previousChapter))},{default:i(()=>[...q[8]||(q[8]=[F(" Précédent ",-1)])]),_:1})):T("",!0),l.versesData?.navigation.nextChapter?(r(),k(z,{key:1,"trailing-icon":"i-lucide-arrow-right",color:"primary",variant:"soft",onClick:q[2]||(q[2]=B=>s(l.versesData.navigation.nextChapter))},{default:i(()=>[...q[9]||(q[9]=[F(" Suivant ",-1)])]),_:1})):T("",!0)])]),default:i(()=>[$("div",Sa,[(r(!0),_(H,null,Q(f.value,B=>(r(),k(p,{key:B.id,book:l.book,verse:B,notes:x(B.verse),bookmark:w(B.verse),onShowCompare:o,onAddNote:n,onRefreshBookmark:q[0]||(q[0]=L=>v("refreshBookmark"))},null,8,["book","verse","notes","bookmark"]))),128))])]),_:1}),e(g)?(r(),k(V,R({key:0,modelValue:e(m),"onUpdate:modelValue":q[3]||(q[3]=B=>le(m)?m.value=B:null)},e(g),{"available-versions":l.versions}),null,16,["modelValue","available-versions"])):T("",!0),e(g)?(r(),k(O,{key:1,modelValue:e(c),"onUpdate:modelValue":q[4]||(q[4]=B=>le(c)?c.value=B:null),"verse-id":e(g).verseStart,onCreated:q[5]||(q[5]=B=>v("refreshNotes"))},null,8,["modelValue","verse-id"])):T("",!0)])}}}),Ca=Object.assign(za,{__name:"BibleReader"}),Ma=W({__name:"index",async setup(t){let b,a;const o=pt(),{data:g}=([b,a]=be(()=>he("bible-books",()=>$fetch("/api/bible/books"),{transform:h=>h?.data||[]})),b=await b,a(),b),{data:n}=([b,a]=be(()=>he("bible-versions",()=>$fetch("/api/bible/versions"),{transform:h=>h?.data||[]})),b=await b,a(),b),{data:m}=([b,a]=be(()=>he("bible-verses",()=>$fetch(`/api/bible/verses/${o.query.book||"GEN"}/${o.query.chapter||"1"}`,{query:{version:o.query.version||"LSG"}}),{watch:[()=>o.query],transform:h=>h?.data||[]})),b=await b,a(),b),{loggedIn:c}=Oe(),v=ft(),y=N({get:()=>o.query.book||"GEN",set:h=>{v.push({query:{...o.query,book:h}})}}),x=N({get:()=>parseInt(o.query.chapter||"1"),set:h=>{v.push({query:{...o.query,chapter:h}})}}),w=N({get:()=>o.query.version||"LSG",set:h=>{v.push({query:{...o.query,version:h}})}}),f=N(()=>g.value?.all||[]),s=U(null),l=U([]),q=U([]),u=U([]),z=N(()=>{const h=g.value?.grouped||{old:[],new:[]},j=h.old,P=h.new;return[{label:"Ancien Testament",open:j.some(S=>S.code===y.value),active:j.some(S=>S.code===y.value),ui:{link:"cursor-pointer"},children:j.map(S=>({label:S.name,onSelect:async()=>await O(S.code),active:y.value===S.code,ui:{link:"cursor-pointer"}}))},{label:"Nouveau Testament",open:P.some(S=>S.code===y.value),active:P.some(S=>S.code===y.value),ui:{link:"cursor-pointer"},children:P.map(S=>({label:S.name,onSelect:async()=>await O(S.code),active:y.value===S.code,ui:{link:"cursor-pointer"}}))}]}),p=N(()=>n.value?n.value.map(h=>({label:h.name,to:v.resolve({query:{...o.query,version:h.code}}).href,active:w.value===h.code})):[]),I=N(()=>!f.value||!y.value?null:f.value.find(h=>h.code==y.value)),V=N(()=>!n.value||!w.value?null:n.value.find(h=>h.code==w.value)),O=async h=>{await v.push({query:{...o.query,book:h,chapter:1}})},B=(h,j)=>{if(!l.value)return;const P=l.value.find(S=>S.bookCode===h);P?P.chaptersId.includes(j)||P.chaptersId.push(j):l.value.push({bookCode:h,chaptersId:[j]})},L=async h=>{await v.push({query:{...o.query,chapter:h}}),c&&y.value&&B(y.value,h)};vt({title:"Lire la Bible en ligne - Théologie Pour Tous",ogTitle:"Lire la Bible en ligne - Théologie Pour Tous",description:"Lisez la Bible en ligne avec différentes versions disponibles. Parcourez les livres et chapitres de la Bible facilement.",ogDescription:"Lisez la Bible en ligne avec différentes versions disponibles. Parcourez les livres et chapitres de la Bible facilement."});const E=async()=>{if(!(!c||!V.value||!n.value))try{const h=n.value.find(P=>P.code===w.value)?.id;if(!h)return;const j=await $fetch("/api/reading/sessions",{method:"POST",body:{action:"start",versionId:h,chaptersRead:JSON.stringify([{bookCode:y.value,chaptersId:x.value?[x.value]:[]}])}});if(j.success&&j.sessionId){const P=[{bookCode:y.value,chaptersId:x.value?[x.value]:[]}];s.value={id:j.sessionId,chaptersRead:P},l.value=P}}catch(h){console.error("Erreur lors du démarrage de la session:",h)}},ie=async()=>{if(!(!c||!s.value))try{await $fetch("/api/reading/sessions",{method:"POST",body:{action:"end",sessionId:s.value.id,chaptersRead:JSON.stringify(l.value)}})}catch(h){console.error("Erreur lors de la fermeture de la session:",h)}};Le(async()=>{c&&(await E(),await ae(),await oe())}),bt(async()=>{c&&await ie()});const ae=async()=>{if(!(!w.value||!y.value||!x.value))try{const h=await $fetch("/api/bible/notes",{method:"GET",query:{book:y.value,chapter:x.value}});q.value=h?.data.notes||[]}catch(h){console.error("Erreur lors du chargement des notes:",h)}},oe=async()=>{if(!(!V.value||!y.value||!x.value))try{const h=await $fetch("/api/bible/bookmarks",{method:"GET",query:{book:y.value,chapter:x.value}});u.value=h?.data.bookmarks||[]}catch(h){console.error("Erreur lors du chargement des signets:",h)}};return te([()=>o.query.chapter,()=>o.query.book],async()=>{await ae(),await oe()}),zt(),(h,j)=>{const P=yt,S=xt,D=wt,ne=Ca,ge=kt,pe=qt,fe=ht;return r(),k(fe,null,X({left:i(()=>[d(S,null,{top:i(()=>[...j[0]||(j[0]=[F(" Les livres ",-1)])]),default:i(()=>[e(f)?.length?(r(),k(P,{key:0,items:e(z),highlight:"",orientation:"vertical"},null,8,["items"])):T("",!0)]),_:1})]),default:i(()=>[e(I)&&e(x)?(r(),k(D,{key:0,title:`${e(I).name} ${e(x)}`,description:e(V)?e(V).name:"Aucune version sélectionnée"},null,8,["title","description"])):T("",!0),d(pe,null,{default:i(()=>[$("div",null,[e(I)&&e(x)&&e(V)&&e(m)?(r(),k(ne,{key:0,book:e(I),chapter:e(x),"verses-data":e(m),versions:e(n)||[],"selected-version":e(V),notes:e(q),bookmarks:e(u),"onUpdate:chapter":L,onRefreshBookmark:oe,onRefreshNotes:ae},null,8,["book","chapter","verses-data","versions","selected-version","notes","bookmarks"])):T("",!0)]),d(ge)]),_:1})]),_:2},[e(n)?.length?{name:"right",fn:i(()=>[d(S,null,{top:i(()=>[...j[1]||(j[1]=[F(" Versions disponibles ",-1)])]),default:i(()=>[d(P,{items:e(p),variant:"link",orientation:"vertical"},null,8,["items"])]),_:1})]),key:"0"}:void 0]),1024)}}});export{Ma as default};
