import{B as Z,r as y,d as f,e as u,g as a,w as i,f as j,h as s,G as e,aC as J,I as U,n as T,F as E,H as L,z as H,t as g,L as K,Z as W,M as N,aI as de,_ as ce,D as ue,V as G,o as me,P as ve,Q as pe,au as ge,aE as be}from"#entry";import{_ as fe}from"./DTIFCxQf.js";import{_ as _e,a as ye}from"./BiYaFSpO.js";import{_ as X}from"./Crun2bm4.js";import{_ as Y}from"./1wnohwRh.js";import{_ as ee}from"./sIOFFvLP.js";import"./CtvJZuv0.js";import"./DZ0GdWr0.js";const ke={class:"bible-comparison"},he={class:"flex items-center justify-between"},xe={class:"text-xl font-bold text-gray-900 dark:text-white"},$e={key:0},Ce={class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},Ve={class:"flex gap-2"},we={key:0,class:"mb-6 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg"},Ue={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Be={class:"flex items-center gap-2 pt-6"},ze={class:"sticky top-0 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700 pb-2 mb-4 z-10"},Re={class:"flex items-center justify-between"},je={class:"font-semibold text-gray-900 dark:text-white"},Ae={class:"text-xs text-gray-500 dark:text-gray-400"},Se={class:"verses-container space-y-3"},Me={class:"flex items-start gap-2"},Ne={key:0,class:"verse-number flex-shrink-0 text-xs font-medium text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded-md min-w-[2rem] text-center"},Ee={class:"verse-actions opacity-0 group-hover:opacity-100 transition-opacity mt-2 flex gap-2"},Le={key:0,class:"text-center py-8 text-gray-500 dark:text-gray-400"},Fe={class:"flex items-center justify-between"},Oe={class:"flex gap-2"},Pe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Te=["onClick"],De={class:"font-medium"},Ie={class:"text-sm text-gray-500"},qe=Z({__name:"BibleComparison",props:{book:{},chapter:{},verseRange:{},comparisons:{},availableVersions:{default:()=>[]}},emits:["close","addVersion","removeVersion","addBookmark","addNote"],setup(Q,{emit:B}){const w=B,v=Q,x=y(!1),k=y(!1),b=y("side-by-side"),h=y("normal"),V=y(!0),m=[{label:"Côte à côte",value:"side-by-side"},{label:"Vertical",value:"vertical"},{label:"Horizontal",value:"horizontal"}],A=[{label:"Petit",value:"small"},{label:"Normal",value:"normal"},{label:"Grand",value:"large"},{label:"Très grand",value:"extra-large"}],c=n=>{v.comparisons.length<6&&(w("addVersion",n),k.value=!1)},F=n=>{w("removeVersion",n)},O=n=>{w("addBookmark",n)},P=n=>{w("addNote",n)},D=async(n,r)=>{const _=`${v.book.name} ${v.chapter}:${n.verse} (${r.code})
"${n.text}"`;try{await navigator.clipboard.writeText(_)}catch($){console.error("Erreur lors de la copie:",$)}},I=()=>{const n=v.comparisons.map(z=>{const S=z.verses.map(o=>`${o.verse}. ${o.text}`).join(`
`);return`${z.version.name} (${z.version.code})
${S}`}).join(`

---

`),r=`${v.book.name} ${v.chapter}:${v.verseRange.start}${v.verseRange.end>v.verseRange.start?`-${v.verseRange.end}`:""}

${n}`,_=new Blob([r],{type:"text/plain"}),$=URL.createObjectURL(_),C=document.createElement("a");C.href=$,C.download=`${v.book.code}_${v.chapter}_${v.verseRange.start}-${v.verseRange.end}_comparison.txt`,document.body.appendChild(C),C.click(),document.body.removeChild(C),URL.revokeObjectURL($)};return(n,r)=>{const _=K,$=X,C=J,z=Y,S=W,o=ee,t=de;return u(),f("div",ke,[a(o,null,{header:i(()=>[s("div",he,[s("div",null,[s("h2",xe,[N(" Comparaison : "+g(n.book.name)+" "+g(n.chapter)+":"+g(n.verseRange.start)+" ",1),n.verseRange.end>n.verseRange.start?(u(),f("span",$e,"-"+g(n.verseRange.end),1)):j("",!0)]),s("p",Ce,g(n.comparisons.length)+" versions côte à côte ",1)]),s("div",Ve,[a(_,{icon:"i-lucide-settings",variant:"ghost",size:"sm",onClick:r[0]||(r[0]=l=>x.value=!e(x))}),a(_,{icon:"i-lucide-x",variant:"ghost",size:"sm",onClick:r[1]||(r[1]=l=>n.$emit("close"))})])])]),footer:i(()=>[s("div",Fe,[s("div",Oe,[a(_,{disabled:n.comparisons.length>=6,icon:"i-lucide-plus",label:"Ajouter version",variant:"outline",size:"sm",onClick:r[5]||(r[5]=l=>k.value=!0)},null,8,["disabled"]),a(_,{icon:"i-lucide-download",label:"Exporter",variant:"outline",size:"sm",onClick:I})]),r[10]||(r[10]=s("div",{class:"text-xs text-gray-500 dark:text-gray-400"}," Maximum 6 versions simultanées ",-1))])]),default:i(()=>[e(x)?(u(),f("div",we,[r[8]||(r[8]=s("h3",{class:"font-medium text-gray-900 dark:text-white mb-3"}," Options d'affichage ",-1)),s("div",Ue,[a(C,{label:"Layout"},{default:i(()=>[a($,{modelValue:e(b),"onUpdate:modelValue":r[2]||(r[2]=l=>U(b)?b.value=l:null),items:m,"label-key":"label","value-key":"value"},null,8,["modelValue"])]),_:1}),a(C,{label:"Taille du texte"},{default:i(()=>[a($,{modelValue:e(h),"onUpdate:modelValue":r[3]||(r[3]=l=>U(h)?h.value=l:null),items:A,"label-key":"label","value-key":"value"},null,8,["modelValue"])]),_:1}),s("div",Be,[a(z,{modelValue:e(V),"onUpdate:modelValue":r[4]||(r[4]=l=>U(V)?V.value=l:null),label:"Numéros de versets"},null,8,["modelValue"])])])])):j("",!0),s("div",{class:T(["comparison-grid gap-4",{"grid-cols-1":e(b)==="vertical","grid-cols-2":e(b)==="side-by-side"&&n.comparisons.length===2,"grid-cols-3":e(b)==="side-by-side"&&n.comparisons.length===3,"grid-cols-2 lg:grid-cols-4":e(b)==="side-by-side"&&n.comparisons.length===4,"grid-cols-2 lg:grid-cols-3":e(b)==="side-by-side"&&n.comparisons.length>=5,"comparison-horizontal":e(b)==="horizontal"}])},[(u(!0),f(E,null,L(n.comparisons,l=>(u(),f("div",{key:l.version.id,class:"version-column"},[s("div",ze,[s("div",Re,[s("div",null,[s("h3",je,g(l.version.name),1),s("p",Ae,g(l.version.code)+" • "+g(l.version.language),1)]),n.comparisons.length>2?(u(),H(_,{key:0,icon:"i-lucide-x",variant:"ghost",size:"xs",onClick:p=>F(l.version.id)},null,8,["onClick"])):j("",!0)])]),s("div",Se,[(u(!0),f(E,null,L(l.verses,p=>(u(),f("div",{key:`${l.version.id}-${p.id}`,class:T(["verse-item",e(h)])},[s("div",Me,[e(V)?(u(),f("span",Ne,g(p.verse),1)):j("",!0),s("p",{class:T(["verse-text leading-relaxed text-gray-800 dark:text-gray-200",{"text-sm":e(h)==="small","text-base":e(h)==="normal","text-lg":e(h)==="large","text-xl":e(h)==="extra-large"}])},g(p.text),3)]),s("div",Ee,[a(_,{title:"Ajouter aux favoris",icon:"i-lucide-bookmark",variant:"ghost",size:"xs",onClick:R=>O(p)},null,8,["onClick"]),a(_,{title:"Ajouter une note",icon:"i-lucide-sticky-note",variant:"ghost",size:"xs",onClick:R=>P(p)},null,8,["onClick"]),a(_,{title:"Copier le verset",icon:"i-lucide-copy",variant:"ghost",size:"xs",onClick:R=>D(p,l.version)},null,8,["onClick"])])],2))),128))]),l.verses.length===0?(u(),f("div",Le,[a(S,{name:"i-lucide-book-x",class:"w-8 h-8 mx-auto mb-2"}),r[9]||(r[9]=s("p",null," Aucun verset trouvé pour cette version ",-1))])):j("",!0)]))),128))],2)]),_:1}),a(t,{open:e(k),"onUpdate:open":r[7]||(r[7]=l=>U(k)?k.value=l:null),title:"Ajouter une version",description:"Sélectionnez une version à ajouter à la comparaison"},{body:i(()=>[s("div",Pe,[(u(!0),f(E,null,L(n.availableVersions,l=>(u(),f("div",{key:l.id,class:"p-3 border border-gray-200 dark:border-gray-700 rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800",onClick:p=>c(l)},[s("div",De,g(l.name),1),s("div",Ie,g(l.code)+" • "+g(l.language),1)],8,Te))),128))])]),footer:i(()=>[a(_,{label:"Annuler",variant:"ghost",onClick:r[6]||(r[6]=l=>k.value=!1)})]),_:1},8,["open"])])}}}),Ge=Object.assign(ce(qe,[["__scopeId","data-v-8c78fd92"]]),{__name:"BibleComparison"}),He={key:0,class:"border-t dark:border-gray-800 pt-4"},Qe={class:"space-y-1"},Ze={class:"truncate"},Je={class:"font-medium"},Ke={class:"text-xs text-gray-500 dark:text-gray-400 ml-1"},We={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Xe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ye={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},eo=["onClick"],oo={class:"flex items-center gap-3"},so={class:"font-medium text-gray-900 dark:text-white"},to={class:"text-xs text-gray-500 dark:text-gray-400"},ao={class:"flex items-center justify-between pt-4"},lo={key:1},go=Z({__name:"compare",setup(Q){ue({title:"Comparaison de versions bibliques",ogTitle:"Comparaison de versions bibliques",description:"Comparez différentes versions de la Bible",ogDescription:"Comparez différentes versions de la Bible"});const B=y([]),w=y(!1),v=y(!1),x=y(""),k=y(void 0),b=y(null),h=y(1),V=y(null),m=y([]),A=y([]),c=y(null),F=G(()=>A.value.find(o=>o.id===k.value)),O=G(()=>k.value&&b.value&&h.value&&m.value.length>=2&&m.value.length<=6),P=G(()=>B.value.filter(o=>!c.value?.comparisons.some(t=>t.version.id===o.id)));me(async()=>{if(await Promise.all([I(),n()]),B.value.length>0){const o=B.value.filter(t=>["LSG","S21"].includes(t.code)).map(t=>t.id);o.length>=2&&(m.value=o)}});const D=(o,t)=>{t===!0?m.value.includes(o)||m.value.push(o):m.value=m.value.filter(p=>p!==o)},I=async()=>{try{v.value=!0;const o=await $fetch("/api/bible/books");A.value=o.data?.all}catch(o){x.value="Erreur lors du chargement des livres",console.error(o)}finally{v.value=!1}},n=async()=>{try{const o=await $fetch("/api/bible/versions");B.value=o.data||o}catch(o){x.value="Erreur lors du chargement des versions",console.error(o)}},r=async()=>{if(O.value)try{x.value="",w.value=!0;const o=F.value,t=b.value,l=h.value,p=V.value||l;if(!o){x.value="Veuillez sélectionner un livre";return}const R=await $fetch("/api/bible/compare",{method:"POST",body:{bookId:o.id,chapter:t,verseStart:l,verseEnd:p,versions:m.value}});c.value=R.data}catch(o){x.value=o?.message||"Erreur lors de la comparaison",console.error(o)}finally{w.value=!1}},_=()=>{c.value=null,x.value=""},$=async o=>{if(!c.value)return;const t={version:o,verses:[{id:0,chapter:c.value.chapter,verse:c.value.verseRange.start,text:"Chargement...",createdAt:new Date,versionId:o.id,bookId:c.value.book.id}]};c.value.comparisons.push(t),m.value.push(o.id),await r()},C=o=>{c.value&&(c.value.comparisons=c.value.comparisons.filter(t=>t.version.id!==o),m.value=m.value.filter(t=>t!==o))},z=o=>{console.log("Ajouter aux favoris:",o)},S=o=>{console.log("Ajouter une note:",o)};return(o,t)=>{const l=W,p=K,R=fe,oe=_e,se=X,M=J,q=be,te=Y,ae=ee,le=Ge,ne=ye,re=ve;return u(),f("div",null,[a(re,null,{left:i(()=>[a(R,null,{top:i(()=>[a(p,{to:"/bible",color:"secondary",variant:"ghost",class:"w-full justify-start mb-4"},{leading:i(()=>[a(l,{name:"i-lucide-arrow-left"})]),default:i(()=>[t[4]||(t[4]=N(" Retour à la Bible ",-1))]),_:1}),e(c)?(u(),f("div",He,[t[5]||(t[5]=s("p",{class:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Versions disponibles ",-1)),s("div",Qe,[(u(!0),f(E,null,L(e(P),d=>(u(),H(p,{key:d.id,size:"sm",color:"secondary",variant:"soft",class:"w-full justify-start",onClick:ie=>$(d)},{default:i(()=>[s("div",Ze,[s("span",Je,g(d.name),1),s("span",Ke,"("+g(d.code)+")",1)])]),_:2},1032,["onClick"]))),128))])])):j("",!0)]),_:1})]),default:i(()=>[a(oe,{title:"Comparaison de versions bibliques",description:"Comparez différentes versions de la Bible sur un même passage."},pe({_:2},[e(c)?{name:"right",fn:i(()=>[a(p,{color:"secondary",variant:"ghost",icon:"i-lucide-x",onClick:_},{default:i(()=>[...t[6]||(t[6]=[N(" Fermer ",-1)])]),_:1})]),key:"0"}:void 0]),1024),a(ne,null,{default:i(()=>[e(c)?(u(),f("div",lo,[a(le,{book:e(c).book,chapter:e(c).chapter,"verse-range":e(c).verseRange,comparisons:e(c).comparisons,"available-versions":e(P),onClose:_,onAddVersion:$,onRemoveVersion:C,onAddBookmark:z,onAddNote:S},null,8,["book","chapter","verse-range","comparisons","available-versions"])])):(u(),H(ae,{key:0},{header:i(()=>[...t[7]||(t[7]=[s("h3",{class:"text-lg font-medium"}," Sélectionner le passage à comparer ",-1)])]),default:i(()=>[s("form",{class:"space-y-6",onSubmit:ge(r,["prevent"])},[s("div",We,[a(M,{label:"Livre"},{default:i(()=>[a(se,{modelValue:e(k),"onUpdate:modelValue":t[0]||(t[0]=d=>U(k)?k.value=d:null),items:e(A),loading:e(v),"label-key":"name","value-key":"id",placeholder:"Sélectionner un livre",searchable:"","search-placeholder":"Rechercher un livre...",class:"max-w-52 w-full"},null,8,["modelValue","items","loading"])]),_:1}),a(M,{label:"Chapitre"},{default:i(()=>[a(q,{modelValue:e(b),"onUpdate:modelValue":t[1]||(t[1]=d=>U(b)?b.value=d:null),modelModifiers:{number:!0},type:"number",min:"1",max:e(F)?.chapterCount||150,placeholder:"Numéro de chapitre",disabled:!e(k),class:"max-w-52 w-full"},null,8,["modelValue","max","disabled"])]),_:1})]),s("div",Xe,[a(M,{label:"Verset de début"},{default:i(()=>[a(q,{modelValue:e(h),"onUpdate:modelValue":t[2]||(t[2]=d=>U(h)?h.value=d:null),modelModifiers:{number:!0},type:"number",min:"1",placeholder:"1",disabled:!e(k)||!e(b),class:"max-w-52 w-full"},null,8,["modelValue","disabled"])]),_:1}),a(M,{label:"Verset de fin (optionnel)"},{default:i(()=>[a(q,{modelValue:e(V),"onUpdate:modelValue":t[3]||(t[3]=d=>U(V)?V.value=d:null),modelModifiers:{number:!0},type:"number",min:e(h)||1,placeholder:"Même verset",disabled:!e(k)||!e(b),class:"max-w-52 w-full"},null,8,["modelValue","min","disabled"])]),_:1})]),a(M,{label:"Versions à comparer",required:"",description:`${e(m).length} version(s) sélectionnée(s) (minimum 2, maximum 6)`},{default:i(()=>[s("div",Ye,[(u(!0),f(E,null,L(e(B),d=>(u(),f("div",{key:d.id,class:T(["p-3 rounded-lg border transition-colors cursor-pointer",e(m).includes(d.id)?"bg-primary-50 dark:bg-primary-950 border-primary-200 dark:border-primary-800":"bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-800 hover:bg-gray-100 dark:hover:bg-gray-800"]),onClick:ie=>D(d.id,!e(m).includes(d.id))},[s("div",oo,[a(te,{"model-value":e(m).includes(d.id),disabled:e(m).length>=6&&!e(m).includes(d.id)},null,8,["model-value","disabled"]),s("div",null,[s("div",so,g(d.name),1),s("div",to,g(d.code)+" • "+g(d.language),1)])])],10,eo))),128))])]),_:1},8,["description"]),s("div",ao,[a(p,{to:"/bible",variant:"ghost",color:"secondary"},{default:i(()=>[...t[8]||(t[8]=[N(" Annuler ",-1)])]),_:1}),a(p,{type:"submit",loading:e(w),disabled:!e(O),color:"primary"},{default:i(()=>[...t[9]||(t[9]=[N(" Démarrer la comparaison ",-1)])]),_:1},8,["loading","disabled"])])],32)]),_:1}))]),_:1})]),_:1})])}}});export{go as default};
