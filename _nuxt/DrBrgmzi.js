import{z as b,D as E,I as c,w as i,h as m,d as y,K as U,f as g,n as $,t as v,O as J,F as P,g as u,bD as L,C as t,a7 as q,e as a,v as F,a0 as H,E as M,J as R,a4 as G,a6 as K,L as Y,P as Z,M as Q,N as W,S as X}from"#entry";import{_ as ee}from"./CvsAtPMi.js";import{_ as te,a as se}from"./SLxr-Eaq.js";import{_ as ae}from"./DXub1hf0.js";import{_ as oe}from"./3OpNAs3T.js";import{u as x}from"./38kU-qnc.js";import{q as k}from"./CsPnchMx.js";import"./Cj-Qqv67.js";const ne={class:"space-y-3"},re={class:"flex-1"},le={class:"text-sm text-gray-600"},ie=b({__name:"ThemeProgress",props:{lessons:{}},setup(d){const r=E(()=>d.lessons.filter(p=>p.completed).length);return(p,o)=>{const _=L,e=J,l=ee;return a(),c(l,{class:"doctrinal-progress"},{header:i(()=>[o[1]||(o[1]=m("h3",{class:"text-lg font-semibold"}," Progression dans l'Ã©tude ",-1)),u(_,{modelValue:t(r),"onUpdate:modelValue":o[0]||(o[0]=s=>q(r)?r.value=s:null),max:d.lessons.length,color:t(r)==d.lessons.length?"success":"secondary",ui:{root:"mt-2"}},null,8,["modelValue","max","color"])]),default:i(()=>[m("div",ne,[(a(!0),y(P,null,U(d.lessons,(s,f)=>(a(),y("div",{key:f,class:"flex items-center gap-3"},[m("div",{class:$(["w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium",s.completed?"bg-primary-500 text-white":"bg-gray-200 text-gray-600"])},v(f+1),3),m("div",re,[m("div",{class:$(["font-medium",s.completed?"text-primary-700":"text-gray-700"])},v(s.title),3),m("div",le,v(s.description),1)]),s.completed?(a(),c(e,{key:0,name:"i-heroicons-check-circle",class:"text-primary-500 min-w-5"})):g("",!0)]))),128))])]),_:1})}}}),ce=Object.assign(ie,{__name:"ThemeProgress"}),me={key:1,class:"flex justify-center mt-4"},ve=b({__name:"index",async setup(d){let r,p;const o=F(),{loggedIn:_}=H(),{data:e}=([r,p]=M(()=>x(o.path,()=>k("themes").path(o.path).first(),"$t3r9J3arP3")),r=await r,p(),r),{data:l}=x(o.path+"/lessons",()=>k("lessons").where("theme","=",o.params.theme).all(),"$SDYkZUU4g4"),{data:s,refresh:f}=x(o.path+"-progress",()=>$fetch(`/api/teaching/progress/${e.value?.slug}`,{method:"GET"}),{immediate:_.value,server:!1}),C=async()=>{try{await $fetch(`/api/teaching/progress/${e.value?.slug}`,{method:"POST"}),await f()}catch(w){console.log(w)}};return R({title:e.value?.title,description:e.value?.seo.description,keywords:e.value?.seo.keywords,ogTitle:e.value?.title,ogDescription:e.value?.seo.description,ogImage:e.value?.image.src,ogType:"website",ogUrl:e.value?.seo.url,twitterCard:e.value?.seo.card,twitterTitle:e.value?.title,twitterDescription:e.value?.seo.description,twitterImage:e.value?.image.src}),G({htmlAttrs:{lang:e.value?.seo.lang||"fr"},link:[{rel:"canonical",href:e.value?.seo.url}]}),(w,h)=>{const B=Y,D=Z,T=ce,S=W,I=te,N=ae,V=oe,j=se,z=X,O=K;return t(e)?(a(),c(O,{key:0},{default:i(()=>[u(z,null,{default:i(()=>[u(B,{src:t(e).image.src,class:"w-full aspect-video max-h-[32rem] rounded-b-xl object-center"},null,8,["src"]),t(_)&&t(s)?.data===null?(a(),c(D,{key:0,icon:"i-lucide-flag",size:"xs",color:"warning",variant:"subtle",class:"mt-4",onClick:h[0]||(h[0]=n=>C())},{default:i(()=>[...h[1]||(h[1]=[Q(" Commencer le parcours ",-1)])]),_:1})):g("",!0),u(I,{title:t(e).title,description:t(e).description,class:"pb-[25px]"},{default:i(()=>[t(_)&&t(s)?.data&&t(l)?.length?(a(),c(T,{key:0,lessons:t(l).map(n=>({title:n.title,description:n.description,completed:t(s)?.data?.lessons?JSON.parse(t(s).data.lessons).includes(n.slug):!1})),class:"mt-4"},null,8,["lessons"])):t(l)?(a(),y("div",me,[u(S,{label:t(l).length+" articles",variant:"subtle",size:"lg",color:"neutral"},null,8,["label"])])):g("",!0)]),_:1},8,["title","description"]),u(j,null,{default:i(()=>[t(l)?(a(),c(V,{key:0},{default:i(()=>[(a(!0),y(P,null,U(t(l),(n,A)=>(a(),c(N,{key:A,to:n.path,title:n.title,description:n.description,image:n.image,date:new Date(n.date).toLocaleDateString("fr",{year:"numeric",month:"short",day:"numeric"}),badge:{label:t(e).title,color:t(e).color||"primary"},variant:"naked",ui:{description:"line-clamp-2"}},null,8,["to","title","description","image","date","badge"]))),128))]),_:1})):g("",!0)]),_:1})]),_:1})]),_:1})):g("",!0)}}});export{ve as default};
